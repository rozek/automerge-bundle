var Ew=Object.defineProperty;var Iw=(le,ue,Se)=>ue in le?Ew(le,ue,{enumerable:!0,configurable:!0,writable:!0,value:Se}):le[ue]=Se;var Ow=(le,ue)=>()=>(ue||le((ue={exports:{}}).exports,ue),ue.exports);var _e=(le,ue,Se)=>(Iw(le,typeof ue!="symbol"?ue+"":ue,Se),Se),ba=(le,ue,Se)=>{if(!ue.has(le))throw TypeError("Cannot "+Se)};var h=(le,ue,Se)=>(ba(le,ue,"read from private field"),Se?Se.call(le):ue.get(le)),q=(le,ue,Se)=>{if(ue.has(le))throw TypeError("Cannot add the same private member more than once");ue instanceof WeakSet?ue.add(le):ue.set(le,Se)},we=(le,ue,Se,sn)=>(ba(le,ue,"write to private field"),sn?sn.call(le,Se):ue.set(le,Se),Se);var ya=(le,ue,Se,sn)=>({set _(cn){we(le,ue,cn,Se)},get _(){return h(le,ue,sn)}}),ne=(le,ue,Se)=>(ba(le,ue,"access private method"),Se);var Cw=Ow((Mw,an)=>{(async()=>{var mr,Oe,Ht,wr,vr,wa,Mn,ei,Sr,va,Et,qe,Ze,It,Kt,Ot,kr,Sa,Lo,H_,Xe,Ut,No,Fo,Un,Gt,en,Re,qt,Ct,Dn,Ln,Bo,K_,Vo,q_,$o,J_,zo,W_,at,Je,tn,Le,Nn,Fn,xr,xe,Ar,Ho,Q_,Ko,Y_,qo,Z_,Bn,ti,Jo,X_,Wo,G_,Vn,ni,$n,ri,Er,ka,nn,Dr,Ir,xa,Jt,Wt,Or,Cr,Aa,Qo,el,jr,Ea,st,$e,ct,Ge,ft,Yo,tl,Rr,Zo,nl,rn,Lr,Tr,Qt,ut,Pr,Ia,Dt,Mr,Ur,Oa;(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();let le;const ue=new Uint8Array(16);function Se(){if(!le&&(le=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!le))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return le(ue)}const sn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function cn(t){return typeof t=="string"&&sn.test(t)}const Te=[];for(let t=0;t<256;++t)Te.push((t+256).toString(16).slice(1));function Ca(t,e=0){return Te[t[e+0]]+Te[t[e+1]]+Te[t[e+2]]+Te[t[e+3]]+"-"+Te[t[e+4]]+Te[t[e+5]]+"-"+Te[t[e+6]]+Te[t[e+7]]+"-"+Te[t[e+8]]+Te[t[e+9]]+"-"+Te[t[e+10]]+Te[t[e+11]]+Te[t[e+12]]+Te[t[e+13]]+Te[t[e+14]]+Te[t[e+15]]}function rl(t,e=0){const n=Ca(t,e);if(!cn(n))throw TypeError("Stringified UUID is invalid");return n}function ol(t){if(!cn(t))throw TypeError("Invalid UUID");let e;const n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}const il=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ja={randomUUID:il};function Ra(t,e,n){if(ja.randomUUID&&!e&&!t)return ja.randomUUID();t=t||{};const r=t.random||(t.rng||Se)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let o=0;o<16;++o)e[n+o]=r[o];return e}return Ca(r)}const jt=Symbol.for("_am_meta"),un=Symbol.for("_am_trace"),dn=Symbol.for("_am_objectId"),Nr=Symbol.for("_am_isProxy"),oi=Symbol.for("_am_clearCache"),Ta=Symbol.for("_am_uint"),Pa=Symbol.for("_am_int"),Ma=Symbol.for("_am_f64"),Ua=Symbol.for("_am_counter"),al=Symbol.for("_am_text");let Hn=class Go{constructor(e){if(typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,al,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[Symbol.iterator](){const e=this.elems;let n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const e of this.elems)typeof e=="string"?this.str+=e:this.str+="\uFFFC"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(const n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[jt])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[jt])throw new RangeError("object cannot be modified outside of a change block");n.every(r=>typeof r=="string")?this.elems.splice(e,0,...n.join("")):this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[jt])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new Go(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new Go(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){return new Go(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}},Kn=class{constructor(t){this.value=t||0,Reflect.defineProperty(this,Ua,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}increment(t){throw new Error("Counters should not be incremented outside of a change callback")}decrement(t){throw new Error("Counters should not be decremented outside of a change callback")}},sl=class extends Kn{constructor(t,e,n,r,o){super(t),this.context=e,this.path=n,this.objectId=r,this.key=o}increment(t){return t=typeof t=="number"?t:1,this.context.increment(this.objectId,this.key,t),this.value+=t,this.value}decrement(t){return this.increment(typeof t=="number"?-t:-1)}};function cl(t,e,n,r,o){return new sl(t,e,n,r,o)}let Fr=class{constructor(t){this.val=t}toString(){return this.val}};function gt(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function et(t,e){const{context:n,objectId:r,path:o,textV2:i}=t,a=n.getWithType(r,e);if(a===null)return;const s=a[0],c=a[1];switch(s){case void 0:return;case"map":return _n(n,c,i,[...o,e]);case"list":return qn(n,c,i,[...o,e]);case"text":return i?n.text(c):Jn(n,c,[...o,e]);case"str":return c;case"uint":return c;case"int":return c;case"f64":return c;case"boolean":return c;case"null":return null;case"bytes":return c;case"timestamp":return c;case"counter":return cl(c,n,o,r,e);default:throw RangeError(`datatype ${s} unimplemented`)}}function Br(t,e,n){switch(typeof t){case"object":if(t==null)return[null,"null"];if(t[Ta])return[t.value,"uint"];if(t[Pa])return[t.value,"int"];if(t[Ma])return[t.value,"f64"];if(t[Ua])return[t.value,"counter"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(t instanceof Fr)return[t.toString(),"str"];if(t instanceof Hn)return[t,"text"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.getPrototypeOf(t)===Object.getPrototypeOf({}))return[t,"map"];throw Vr(t,context)?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return e?[t,"text"]:[t,"str"];default:throw new RangeError(`Unsupported type ${typeof t} for path ${fl(n)}`)}}function Vr(t,e){var n,r;return t instanceof Date?!1:!!(t&&((r=(n=t[jt])===null||n===void 0?void 0:n.handle)===null||r===void 0?void 0:r.__wbg_ptr)===e.__wbg_ptr)}const ul={get(t,e){const{context:n,objectId:r,cache:o}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===dn?r:e===Nr?!0:e===un?t.trace:e===jt?{handle:n,textV2:t.textV2}:(o[e]||(o[e]=et(t,e)),o[e])},set(t,e,n){const{context:r,objectId:o,path:i,textV2:a}=t;if(t.cache={},Vr(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===un)return t.trace=n,!0;if(e===oi)return!0;const[s,c]=Br(n,a,[...i,e]);switch(c){case"list":{const u=r.putObject(o,e,[]),_=qn(r,u,a,[...i,e]);for(let d=0;d<s.length;d++)_[d]=s[d];break}case"text":{if(a)$r(s),r.putObject(o,e,s);else{ai(s);const u=r.putObject(o,e,"");Jn(r,u,[...i,e]).splice(0,0,...s)}break}case"map":{const u=r.putObject(o,e,{}),_=_n(r,u,a,[...i,e]);for(const d in s)_[d]=s[d];break}default:r.put(o,e,s,c)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;return t.cache={},n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){const n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){const{context:e,objectId:n}=t,r=e.keys(n);return[...new Set(r)]}},Da={get(t,e){const{context:n,objectId:r}=t;return e=gt(e),e===Symbol.hasInstance?o=>Array.isArray(o):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===dn?r:e===Nr?!0:e===un?t.trace:e===jt?{handle:n}:e==="length"?n.length(r):typeof e=="number"?et(t,e):ii(t)[e]},set(t,e,n){const{context:r,objectId:o,path:i,textV2:a}=t;if(e=gt(e),Vr(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===oi)return!0;if(e===un)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");const[s,c]=Br(n,a,[...i,e]);switch(c){case"list":{let u;e>=r.length(o)?u=r.insertObject(o,e,[]):u=r.putObject(o,e,[]),qn(r,u,a,[...i,e]).splice(0,0,...s);break}case"text":{if(a)$r(s),e>=r.length(o)?r.insertObject(o,e,s):r.putObject(o,e,s);else{let u;ai(s),e>=r.length(o)?u=r.insertObject(o,e,""):u=r.putObject(o,e,""),Jn(r,u,[...i,e]).splice(0,0,...s)}break}case"map":{let u;e>=r.length(o)?u=r.insertObject(o,e,{}):u=r.putObject(o,e,{});const _=_n(r,u,a,[...i,e]);for(const d in s)_[d]=s[d];break}default:e>=r.length(o)?r.insert(o,e,s,c):r.put(o,e,s,c)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;e=gt(e);const o=n.get(r,e);if(o!=null&&o[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){const{context:n,objectId:r}=t;return e=gt(e),typeof e=="number"?e<n.length(r):e==="length"},getOwnPropertyDescriptor(t,e){const{context:n,objectId:r}=t;return e==="length"?{writable:!0,value:n.length(r)}:e===dn?{configurable:!1,enumerable:!1,value:r}:(e=gt(e),{configurable:!0,enumerable:!0,value:et(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){const t=[];return t.push("length"),t}},dl=Object.assign({},Da,{get(t,e){const{context:n,objectId:r}=t;return e=gt(e),e===Symbol.hasInstance?o=>Array.isArray(o):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===dn?r:e===Nr?!0:e===un?t.trace:e===jt?{handle:n}:e==="length"?n.length(r):typeof e=="number"?et(t,e):ll(t)[e]||ii(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new Hn)}});function _n(t,e,n,r){const o={context:t,objectId:e,path:r||[],cache:{},textV2:n},i={};return Object.assign(i,o),new Proxy(i,ul)}function qn(t,e,n,r){const o={context:t,objectId:e,path:r||[],cache:{},textV2:n},i=[];return Object.assign(i,o),new Proxy(i,Da)}function Jn(t,e,n){const r={context:t,objectId:e,path:n||[],cache:{},textV2:!1},o={};return Object.assign(o,r),new Proxy(o,dl)}function _l(t,e){return _n(t,"_root",e,[])}function ii(t){const{context:e,objectId:n,path:r,textV2:o}=t;return{deleteAt(i,a){return typeof a=="number"?e.splice(n,i,a):e.delete(n,i),this},fill(i,a,s){const[c,u]=Br(i,o,[...r,a]),_=e.length(n);a=gt(a||0),s=gt(s||_);for(let d=a;d<Math.min(s,_);d++)if(u==="list"||u==="map")e.putObject(n,d,c);else if(u==="text")if(o)$r(c),e.putObject(n,d,c);else{ai(c);const l=e.putObject(n,d,""),f=Jn(e,l,[...r,d]);for(let m=0;m<c.length;m++)f[m]=c.get(m)}else e.put(n,d,c,u);return this},indexOf(i,a=0){const s=e.length(n);for(let c=a;c<s;c++){const u=e.getWithType(n,c);if(u&&(u[1]===i[dn]||u[1]===i))return c}return-1},insertAt(i,...a){return this.splice(i,0,...a),this},pop(){const i=e.length(n);if(i==0)return;const a=et(t,i-1);return e.delete(n,i-1),a},push(...i){const a=e.length(n);return this.splice(a,0,...i),e.length(n)},shift(){if(e.length(n)==0)return;const i=et(t,0);return e.delete(n,0),i},splice(i,a,...s){i=gt(i),typeof a!="number"&&(a=e.length(n)-i),a=gt(a);for(const _ of s)if(Vr(_,e))throw new RangeError("Cannot create a reference to an existing document object");const c=[];for(let _=0;_<a;_++){const d=et(t,i);d!==void 0&&c.push(d),e.delete(n,i)}const u=s.map((_,d)=>{try{return Br(_,o,[...r])}catch(l){throw l instanceof RangeError?new RangeError(`${l.message} at index ${d} in the input`):l}});for(const[_,d]of u){switch(d){case"list":{const l=e.insertObject(n,i,[]);qn(e,l,o,[...r,i]).splice(0,0,..._);break}case"text":{if(o)$r(_),e.insertObject(n,i,_);else{const l=e.insertObject(n,i,"");Jn(e,l,[...r,i]).splice(0,0,..._)}break}case"map":{const l=e.insertObject(n,i,{}),f=_n(e,l,o,[...r,i]);for(const m in _)f[m]=_[m];break}default:e.insert(n,i,_,d)}i+=1}return c},unshift(...i){return this.splice(0,0,...i),e.length(n)},entries(){let i=0;return{next:()=>{const a=et(t,i);return a===void 0?{value:void 0,done:!0}:{value:[i++,a],done:!1}},[Symbol.iterator](){return this}}},keys(){let i=0;const a=e.length(n);return{next:()=>i<a?{value:i++,done:!1}:{value:void 0,done:!0},[Symbol.iterator](){return this}}},values(){let i=0;return{next:()=>{const a=et(t,i++);return a===void 0?{value:void 0,done:!0}:{value:a,done:!1}},[Symbol.iterator](){return this}}},toArray(){const i=[];let a;do a=et(t,i.length),a!==void 0&&i.push(a);while(a!==void 0);return i},map(i){return this.toArray().map(i)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(i){return this.toArray().forEach(i)},concat(i){return this.toArray().concat(i)},every(i){return this.toArray().every(i)},filter(i){return this.toArray().filter(i)},find(i){let a=0;for(const s of this){if(i(s,a))return s;a+=1}},findIndex(i){let a=0;for(const s of this){if(i(s,a))return a;a+=1}return-1},includes(i){return this.find(a=>a===i)!==void 0},join(i){return this.toArray().join(i)},reduce(i,a){return this.toArray().reduce(i,a)},reduceRight(i,a){return this.toArray().reduceRight(i,a)},lastIndexOf(i,a=1/0){return this.toArray().lastIndexOf(i,a)},slice(i,a){return this.toArray().slice(i,a)},some(i){let a=0;for(const s of this){if(i(s,a))return!0;a+=1}return!1},[Symbol.iterator]:function*(){let i=0,a=et(t,i);for(;a!==void 0;)yield a,i+=1,a=et(t,i)}}}function ll(t){const{context:e,objectId:n}=t;return{set(r,o){return this[r]=o},get(r){return this[r]},toString(){return e.text(n).replace(/ï¿¼/g,"")},toSpans(){const r=[];let o="";const i=e.length(n);for(let a=0;a<i;a++){const s=this[a];typeof s=="string"?o+=s:(o.length>0&&(r.push(o),o=""),r.push(s))}return o.length>0&&r.push(o),r},toJSON(){return this.toString()},indexOf(r,o=0){return e.text(n).indexOf(r,o)},insertAt(r,...o){o.every(i=>typeof i=="string")?e.splice(n,r,0,o.join("")):ii(t).insertAt(r,...o)}}}function ai(t){if(!(t instanceof Hn))throw new Error("value was not a Text instance")}function $r(t){if(typeof t!="string")throw new Error("value was not a string")}function fl(t){const e=t.map(n=>{if(typeof n=="number")return n.toString();if(typeof n=="string")return n.replace(/~/g,"~0").replace(/\//g,"~1")});return t.length===0?"":"/"+e.join("/")}class hl{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,Pa,{value:!0}),Object.freeze(this)}}class gl{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,Ta,{value:!0}),Object.freeze(this)}}class pl{constructor(e){if(typeof e!="number")throw new RangeError(`Value ${e} cannot be a float64`);this.value=e||0,Reflect.defineProperty(this,Ma,{value:!0}),Object.freeze(this)}}function bl(t){for(const e in t)Pe[e]=t[e]}const Pe={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};function re(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");const n=Reflect.get(t,jt);if(n===void 0||n==null||e&&Wn(t)!=="_root")throw new RangeError("must be the document root");return n}function ln(t){Reflect.set(t,oi,!0)}function si(t){return Reflect.get(t,un)}function Wn(t){return typeof t!="object"||t===null?null:Reflect.get(t,dn)}function Ue(t){return!!Reflect.get(t,Nr)}function yl(t,e,n){return ml(t,e,n,!0,(r,o)=>r.text(o))}function ml(t,e,n,r,o){const i=t.getAll(e,n);if(i.length<=1)return;const a={};for(const s of i)switch(s[0]){case"map":a[s[1]]=_n(t,s[1],r,[n]);break;case"list":a[s[1]]=qn(t,s[1],r,[n]);break;case"text":a[s[1]]=o(t,s[1]);break;case"str":case"uint":case"int":case"f64":case"boolean":case"bytes":case"null":a[s[2]]=s[1];break;case"counter":a[s[2]]=new Kn(s[1]);break;case"timestamp":a[s[2]]=new Date(s[1]);break;default:throw RangeError(`datatype ${s[0]} unimplemented`)}return a}const wl="/automerge_wasm_bg.wasm",La=async(t={},e)=>{let n;if(e.startsWith("data:")){const r=e.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(r,"base64");else if(typeof atob=="function"){const i=atob(r);o=new Uint8Array(i.length);for(let a=0;a<i.length;a++)o[a]=i.charCodeAt(a)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(o,t)}else{const r=await fetch(e),o=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,t);else{const i=await r.arrayBuffer();n=await WebAssembly.instantiate(i,t)}}return n.instance.exports};let g;function Na(t){g=t}const Rt=new Array(128).fill(void 0);Rt.push(void 0,null,!0,!1);function L(t){return Rt[t]}let tt=0,zr=null;function Hr(){return(zr===null||zr.byteLength===0)&&(zr=new Uint8Array(g.memory.buffer)),zr}const vl=typeof TextEncoder>"u"?(0,an.require)("util").TextEncoder:TextEncoder;let Kr=new vl("utf-8");const Sl=typeof Kr.encodeInto=="function"?function(t,e){return Kr.encodeInto(t,e)}:function(t,e){const n=Kr.encode(t);return e.set(n),{read:t.length,written:n.length}};function pt(t,e,n){if(n===void 0){const s=Kr.encode(t),c=e(s.length,1)>>>0;return Hr().subarray(c,c+s.length).set(s),tt=s.length,c}let r=t.length,o=e(r,1)>>>0;const i=Hr();let a=0;for(;a<r;a++){const s=t.charCodeAt(a);if(s>127)break;i[o+a]=s}if(a!==r){a!==0&&(t=t.slice(a)),o=n(o,r,r=a+t.length*3,1)>>>0;const s=Hr().subarray(o+a,o+r),c=Sl(t,s);a+=c.written}return tt=a,o}function pe(t){return t==null}let qr=null;function v(){return(qr===null||qr.byteLength===0)&&(qr=new Int32Array(g.memory.buffer)),qr}let Qn=Rt.length;function kl(t){t<132||(Rt[t]=Qn,Qn=t)}function P(t){const e=L(t);return kl(t),e}const xl=typeof TextDecoder>"u"?(0,an.require)("util").TextDecoder:TextDecoder;let Fa=new xl("utf-8",{ignoreBOM:!0,fatal:!0});Fa.decode();function We(t,e){return t=t>>>0,Fa.decode(Hr().subarray(t,t+e))}function x(t){Qn===Rt.length&&Rt.push(Rt.length+1);const e=Qn;return Qn=Rt[e],Rt[e]=t,e}let Jr=null;function Wr(){return(Jr===null||Jr.byteLength===0)&&(Jr=new Float64Array(g.memory.buffer)),Jr}function ci(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let i="[";o>0&&(i+=ci(t[0]));for(let a=1;a<o;a++)i+=", "+ci(t[a]);return i+="]",i}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function fn(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function Al(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.create(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return ui.__wrap(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function El(t,e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.load(i,x(t),x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return ui.__wrap(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Il(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.encodeChange(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return P(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Ol(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.decodeChange(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return P(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Cl(){const t=g.initSyncState();return Lt.__wrap(t)}function jl(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.importSyncState(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return Lt.__wrap(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Rl(t){fn(t,Lt);const e=g.exportSyncState(t.__wbg_ptr);return P(e)}function Tl(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.encodeSyncMessage(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return P(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Pl(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.decodeSyncMessage(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return P(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function Ml(t){fn(t,Lt);const e=g.encodeSyncState(t.__wbg_ptr);return P(e)}function Ul(t){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.decodeSyncState(o,x(t));var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return Lt.__wrap(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}function De(t,e){try{return t.apply(this,e)}catch(n){g.__wbindgen_exn_store(x(n))}}const Dl=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),Ba=new FinalizationRegistry(t=>g.__wbg_automerge_free(t>>>0));let ui=class on{static __wrap(e){e=e>>>0;const n=Object.create(on.prototype);return n.__wbg_ptr=e,Ba.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Ba.unregister(this),e}free(){const e=this.__destroy_into_raw();g.__wbg_automerge_free(e)}static new(e,n){try{const c=g.__wbindgen_add_to_stack_pointer(-16);var r=pe(e)?0:pt(e,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;g.automerge_new(c,r,o,n);var i=v()[c/4+0],a=v()[c/4+1],s=v()[c/4+2];if(s)throw P(a);return on.__wrap(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}clone(e){try{const s=g.__wbindgen_add_to_stack_pointer(-16);var n=pe(e)?0:pt(e,g.__wbindgen_malloc,g.__wbindgen_realloc),r=tt;g.automerge_clone(s,this.__wbg_ptr,n,r);var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return on.__wrap(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}fork(e,n){try{const c=g.__wbindgen_add_to_stack_pointer(-16);var r=pe(e)?0:pt(e,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;g.automerge_fork(c,this.__wbg_ptr,r,o,x(n));var i=v()[c/4+0],a=v()[c/4+1],s=v()[c/4+2];if(s)throw P(a);return on.__wrap(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const e=g.automerge_pendingOps(this.__wbg_ptr);return P(e)}commit(e,n){var r=pe(e)?0:pt(e,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;const i=g.automerge_commit(this.__wbg_ptr,r,o,!pe(n),pe(n)?0:n);return P(i)}merge(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);fn(e,on),g.automerge_merge(i,this.__wbg_ptr,e.__wbg_ptr);var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}rollback(){return g.automerge_rollback(this.__wbg_ptr)}keys(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_keys(a,this.__wbg_ptr,x(e),pe(n)?0:x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}text(e,n){let r,o;try{const d=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_text(d,this.__wbg_ptr,x(e),pe(n)?0:x(n));var i=v()[d/4+0],a=v()[d/4+1],s=v()[d/4+2],c=v()[d/4+3],u=i,_=a;if(c)throw u=0,_=0,P(s);return r=u,o=_,We(u,_)}finally{g.__wbindgen_add_to_stack_pointer(16),g.__wbindgen_free(r,o,1)}}spans(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_spans(a,this.__wbg_ptr,x(e),pe(n)?0:x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}splice(e,n,r,o){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_splice(s,this.__wbg_ptr,x(e),n,r,x(o));var i=v()[s/4+0],a=v()[s/4+1];if(a)throw P(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}updateText(e,n){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_updateText(i,this.__wbg_ptr,x(e),x(n));var r=v()[i/4+0],o=v()[i/4+1];if(o)throw P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}push(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_push(a,this.__wbg_ptr,x(e),x(n),x(r));var o=v()[a/4+0],i=v()[a/4+1];if(i)throw P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}pushObject(e,n){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_pushObject(s,this.__wbg_ptr,x(e),x(n));var r=v()[s/4+0],o=v()[s/4+1],i=v()[s/4+2],a=v()[s/4+3];if(a)throw P(i);let c;return r!==0&&(c=We(r,o).slice(),g.__wbindgen_free(r,o*1)),c}finally{g.__wbindgen_add_to_stack_pointer(16)}}insert(e,n,r,o){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_insert(s,this.__wbg_ptr,x(e),n,x(r),x(o));var i=v()[s/4+0],a=v()[s/4+1];if(a)throw P(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}splitBlock(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_splitBlock(a,this.__wbg_ptr,x(e),n,x(r));var o=v()[a/4+0],i=v()[a/4+1];if(i)throw P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}joinBlock(e,n){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_joinBlock(i,this.__wbg_ptr,x(e),n);var r=v()[i/4+0],o=v()[i/4+1];if(o)throw P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}updateBlocks(e,n){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_updateBlocks(i,this.__wbg_ptr,x(e),x(n));var r=v()[i/4+0],o=v()[i/4+1];if(o)throw P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}updateBlock(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_updateBlock(a,this.__wbg_ptr,x(e),n,x(r));var o=v()[a/4+0],i=v()[a/4+1];if(i)throw P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getBlock(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getBlock(a,this.__wbg_ptr,x(e),n);var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}insertObject(e,n,r){try{const c=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_insertObject(c,this.__wbg_ptr,x(e),n,x(r));var o=v()[c/4+0],i=v()[c/4+1],a=v()[c/4+2],s=v()[c/4+3];if(s)throw P(a);let u;return o!==0&&(u=We(o,i).slice(),g.__wbindgen_free(o,i*1)),u}finally{g.__wbindgen_add_to_stack_pointer(16)}}put(e,n,r,o){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_put(s,this.__wbg_ptr,x(e),x(n),x(r),x(o));var i=v()[s/4+0],a=v()[s/4+1];if(a)throw P(i)}finally{g.__wbindgen_add_to_stack_pointer(16)}}putObject(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_putObject(s,this.__wbg_ptr,x(e),x(n),x(r));var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}increment(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_increment(a,this.__wbg_ptr,x(e),x(n),x(r));var o=v()[a/4+0],i=v()[a/4+1];if(i)throw P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}get(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_get(s,this.__wbg_ptr,x(e),x(n),pe(r)?0:x(r));var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getWithType(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getWithType(s,this.__wbg_ptr,x(e),x(n),pe(r)?0:x(r));var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}objInfo(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_objInfo(a,this.__wbg_ptr,x(e),pe(n)?0:x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getAll(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getAll(s,this.__wbg_ptr,x(e),x(n),pe(r)?0:x(r));var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_enableFreeze(i,this.__wbg_ptr,x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(e,n){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_registerDatatype(i,this.__wbg_ptr,x(e),x(n));var r=v()[i/4+0],o=v()[i/4+1];if(o)throw P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}applyPatches(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_applyPatches(a,this.__wbg_ptr,x(e),x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}applyAndReturnPatches(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_applyAndReturnPatches(a,this.__wbg_ptr,x(e),x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}diffIncremental(){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_diffIncremental(o,this.__wbg_ptr);var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return P(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}updateDiffCursor(){g.automerge_updateDiffCursor(this.__wbg_ptr)}resetDiffCursor(){g.automerge_resetDiffCursor(this.__wbg_ptr)}diff(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_diff(a,this.__wbg_ptr,x(e),x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}isolate(e){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_isolate(o,this.__wbg_ptr,x(e));var n=v()[o/4+0],r=v()[o/4+1];if(r)throw P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}integrate(){g.automerge_integrate(this.__wbg_ptr)}length(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_length(a,this.__wbg_ptr,x(e),pe(n)?0:x(n));var r=Wr()[a/8+0],o=v()[a/4+2],i=v()[a/4+3];if(i)throw P(o);return r}finally{g.__wbindgen_add_to_stack_pointer(16)}}delete(e,n){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_delete(i,this.__wbg_ptr,x(e),x(n));var r=v()[i/4+0],o=v()[i/4+1];if(o)throw P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}save(){const e=g.automerge_save(this.__wbg_ptr);return P(e)}saveIncremental(){const e=g.automerge_saveIncremental(this.__wbg_ptr);return P(e)}saveSince(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_saveSince(i,this.__wbg_ptr,x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}saveNoCompress(){const e=g.automerge_saveNoCompress(this.__wbg_ptr);return P(e)}saveAndVerify(){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_saveAndVerify(o,this.__wbg_ptr);var e=v()[o/4+0],n=v()[o/4+1],r=v()[o/4+2];if(r)throw P(n);return P(e)}finally{g.__wbindgen_add_to_stack_pointer(16)}}loadIncremental(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_loadIncremental(i,this.__wbg_ptr,x(e));var n=Wr()[i/8+0],r=v()[i/4+2],o=v()[i/4+3];if(o)throw P(r);return n}finally{g.__wbindgen_add_to_stack_pointer(16)}}applyChanges(e){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_applyChanges(o,this.__wbg_ptr,x(e));var n=v()[o/4+0],r=v()[o/4+1];if(r)throw P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getChanges(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getChanges(i,this.__wbg_ptr,x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getChangeByHash(i,this.__wbg_ptr,x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(e){fn(e,on);const n=g.automerge_getChangesAdded(this.__wbg_ptr,e.__wbg_ptr);return P(n)}getHeads(){const e=g.automerge_getHeads(this.__wbg_ptr);return P(e)}getActorId(){let e,n;try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getActorId(i,this.__wbg_ptr);var r=v()[i/4+0],o=v()[i/4+1];return e=r,n=o,We(r,o)}finally{g.__wbindgen_add_to_stack_pointer(16),g.__wbindgen_free(e,n,1)}}getLastLocalChange(){const e=g.automerge_getLastLocalChange(this.__wbg_ptr);return P(e)}dump(){g.automerge_dump(this.__wbg_ptr)}getMissingDeps(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getMissingDeps(i,this.__wbg_ptr,pe(e)?0:x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(e,n){try{const i=g.__wbindgen_add_to_stack_pointer(-16);fn(e,Lt),g.automerge_receiveSyncMessage(i,this.__wbg_ptr,e.__wbg_ptr,x(n));var r=v()[i/4+0],o=v()[i/4+1];if(o)throw P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(e){fn(e,Lt);const n=g.automerge_generateSyncMessage(this.__wbg_ptr,e.__wbg_ptr);return P(n)}toJS(e){try{const i=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_toJS(i,this.__wbg_ptr,x(e));var n=v()[i/4+0],r=v()[i/4+1],o=v()[i/4+2];if(o)throw P(r);return P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}materialize(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_materialize(s,this.__wbg_ptr,x(e),pe(n)?0:x(n),x(r));var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}getCursor(e,n,r){let o,i;try{const l=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getCursor(l,this.__wbg_ptr,x(e),n,pe(r)?0:x(r));var a=v()[l/4+0],s=v()[l/4+1],c=v()[l/4+2],u=v()[l/4+3],_=a,d=s;if(u)throw _=0,d=0,P(c);return o=_,i=d,We(_,d)}finally{g.__wbindgen_add_to_stack_pointer(16),g.__wbindgen_free(o,i,1)}}getCursorPosition(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_getCursorPosition(s,this.__wbg_ptr,x(e),x(n),pe(r)?0:x(r));var o=Wr()[s/8+0],i=v()[s/4+2],a=v()[s/4+3];if(a)throw P(i);return o}finally{g.__wbindgen_add_to_stack_pointer(16)}}emptyChange(e,n){var r=pe(e)?0:pt(e,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;const i=g.automerge_emptyChange(this.__wbg_ptr,r,o,!pe(n),pe(n)?0:n);return P(i)}mark(e,n,r,o,i){try{const c=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_mark(c,this.__wbg_ptr,x(e),x(n),x(r),x(o),x(i));var a=v()[c/4+0],s=v()[c/4+1];if(s)throw P(a)}finally{g.__wbindgen_add_to_stack_pointer(16)}}unmark(e,n,r){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_unmark(a,this.__wbg_ptr,x(e),x(n),x(r));var o=v()[a/4+0],i=v()[a/4+1];if(i)throw P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}marks(e,n){try{const a=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_marks(a,this.__wbg_ptr,x(e),pe(n)?0:x(n));var r=v()[a/4+0],o=v()[a/4+1],i=v()[a/4+2];if(i)throw P(o);return P(r)}finally{g.__wbindgen_add_to_stack_pointer(16)}}marksAt(e,n,r){try{const s=g.__wbindgen_add_to_stack_pointer(-16);g.automerge_marksAt(s,this.__wbg_ptr,x(e),n,pe(r)?0:x(r));var o=v()[s/4+0],i=v()[s/4+1],a=v()[s/4+2];if(a)throw P(i);return P(o)}finally{g.__wbindgen_add_to_stack_pointer(16)}}};const Va=new FinalizationRegistry(t=>g.__wbg_syncstate_free(t>>>0));let Lt=class ma{static __wrap(e){e=e>>>0;const n=Object.create(ma.prototype);return n.__wbg_ptr=e,Va.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Va.unregister(this),e}free(){const e=this.__destroy_into_raw();g.__wbg_syncstate_free(e)}get sharedHeads(){const e=g.syncstate_sharedHeads(this.__wbg_ptr);return P(e)}get lastSentHeads(){const e=g.syncstate_lastSentHeads(this.__wbg_ptr);return P(e)}set lastSentHeads(e){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.syncstate_set_lastSentHeads(o,this.__wbg_ptr,x(e));var n=v()[o/4+0],r=v()[o/4+1];if(r)throw P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(e){try{const o=g.__wbindgen_add_to_stack_pointer(-16);g.syncstate_set_sentHashes(o,this.__wbg_ptr,x(e));var n=v()[o/4+0],r=v()[o/4+1];if(r)throw P(n)}finally{g.__wbindgen_add_to_stack_pointer(16)}}clone(){const e=g.syncstate_clone(this.__wbg_ptr);return ma.__wrap(e)}};function $a(t,e){const n=L(e),r=typeof n=="string"?n:void 0;var o=pe(r)?0:pt(r,g.__wbindgen_malloc,g.__wbindgen_realloc),i=tt;v()[t/4+1]=i,v()[t/4+0]=o}function za(t){const e=L(t);return typeof e=="object"&&e!==null}function Ha(t,e){return L(t)===L(e)}function Ka(t){P(t)}function qa(t,e){const n=new Error(We(t,e));return x(n)}function Ja(t){const e=L(t);return x(e)}function Wa(t,e){const n=We(t,e);return x(n)}function Qa(t){return x(t)}function Ya(t,e){const n=L(e),r=typeof n=="number"?n:void 0;Wr()[t/8+1]=pe(r)?0:r,v()[t/4+0]=!pe(r)}function Za(t){return L(t)===void 0}function Xa(t){const e=L(t);return typeof e=="boolean"?e?1:0:2}function Ga(t){return L(t)===null}function es(t){return typeof L(t)=="string"}function ts(t){return typeof L(t)=="function"}function ns(t){return Array.isArray(L(t))}function rs(t,e){const n=L(e),r=JSON.stringify(n===void 0?null:n),o=pt(r,g.__wbindgen_malloc,g.__wbindgen_realloc),i=tt;v()[t/4+1]=i,v()[t/4+0]=o}function os(){const t=new Error;return x(t)}function is(t,e){const n=L(e).stack,r=pt(n,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;v()[t/4+1]=o,v()[t/4+0]=r}function as(t,e){let n,r;try{n=t,r=e,console.error(We(t,e))}finally{g.__wbindgen_free(n,r,1)}}function ss(t,e){return L(t)==L(e)}function cs(t,e){const n=String(L(e)),r=pt(n,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;v()[t/4+1]=o,v()[t/4+0]=r}function us(t){return x(t)}function ds(t){const e=BigInt.asUintN(64,t);return x(e)}function _s(t,e,n){L(t)[P(e)]=P(n)}function ls(){return De(function(t,e){L(t).getRandomValues(L(e))},arguments)}function fs(){return De(function(t,e){L(t).randomFillSync(P(e))},arguments)}function hs(t){const e=L(t).crypto;return x(e)}function gs(t){const e=L(t).process;return x(e)}function ps(t){const e=L(t).versions;return x(e)}function bs(t){const e=L(t).node;return x(e)}function ys(t){const e=L(t).msCrypto;return x(e)}function ms(){return De(function(){const t=an.require;return x(t)},arguments)}function ws(t){console.log(L(t))}function vs(t,e){console.log(L(t),L(e))}function Ss(t,e){const n=L(t)[e>>>0];return x(n)}function ks(t){return L(t).length}function xs(){const t=new Array;return x(t)}function As(t,e){const n=new Function(We(t,e));return x(n)}function Es(t){const e=L(t).next;return x(e)}function Is(){return De(function(t){const e=L(t).next();return x(e)},arguments)}function Os(t){return L(t).done}function Cs(t){const e=L(t).value;return x(e)}function js(){return x(Symbol.iterator)}function Rs(){return De(function(t,e){const n=Reflect.get(L(t),L(e));return x(n)},arguments)}function Ts(){return De(function(t,e){const n=L(t).call(L(e));return x(n)},arguments)}function Ps(){const t=new Object;return x(t)}function Ms(t){return L(t).length}function Us(t,e,n){L(t)[e>>>0]=P(n)}function Ds(t){const e=Array.from(L(t));return x(e)}function Ls(t){return Array.isArray(L(t))}function Ns(t,e){return L(t).push(L(e))}function Fs(t,e){return L(t).unshift(L(e))}function Bs(t){let e;try{e=L(t)instanceof ArrayBuffer}catch{e=!1}return e}function Vs(t,e){const n=new Error(We(t,e));return x(n)}function $s(){return De(function(t,e,n){const r=L(t).call(L(e),L(n));return x(r)},arguments)}function zs(){return De(function(t,e,n,r){const o=L(t).call(L(e),L(n),L(r));return x(o)},arguments)}function Hs(t){let e;try{e=L(t)instanceof Date}catch{e=!1}return e}function Ks(t){return L(t).getTime()}function qs(t){const e=new Date(L(t));return x(e)}function Js(t){let e;try{e=L(t)instanceof Object}catch{e=!1}return e}function Ws(t,e){const n=Object.assign(L(t),L(e));return x(n)}function Qs(t,e,n){const r=Object.defineProperty(L(t),L(e),L(n));return x(r)}function Ys(t){const e=Object.entries(L(t));return x(e)}function Zs(t){const e=Object.freeze(L(t));return x(e)}function Xs(t){const e=Object.keys(L(t));return x(e)}function Gs(t){const e=Object.values(L(t));return x(e)}function ec(t,e){const n=new RangeError(We(t,e));return x(n)}function tc(){return De(function(t,e,n){const r=Reflect.apply(L(t),L(e),L(n));return x(r)},arguments)}function nc(){return De(function(t,e){return Reflect.deleteProperty(L(t),L(e))},arguments)}function rc(){return De(function(t){const e=Reflect.ownKeys(L(t));return x(e)},arguments)}function oc(){return De(function(t,e,n){return Reflect.set(L(t),L(e),L(n))},arguments)}function ic(t){const e=L(t).buffer;return x(e)}function ac(t,e){const n=L(t).concat(L(e));return x(n)}function sc(t,e,n){const r=L(t).slice(e>>>0,n>>>0);return x(r)}function cc(t,e){const n=Symbol.for(We(t,e));return x(n)}function uc(t){const e=L(t).toString();return x(e)}function dc(){return De(function(){const t=self.self;return x(t)},arguments)}function _c(){return De(function(){const t=window.window;return x(t)},arguments)}function lc(){return De(function(){const t=globalThis.globalThis;return x(t)},arguments)}function fc(){return De(function(){const t=global.global;return x(t)},arguments)}function hc(t,e,n){const r=new Uint8Array(L(t),e>>>0,n>>>0);return x(r)}function gc(t){const e=new Uint8Array(L(t));return x(e)}function pc(t,e,n){L(t).set(L(e),n>>>0)}function bc(t){return L(t).length}function yc(t){let e;try{e=L(t)instanceof Uint8Array}catch{e=!1}return e}function mc(t){const e=new Uint8Array(t>>>0);return x(e)}function wc(t,e,n){const r=L(t).subarray(e>>>0,n>>>0);return x(r)}function vc(t,e){const n=ci(L(e)),r=pt(n,g.__wbindgen_malloc,g.__wbindgen_realloc),o=tt;v()[t/4+1]=o,v()[t/4+0]=r}function Sc(t,e){throw new Error(We(t,e))}function kc(){const t=g.memory;return x(t)}URL=globalThis.URL;const N=await La({"./automerge_wasm_bg.js":{__wbindgen_string_get:$a,__wbindgen_is_object:za,__wbindgen_jsval_eq:Ha,__wbindgen_object_drop_ref:Ka,__wbindgen_error_new:qa,__wbindgen_object_clone_ref:Ja,__wbindgen_string_new:Wa,__wbindgen_number_new:Qa,__wbindgen_number_get:Ya,__wbindgen_is_undefined:Za,__wbindgen_boolean_get:Xa,__wbindgen_is_null:Ga,__wbindgen_is_string:es,__wbindgen_is_function:ts,__wbindgen_is_array:ns,__wbindgen_json_serialize:rs,__wbg_new_abda76e883ba8a5f:os,__wbg_stack_658279fe44541cf6:is,__wbg_error_f851667af71bcfc6:as,__wbindgen_jsval_loose_eq:ss,__wbg_String_91fba7ded13ba54c:cs,__wbindgen_bigint_from_i64:us,__wbindgen_bigint_from_u64:ds,__wbg_set_20cbc34131e76824:_s,__wbg_getRandomValues_37fa2ca9e4e07fab:ls,__wbg_randomFillSync_dc1e9a60c158336d:fs,__wbg_crypto_c48a774b022d20ac:hs,__wbg_process_298734cf255a885d:gs,__wbg_versions_e2e78e134e3e5d01:ps,__wbg_node_1cd7a5d853dbea79:bs,__wbg_msCrypto_bcb970640f50a1e8:ys,__wbg_require_8f08ceecec0f4fee:ms,__wbg_log_1d3ae0273d8f4f8a:ws,__wbg_log_576ca876af0d4a77:vs,__wbg_get_44be0491f933a435:Ss,__wbg_length_fff51ee6522a1a18:ks,__wbg_new_898a68150f225f2e:xs,__wbg_newnoargs_581967eacc0e2604:As,__wbg_next_526fc47e980da008:Es,__wbg_next_ddb3312ca1c4e32a:Is,__wbg_done_5c1f01fb660d73b5:Os,__wbg_value_1695675138684bd5:Cs,__wbg_iterator_97f0c81209c6c35a:js,__wbg_get_97b561fb56f034b5:Rs,__wbg_call_cb65541d95d71282:Ts,__wbg_new_b51585de1b234aff:Ps,__wbg_length_b3de0c6587c18245:Ms,__wbg_set_502d29070ea18557:Us,__wbg_from_d7c216d4616bb368:Ds,__wbg_isArray_4c24b343cb13cfb1:Ls,__wbg_push_ca1c26067ef907ac:Ns,__wbg_unshift_de5fe028746b7cec:Fs,__wbg_instanceof_ArrayBuffer_39ac22089b74fddb:Bs,__wbg_new_d258248ed531ff54:Vs,__wbg_call_01734de55d61e11d:$s,__wbg_call_4c92f6aec1e1d6e6:zs,__wbg_instanceof_Date_91c15a742581fc41:Hs,__wbg_getTime_5e2054f832d82ec9:Ks,__wbg_new_cd59bfc8881f487b:qs,__wbg_instanceof_Object_3daa8298c86298be:Js,__wbg_assign_999478a110912e87:Ws,__wbg_defineProperty_2db1bcb00cd9da96:Qs,__wbg_entries_e51f29c7bba0c054:Ys,__wbg_freeze_29fdec6af26e40df:Zs,__wbg_keys_386d224d0262f361:Xs,__wbg_values_88acfd44c7ef08d7:Gs,__wbg_new_732c49c4e03c98a1:ec,__wbg_apply_f9ecfcbfefaf7349:tc,__wbg_deleteProperty_568c26e52bc57565:nc,__wbg_ownKeys_391189872004f097:rc,__wbg_set_092e06b0f9d71865:oc,__wbg_buffer_085ec1f694018c4f:ic,__wbg_concat_c15e9c7e01e04001:ac,__wbg_slice_0a0d91ee629d603a:sc,__wbg_for_2256af0eb4ac96ac:cc,__wbg_toString_bb5de5cb12268093:uc,__wbg_self_1ff1d729e9aae938:dc,__wbg_window_5f4faef6c12b79ec:_c,__wbg_globalThis_1d39714405582d3c:lc,__wbg_global_651f05c6a0944d1c:fc,__wbg_newwithbyteoffsetandlength_6da8e527659b86aa:hc,__wbg_new_8125e318e6245eed:gc,__wbg_set_5cf90238115182c3:pc,__wbg_length_72e2208bbc0efc61:bc,__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4:yc,__wbg_newwithlength_e5d69174d6984cd7:mc,__wbg_subarray_13db269f57aa838d:wc,__wbindgen_debug_string:vc,__wbindgen_throw:Sc,__wbindgen_memory:kc}},wl),Ll=N.memory,Nl=N.__wbg_syncstate_free,Fl=N.syncstate_sharedHeads,Bl=N.syncstate_lastSentHeads,Vl=N.syncstate_set_lastSentHeads,$l=N.syncstate_set_sentHashes,zl=N.syncstate_clone,Hl=N.__wbg_automerge_free,Kl=N.automerge_new,ql=N.automerge_clone,Jl=N.automerge_fork,Wl=N.automerge_pendingOps,Ql=N.automerge_commit,Yl=N.automerge_merge,Zl=N.automerge_rollback,Xl=N.automerge_keys,Gl=N.automerge_text,ef=N.automerge_spans,tf=N.automerge_splice,nf=N.automerge_updateText,rf=N.automerge_push,of=N.automerge_pushObject,af=N.automerge_insert,sf=N.automerge_splitBlock,cf=N.automerge_joinBlock,uf=N.automerge_updateBlocks,df=N.automerge_updateBlock,_f=N.automerge_getBlock,lf=N.automerge_insertObject,ff=N.automerge_put,hf=N.automerge_putObject,gf=N.automerge_increment,pf=N.automerge_get,bf=N.automerge_getWithType,yf=N.automerge_objInfo,mf=N.automerge_getAll,wf=N.automerge_enableFreeze,vf=N.automerge_registerDatatype,Sf=N.automerge_applyPatches,kf=N.automerge_applyAndReturnPatches,xf=N.automerge_diffIncremental,Af=N.automerge_updateDiffCursor,Ef=N.automerge_resetDiffCursor,If=N.automerge_diff,Of=N.automerge_isolate,Cf=N.automerge_integrate,jf=N.automerge_length,Rf=N.automerge_delete,Tf=N.automerge_save,Pf=N.automerge_saveIncremental,Mf=N.automerge_saveSince,Uf=N.automerge_saveNoCompress,Df=N.automerge_saveAndVerify,Lf=N.automerge_loadIncremental,Nf=N.automerge_applyChanges,Ff=N.automerge_getChanges,Bf=N.automerge_getChangeByHash,Vf=N.automerge_getChangesAdded,$f=N.automerge_getHeads,zf=N.automerge_getActorId,Hf=N.automerge_getLastLocalChange,Kf=N.automerge_dump,qf=N.automerge_getMissingDeps,Jf=N.automerge_receiveSyncMessage,Wf=N.automerge_generateSyncMessage,Qf=N.automerge_toJS,Yf=N.automerge_materialize,Zf=N.automerge_getCursor,Xf=N.automerge_getCursorPosition,Gf=N.automerge_emptyChange,eh=N.automerge_mark,th=N.automerge_unmark,nh=N.automerge_marks,rh=N.automerge_marksAt,oh=N.create,ih=N.load,ah=N.encodeChange,sh=N.decodeChange,ch=N.initSyncState,uh=N.importSyncState,dh=N.exportSyncState,_h=N.encodeSyncMessage,lh=N.decodeSyncMessage,fh=N.encodeSyncState,hh=N.decodeSyncState,gh=N.__wbindgen_malloc,ph=N.__wbindgen_realloc,bh=N.__wbindgen_add_to_stack_pointer,yh=N.__wbindgen_free,mh=N.__wbindgen_exn_store,wh=Object.freeze(Object.defineProperty({__proto__:null,__wbg_automerge_free:Hl,__wbg_syncstate_free:Nl,__wbindgen_add_to_stack_pointer:bh,__wbindgen_exn_store:mh,__wbindgen_free:yh,__wbindgen_malloc:gh,__wbindgen_realloc:ph,automerge_applyAndReturnPatches:kf,automerge_applyChanges:Nf,automerge_applyPatches:Sf,automerge_clone:ql,automerge_commit:Ql,automerge_delete:Rf,automerge_diff:If,automerge_diffIncremental:xf,automerge_dump:Kf,automerge_emptyChange:Gf,automerge_enableFreeze:wf,automerge_fork:Jl,automerge_generateSyncMessage:Wf,automerge_get:pf,automerge_getActorId:zf,automerge_getAll:mf,automerge_getBlock:_f,automerge_getChangeByHash:Bf,automerge_getChanges:Ff,automerge_getChangesAdded:Vf,automerge_getCursor:Zf,automerge_getCursorPosition:Xf,automerge_getHeads:$f,automerge_getLastLocalChange:Hf,automerge_getMissingDeps:qf,automerge_getWithType:bf,automerge_increment:gf,automerge_insert:af,automerge_insertObject:lf,automerge_integrate:Cf,automerge_isolate:Of,automerge_joinBlock:cf,automerge_keys:Xl,automerge_length:jf,automerge_loadIncremental:Lf,automerge_mark:eh,automerge_marks:nh,automerge_marksAt:rh,automerge_materialize:Yf,automerge_merge:Yl,automerge_new:Kl,automerge_objInfo:yf,automerge_pendingOps:Wl,automerge_push:rf,automerge_pushObject:of,automerge_put:ff,automerge_putObject:hf,automerge_receiveSyncMessage:Jf,automerge_registerDatatype:vf,automerge_resetDiffCursor:Ef,automerge_rollback:Zl,automerge_save:Tf,automerge_saveAndVerify:Df,automerge_saveIncremental:Pf,automerge_saveNoCompress:Uf,automerge_saveSince:Mf,automerge_spans:ef,automerge_splice:tf,automerge_splitBlock:sf,automerge_text:Gl,automerge_toJS:Qf,automerge_unmark:th,automerge_updateBlock:df,automerge_updateBlocks:uf,automerge_updateDiffCursor:Af,automerge_updateText:nf,create:oh,decodeChange:sh,decodeSyncMessage:lh,decodeSyncState:hh,encodeChange:ah,encodeSyncMessage:_h,encodeSyncState:fh,exportSyncState:dh,importSyncState:uh,initSyncState:ch,load:ih,memory:Ll,syncstate_clone:zl,syncstate_lastSentHeads:Bl,syncstate_set_lastSentHeads:Vl,syncstate_set_sentHashes:$l,syncstate_sharedHeads:Fl},Symbol.toStringTag,{value:"Module"}));Na(wh);const vh=Object.freeze(Object.defineProperty({__proto__:null,Automerge:ui,SyncState:Lt,TextRepresentation:Dl,__wbg_String_91fba7ded13ba54c:cs,__wbg_apply_f9ecfcbfefaf7349:tc,__wbg_assign_999478a110912e87:Ws,__wbg_buffer_085ec1f694018c4f:ic,__wbg_call_01734de55d61e11d:$s,__wbg_call_4c92f6aec1e1d6e6:zs,__wbg_call_cb65541d95d71282:Ts,__wbg_concat_c15e9c7e01e04001:ac,__wbg_crypto_c48a774b022d20ac:hs,__wbg_defineProperty_2db1bcb00cd9da96:Qs,__wbg_deleteProperty_568c26e52bc57565:nc,__wbg_done_5c1f01fb660d73b5:Os,__wbg_entries_e51f29c7bba0c054:Ys,__wbg_error_f851667af71bcfc6:as,__wbg_for_2256af0eb4ac96ac:cc,__wbg_freeze_29fdec6af26e40df:Zs,__wbg_from_d7c216d4616bb368:Ds,__wbg_getRandomValues_37fa2ca9e4e07fab:ls,__wbg_getTime_5e2054f832d82ec9:Ks,__wbg_get_44be0491f933a435:Ss,__wbg_get_97b561fb56f034b5:Rs,__wbg_globalThis_1d39714405582d3c:lc,__wbg_global_651f05c6a0944d1c:fc,__wbg_instanceof_ArrayBuffer_39ac22089b74fddb:Bs,__wbg_instanceof_Date_91c15a742581fc41:Hs,__wbg_instanceof_Object_3daa8298c86298be:Js,__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4:yc,__wbg_isArray_4c24b343cb13cfb1:Ls,__wbg_iterator_97f0c81209c6c35a:js,__wbg_keys_386d224d0262f361:Xs,__wbg_length_72e2208bbc0efc61:bc,__wbg_length_b3de0c6587c18245:Ms,__wbg_length_fff51ee6522a1a18:ks,__wbg_log_1d3ae0273d8f4f8a:ws,__wbg_log_576ca876af0d4a77:vs,__wbg_msCrypto_bcb970640f50a1e8:ys,__wbg_new_732c49c4e03c98a1:ec,__wbg_new_8125e318e6245eed:gc,__wbg_new_898a68150f225f2e:xs,__wbg_new_abda76e883ba8a5f:os,__wbg_new_b51585de1b234aff:Ps,__wbg_new_cd59bfc8881f487b:qs,__wbg_new_d258248ed531ff54:Vs,__wbg_newnoargs_581967eacc0e2604:As,__wbg_newwithbyteoffsetandlength_6da8e527659b86aa:hc,__wbg_newwithlength_e5d69174d6984cd7:mc,__wbg_next_526fc47e980da008:Es,__wbg_next_ddb3312ca1c4e32a:Is,__wbg_node_1cd7a5d853dbea79:bs,__wbg_ownKeys_391189872004f097:rc,__wbg_process_298734cf255a885d:gs,__wbg_push_ca1c26067ef907ac:Ns,__wbg_randomFillSync_dc1e9a60c158336d:fs,__wbg_require_8f08ceecec0f4fee:ms,__wbg_self_1ff1d729e9aae938:dc,__wbg_set_092e06b0f9d71865:oc,__wbg_set_20cbc34131e76824:_s,__wbg_set_502d29070ea18557:Us,__wbg_set_5cf90238115182c3:pc,__wbg_set_wasm:Na,__wbg_slice_0a0d91ee629d603a:sc,__wbg_stack_658279fe44541cf6:is,__wbg_subarray_13db269f57aa838d:wc,__wbg_toString_bb5de5cb12268093:uc,__wbg_unshift_de5fe028746b7cec:Fs,__wbg_value_1695675138684bd5:Cs,__wbg_values_88acfd44c7ef08d7:Gs,__wbg_versions_e2e78e134e3e5d01:ps,__wbg_window_5f4faef6c12b79ec:_c,__wbindgen_bigint_from_i64:us,__wbindgen_bigint_from_u64:ds,__wbindgen_boolean_get:Xa,__wbindgen_debug_string:vc,__wbindgen_error_new:qa,__wbindgen_is_array:ns,__wbindgen_is_function:ts,__wbindgen_is_null:Ga,__wbindgen_is_object:za,__wbindgen_is_string:es,__wbindgen_is_undefined:Za,__wbindgen_json_serialize:rs,__wbindgen_jsval_eq:Ha,__wbindgen_jsval_loose_eq:ss,__wbindgen_memory:kc,__wbindgen_number_get:Ya,__wbindgen_number_new:Qa,__wbindgen_object_clone_ref:Ja,__wbindgen_object_drop_ref:Ka,__wbindgen_string_get:$a,__wbindgen_string_new:Wa,__wbindgen_throw:Sc,create:Al,decodeChange:Ol,decodeSyncMessage:Pl,decodeSyncState:Ul,encodeChange:Il,encodeSyncMessage:Tl,encodeSyncState:Ml,exportSyncState:Rl,importSyncState:jl,initSyncState:Cl,load:El},Symbol.toStringTag,{value:"Module"}));var Sh=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function kh(t,e,...n){if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");t.insertAt(e,...n)}function xh(t,e,n){if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");t.deleteAt(e,n)}function Ah(t){bl(t)}Ah(vh);function Eh(t){return re(t).handle}function di(t){return typeof t=="object"?t:{actor:t}}function Qr(t){const e=di(t),n=!!e.freeze,r=e.patchCallback,o=!e.enableTextV2,i=e.actor,a=Pe.create({actor:i,text_v1:o});a.enableFreeze(!!e.freeze),a.registerDatatype("counter",c=>new Kn(c));const s=e.enableTextV2||!1;return s?a.registerDatatype("str",(c,{context:u})=>u==="blockAttr"?c:new Fr(c)):a.registerDatatype("text",c=>new Hn(c)),a.materialize("/",void 0,{handle:a,heads:void 0,freeze:n,patchCallback:r,textV2:s})}function Ih(t,e){const n=re(t),r=n.handle;return n.handle.materialize("/",e,Object.assign(Object.assign({},n),{handle:r,heads:e}))}function Oh(t,e){const n=re(t),r=n.heads,o=di(e),i=n.handle.fork(o.actor,r);i.updateDiffCursor();const a=Sh(n,["heads"]);return a.patchCallback=o.patchCallback,i.applyPatches(t,Object.assign(Object.assign({},a),{handle:i}))}function Ch(t){return re(t).handle.free()}function jh(t,e){return Yn(Qr(e),"from",{},n=>Object.assign(n,t)).newDoc}function Rh(t,e,n){if(typeof e=="function")return Yn(t,"change",{},e).newDoc;if(typeof n=="function")return typeof e=="string"&&(e={message:e}),Yn(t,"change",e,n).newDoc;throw RangeError("Invalid args for change")}function Th(t,e,n,r){if(typeof n=="function")return Yn(t,"changeAt",{},n,e);if(typeof r=="function")return typeof n=="string"&&(n={message:n}),Yn(t,"changeAt",n,r,e);throw RangeError("Invalid args for changeAt")}function hn(t,e,n,r){if(n==null)return t;const o=re(t),i=Object.assign(Object.assign({},o),{heads:void 0}),{value:a,patches:s}=o.handle.applyAndReturnPatches(t,i);if(s.length>0){r==null||r(s,{before:t,after:a,source:e});const c=re(a);c.mostRecentPatch={before:re(t).heads,after:c.handle.getHeads(),patches:s,source:e}}return o.heads=n,a}function Yn(t,e,n,r,o){if(typeof r!="function")throw new RangeError("invalid change function");const i=re(t);if(t===void 0||i===void 0)throw new RangeError("must be the document root");if(i.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Ue(t))throw new RangeError("Calls to Automerge.change cannot be nested");let a=i.handle.getHeads();o&&zh(o,a)&&(o=void 0),o&&(i.handle.isolate(o),a=o);try{i.heads=a;const s=_l(i.handle,i.textV2);if(r(s),i.handle.pendingOps()===0)return i.heads=void 0,o&&i.handle.integrate(),{newDoc:t,newHeads:null};{const c=i.handle.commit(n.message,n.time);return i.handle.integrate(),{newDoc:hn(t,e,a,n.patchCallback||i.patchCallback),newHeads:c!=null?[c]:null}}}catch(s){throw i.heads=void 0,i.handle.rollback(),s}}function Ph(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e});const n=re(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Ue(t))throw new RangeError("Calls to Automerge.change cannot be nested");const r=n.handle.getHeads();return n.handle.emptyChange(e.message,e.time),hn(t,"emptyChange",r)}function Mh(t,e){const n=di(e),r=n.actor,o=n.patchCallback,i=!n.enableTextV2,a=n.unchecked||!1,s=n.allowMissingChanges||!1,c=n.convertRawStringsToText||!1,u=Pe.load(t,{text_v1:i,actor:r,unchecked:a,allowMissingDeps:s,convertRawStringsToText:c});u.enableFreeze(!!n.freeze),u.registerDatatype("counter",d=>new Kn(d));const _=n.enableTextV2||!1;return _?u.registerDatatype("str",d=>new Fr(d)):u.registerDatatype("text",d=>new Hn(d)),u.materialize("/",void 0,{handle:u,heads:void 0,patchCallback:o,textV2:_})}function xc(t,e,n){n||(n={});const r=re(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+si(t));if(Ue(t))throw new RangeError("Calls to Automerge.change cannot be nested");const o=r.handle.getHeads();return r.handle.loadIncremental(e),hn(t,"loadIncremental",o,n.patchCallback||r.patchCallback)}function Uh(t){const e=re(t);if(e.heads)throw new RangeError("Attempting to change an out of date document - set at: "+si(t));if(Ue(t))throw new RangeError("Calls to Automerge.change cannot be nested");return e.handle.saveIncremental()}function Dh(t){return re(t).handle.save()}function Lh(t,e){const n=re(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+si(t));const r=n.handle.getHeads(),o=re(e),i=n.handle.getChangesAdded(o.handle);return n.handle.applyChanges(i),hn(t,"merge",r,n.patchCallback)}function Nh(t){return re(t).handle.getActorId()}function Fh(t){return re(t).handle.getLastLocalChange()||void 0}function Ac(t,e){if(e){const n=re(t,!1),r=Wn(t);return!n||!r?null:n.handle.get(r,e)}else return Wn(t)}function Bh(t,e){return re(e).handle.getChanges(jc(t))}function Ec(t){return re(t).handle.getChanges([])}function Ic(t,e,n){const r=re(t);if(n||(n={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Ue(t))throw new RangeError("Calls to Automerge.change cannot be nested");const o=r.handle.getHeads();return r.handle.applyChanges(e),r.heads=o,[hn(t,"applyChanges",o,n.patchCallback||r.patchCallback)]}function Vh(t){const e=re(t).textV2,n=Ec(t);return n.map((r,o)=>({get change(){return Cc(r)},get snapshot(){const[i]=Ic(Qr({enableTextV2:e}),n.slice(0,o+1));return i}}))}function $h(t,e,n){Oc(e,"before"),Oc(n,"after");const r=re(t);return r.mostRecentPatch&&Yr(r.mostRecentPatch.before,e)&&Yr(r.mostRecentPatch.after,n)?r.mostRecentPatch.patches:r.handle.diff(e,n)}function zh(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Oc(t,e){if(!Array.isArray(t))throw new Error(`${e} must be an array`)}function Yr(t,e){if(!Rc(t)||!Rc(e))return t===e;const n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o]!==r[o]||!Yr(t[n[o]],e[r[o]]))return!1;return!0}function Hh(t){const e=Pe.importSyncState(t),n=Pe.encodeSyncState(e);return e.free(),n}function Kh(t){const e=Pe.decodeSyncState(t),n=Pe.exportSyncState(e);return e.free(),n}function qh(t,e){const n=re(t),r=Pe.importSyncState(e),o=n.handle.generateSyncMessage(r);return[Pe.exportSyncState(r),o]}function Jh(t,e,n,r){const o=Pe.importSyncState(e);r||(r={});const i=re(t);if(i.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Ue(t))throw new RangeError("Calls to Automerge.change cannot be nested");const a=i.handle.getHeads();i.handle.receiveSyncMessage(o,n);const s=Pe.exportSyncState(o);return[hn(t,"receiveSyncMessage",a,r.patchCallback||i.patchCallback),s,null]}function Wh(){return Pe.exportSyncState(Pe.initSyncState())}function Qh(t){return Pe.encodeChange(t)}function Cc(t){return Pe.decodeChange(t)}function Yh(t){return Pe.encodeSyncMessage(t)}function Zh(t){return Pe.decodeSyncMessage(t)}function Xh(t,e){return re(t).handle.getMissingDeps(e)}function jc(t){const e=re(t);return e.heads||e.handle.getHeads()}function Gh(t){re(t).handle.dump()}function eg(t){const e=re(t),n=e.handle.enableFreeze(!1),r=e.handle.materialize();return e.handle.enableFreeze(n),r}function tg(t){return typeof t=="object"&&t!==null?Ac(t)==="_root"&&!!Reflect.get(t,jt):!1}function Rc(t){return typeof t=="object"&&t!==null}function ng(t,e){return re(t).handle.saveSince(e)}const rg=Eh;function og(t){const e=Zr(t);return e.enableTextV2=!0,Qr(e)}function ig(t,e){const n=Zr(e);return n.enableTextV2=!0,Oh(t,n)}function ag(t,e){const n=Zr(e);return n.enableTextV2=!0,jh(t,n)}function sg(t,e){const n=Zr(e);return n.enableTextV2=!0,n.patchCallback?xc(Qr(n),t):Mh(t,n)}function Zr(t){return typeof t=="object"?t:{actor:t}}function Zn(t,e,n){if(typeof n=="string"){if(/^[0-9]+@[0-9a-zA-z]+$/.test(n))return t.handle.getCursorPosition(e,n);throw new RangeError("index must be a number or cursor")}else return n}function cg(t,e,n,r,o){const i=ze(t,e,"splice");if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const a=re(t,!1);ln(t),n=Zn(a,i,n);try{return a.handle.splice(i,n,r,o)}catch(s){throw new RangeError(`Cannot splice: ${s}`)}}function ug(t,e,n){const r=ze(t,e,"updateText");if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const o=re(t,!1);ln(t);try{return o.handle.updateText(r,n)}catch(i){throw new RangeError(`Cannot updateText: ${i}`)}}function dg(t,e){const n=re(t,!1),r=ze(t,e,"spans");try{return n.handle.spans(r,n.heads)}catch(o){throw new RangeError(`Cannot splice: ${o}`)}}function _g(t,e,n){const r=ze(t,e,"splitBlock"),o=re(t,!1);n=Zn(o,r,n);try{return o.handle.getBlock(r,n)}catch(i){throw new RangeError(`Cannot get block: ${i}`)}}function lg(t,e,n,r){if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const o=ze(t,e,"splitBlock"),i=re(t,!1);ln(t),n=Zn(i,o,n);try{i.handle.splitBlock(o,n,r)}catch(a){throw new RangeError(`Cannot splice: ${a}`)}}function fg(t,e,n){if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const r=ze(t,e,"joinBlock"),o=re(t,!1);ln(t),n=Zn(o,r,n);try{o.handle.joinBlock(r,n)}catch(i){throw new RangeError(`Cannot joinBlock: ${i}`)}}function hg(t,e,n,r){if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const o=ze(t,e,"updateBlock"),i=re(t,!1);ln(t),n=Zn(i,o,n);try{i.handle.updateBlock(o,n,r)}catch(a){throw new RangeError(`Cannot updateBlock: ${a}`)}}function gg(t,e,n){if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const r=ze(t,e,"updateBlock"),o=re(t,!1);ln(t);try{o.handle.updateBlocks(r,n)}catch(i){throw new RangeError(`Cannot updateBlock: ${i}`)}}function pg(t,e,n){const r=ze(t,e,"getCursor"),o=re(t,!1);try{return o.handle.getCursor(r,n)}catch(i){throw new RangeError(`Cannot getCursor: ${i}`)}}function bg(t,e,n){const r=ze(t,e,"getCursorPosition"),o=re(t,!1);try{return o.handle.getCursorPosition(r,n)}catch(i){throw new RangeError(`Cannot getCursorPosition: ${i}`)}}function yg(t,e,n,r,o){const i=ze(t,e,"mark");if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const a=re(t,!1);try{return a.handle.mark(i,n,r,o)}catch(s){throw new RangeError(`Cannot mark: ${s}`)}}function mg(t,e,n,r){const o=ze(t,e,"unmark");if(!Ue(t))throw new RangeError("object cannot be modified outside of a change block");const i=re(t,!1);try{return i.handle.unmark(o,n,r)}catch(a){throw new RangeError(`Cannot unmark: ${a}`)}}function wg(t,e){const n=ze(t,e,"marks"),r=re(t,!1);try{return r.handle.marks(n)}catch(o){throw new RangeError(`Cannot call marks(): ${o}`)}}function vg(t,e,n){const r=ze(t,e,"marksAt"),o=re(t,!1);try{return o.handle.marksAt(r,n)}catch(i){throw new RangeError(`Cannot call marksAt(): ${i}`)}}function Sg(t,e){const n=re(t,!1);if(!n.textV2)throw new Error("use getConflicts for a stable document");const r=Wn(t);if(r!=null)return yl(n.handle,r,e)}function ze(t,e,n){e=e.slice();const r=Wn(t);if(!r)throw new RangeError(`invalid object for ${n}`);return e.unshift(r),e.join("/")}const kg=Object.freeze(Object.defineProperty({__proto__:null,Counter:Kn,Float64:pl,Int:hl,RawString:Fr,Uint:gl,applyChanges:Ic,block:_g,change:Rh,changeAt:Th,clone:ig,decodeChange:Cc,decodeSyncMessage:Zh,decodeSyncState:Kh,deleteAt:xh,diff:$h,dump:Gh,emptyChange:Ph,encodeChange:Qh,encodeSyncMessage:Yh,encodeSyncState:Hh,equals:Yr,free:Ch,from:ag,generateSyncMessage:qh,getActorId:Nh,getAllChanges:Ec,getBackend:rg,getChanges:Bh,getConflicts:Sg,getCursor:pg,getCursorPosition:bg,getHeads:jc,getHistory:Vh,getLastLocalChange:Fh,getMissingDeps:Xh,getObjectId:Ac,init:og,initSyncState:Wh,insertAt:kh,isAutomerge:tg,joinBlock:fg,load:sg,loadIncremental:xc,mark:yg,marks:wg,marksAt:vg,merge:Lh,receiveSyncMessage:Jh,save:Dh,saveIncremental:Uh,saveSince:ng,spans:dg,splice:cg,splitBlock:lg,toJS:eg,unmark:mg,updateBlock:hg,updateBlocks:gg,updateText:ug,view:Ih},Symbol.toStringTag,{value:"Module"})),Nt=Symbol.for("_am_meta"),gn=Symbol.for("_am_trace"),pn=Symbol.for("_am_objectId"),Xr=Symbol.for("_am_isProxy"),Tc=Symbol.for("_am_clearCache"),xg=Symbol.for("_am_uint"),Ag=Symbol.for("_am_int"),Eg=Symbol.for("_am_f64"),Pc=Symbol.for("_am_counter"),Ig=Symbol.for("_am_text");class Tt{constructor(e){if(typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,Ig,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[Symbol.iterator](){const e=this.elems;let n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const e of this.elems)typeof e=="string"?this.str+=e:this.str+="\uFFFC"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(const n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[Nt])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[Nt])throw new RangeError("object cannot be modified outside of a change block");n.every(r=>typeof r=="string")?this.elems.splice(e,0,...n.join("")):this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[Nt])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new Tt(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new Tt(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){return new Tt(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}}class _i{constructor(e){this.value=e||0,Reflect.defineProperty(this,Pc,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}increment(e){throw new Error("Counters should not be incremented outside of a change callback")}decrement(e){throw new Error("Counters should not be decremented outside of a change callback")}}class Og extends _i{constructor(e,n,r,o,i){super(e),this.context=n,this.path=r,this.objectId=o,this.key=i}increment(e){return e=typeof e=="number"?e:1,this.context.increment(this.objectId,this.key,e),this.value+=e,this.value}decrement(e){return this.increment(typeof e=="number"?-e:-1)}}function Cg(t,e,n,r,o){return new Og(t,e,n,r,o)}class li{constructor(e){this.val=e}toString(){return this.val}}function bt(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function nt(t,e){const{context:n,objectId:r,path:o,textV2:i}=t,a=n.getWithType(r,e);if(a===null)return;const s=a[0],c=a[1];switch(s){case void 0:return;case"map":return Xn(n,c,i,[...o,e]);case"list":return to(n,c,i,[...o,e]);case"text":return i?n.text(c):Gn(n,c,[...o,e]);case"str":return c;case"uint":return c;case"int":return c;case"f64":return c;case"boolean":return c;case"null":return null;case"bytes":return c;case"timestamp":return c;case"counter":return Cg(c,n,o,r,e);default:throw RangeError(`datatype ${s} unimplemented`)}}function Gr(t,e,n){switch(typeof t){case"object":if(t==null)return[null,"null"];if(t[xg])return[t.value,"uint"];if(t[Ag])return[t.value,"int"];if(t[Eg])return[t.value,"f64"];if(t[Pc])return[t.value,"counter"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(t instanceof li)return[t.toString(),"str"];if(t instanceof Tt)return[t,"text"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.getPrototypeOf(t)===Object.getPrototypeOf({}))return[t,"map"];throw eo(t,context)?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return e?[t,"text"]:[t,"str"];default:throw new RangeError(`Unsupported type ${typeof t} for path ${Mg(n)}`)}}function eo(t,e){var n,r;return t instanceof Date?!1:!!(t&&((r=(n=t[Nt])===null||n===void 0?void 0:n.handle)===null||r===void 0?void 0:r.__wbg_ptr)===e.__wbg_ptr)}const jg={get(t,e){const{context:n,objectId:r,cache:o}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===pn?r:e===Xr?!0:e===gn?t.trace:e===Nt?{handle:n}:(o[e]||(o[e]=nt(t,e)),o[e])},set(t,e,n){const{context:r,objectId:o,path:i,textV2:a}=t;if(t.cache={},eo(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===gn)return t.trace=n,!0;if(e===Tc)return!0;const[s,c]=Gr(n,a,[...i,e]);switch(c){case"list":{const u=r.putObject(o,e,[]),_=to(r,u,a,[...i,e]);for(let d=0;d<s.length;d++)_[d]=s[d];break}case"text":{if(a)no(s),r.putObject(o,e,s);else{hi(s);const u=r.putObject(o,e,"");Gn(r,u,[...i,e]).splice(0,0,...s)}break}case"map":{const u=r.putObject(o,e,{}),_=Xn(r,u,a,[...i,e]);for(const d in s)_[d]=s[d];break}default:r.put(o,e,s,c)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;return t.cache={},n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){const n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){const{context:e,objectId:n}=t,r=e.keys(n);return[...new Set(r)]}},Mc={get(t,e){const{context:n,objectId:r}=t;return e=bt(e),e===Symbol.hasInstance?o=>Array.isArray(o):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===pn?r:e===Xr?!0:e===gn?t.trace:e===Nt?{handle:n}:e==="length"?n.length(r):typeof e=="number"?nt(t,e):fi(t)[e]},set(t,e,n){const{context:r,objectId:o,path:i,textV2:a}=t;if(e=bt(e),eo(n,r))throw new RangeError("Cannot create a reference to an existing document object");if(e===Tc)return!0;if(e===gn)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");const[s,c]=Gr(n,a,[...i,e]);switch(c){case"list":{let u;e>=r.length(o)?u=r.insertObject(o,e,[]):u=r.putObject(o,e,[]),to(r,u,a,[...i,e]).splice(0,0,...s);break}case"text":{if(a)no(s),e>=r.length(o)?r.insertObject(o,e,s):r.putObject(o,e,s);else{let u;hi(s),e>=r.length(o)?u=r.insertObject(o,e,""):u=r.putObject(o,e,""),Gn(r,u,[...i,e]).splice(0,0,...s)}break}case"map":{let u;e>=r.length(o)?u=r.insertObject(o,e,{}):u=r.putObject(o,e,{});const _=Xn(r,u,a,[...i,e]);for(const d in s)_[d]=s[d];break}default:e>=r.length(o)?r.insert(o,e,s,c):r.put(o,e,s,c)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;e=bt(e);const o=n.get(r,e);if(o!=null&&o[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){const{context:n,objectId:r}=t;return e=bt(e),typeof e=="number"?e<n.length(r):e==="length"},getOwnPropertyDescriptor(t,e){const{context:n,objectId:r}=t;return e==="length"?{writable:!0,value:n.length(r)}:e===pn?{configurable:!1,enumerable:!1,value:r}:(e=bt(e),{configurable:!0,enumerable:!0,value:nt(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){const t=[];return t.push("length"),t}},Rg=Object.assign({},Mc,{get(t,e){const{context:n,objectId:r}=t;return e=bt(e),e===Symbol.hasInstance?o=>Array.isArray(o):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===pn?r:e===Xr?!0:e===gn?t.trace:e===Nt?{handle:n}:e==="length"?n.length(r):typeof e=="number"?nt(t,e):Pg(t)[e]||fi(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new Tt)}});function Xn(t,e,n,r){const o={context:t,objectId:e,path:r||[],cache:{},textV2:n},i={};return Object.assign(i,o),new Proxy(i,jg)}function to(t,e,n,r){const o={context:t,objectId:e,path:r||[],cache:{},textV2:n},i=[];return Object.assign(i,o),new Proxy(i,Mc)}function Gn(t,e,n){const r={context:t,objectId:e,path:n||[],cache:{},textV2:!1},o={};return Object.assign(o,r),new Proxy(o,Rg)}function Tg(t,e){return Xn(t,"_root",e,[])}function fi(t){const{context:e,objectId:n,path:r,textV2:o}=t;return{deleteAt(i,a){return typeof a=="number"?e.splice(n,i,a):e.delete(n,i),this},fill(i,a,s){const[c,u]=Gr(i,o,[...r,a]),_=e.length(n);a=bt(a||0),s=bt(s||_);for(let d=a;d<Math.min(s,_);d++)if(u==="list"||u==="map")e.putObject(n,d,c);else if(u==="text")if(o)no(c),e.putObject(n,d,c);else{hi(c);const l=e.putObject(n,d,""),f=Gn(e,l,[...r,d]);for(let m=0;m<c.length;m++)f[m]=c.get(m)}else e.put(n,d,c,u);return this},indexOf(i,a=0){const s=e.length(n);for(let c=a;c<s;c++){const u=e.getWithType(n,c);if(u&&(u[1]===i[pn]||u[1]===i))return c}return-1},insertAt(i,...a){return this.splice(i,0,...a),this},pop(){const i=e.length(n);if(i==0)return;const a=nt(t,i-1);return e.delete(n,i-1),a},push(...i){const a=e.length(n);return this.splice(a,0,...i),e.length(n)},shift(){if(e.length(n)==0)return;const i=nt(t,0);return e.delete(n,0),i},splice(i,a,...s){i=bt(i),typeof a!="number"&&(a=e.length(n)-i),a=bt(a);for(const _ of s)if(eo(_,e))throw new RangeError("Cannot create a reference to an existing document object");const c=[];for(let _=0;_<a;_++){const d=nt(t,i);d!==void 0&&c.push(d),e.delete(n,i)}const u=s.map((_,d)=>{try{return Gr(_,o,[...r])}catch(l){throw l instanceof RangeError?new RangeError(`${l.message} at index ${d} in the input`):l}});for(const[_,d]of u){switch(d){case"list":{const l=e.insertObject(n,i,[]);to(e,l,o,[...r,i]).splice(0,0,..._);break}case"text":{if(o)no(_),e.insertObject(n,i,_);else{const l=e.insertObject(n,i,"");Gn(e,l,[...r,i]).splice(0,0,..._)}break}case"map":{const l=e.insertObject(n,i,{}),f=Xn(e,l,o,[...r,i]);for(const m in _)f[m]=_[m];break}default:e.insert(n,i,_,d)}i+=1}return c},unshift(...i){return this.splice(0,0,...i),e.length(n)},entries(){let i=0;return{next:()=>{const a=nt(t,i);return a===void 0?{value:void 0,done:!0}:{value:[i++,a],done:!1}},[Symbol.iterator](){return this}}},keys(){let i=0;const a=e.length(n);return{next:()=>i<a?{value:i++,done:!1}:{value:void 0,done:!0},[Symbol.iterator](){return this}}},values(){let i=0;return{next:()=>{const a=nt(t,i++);return a===void 0?{value:void 0,done:!0}:{value:a,done:!1}},[Symbol.iterator](){return this}}},toArray(){const i=[];let a;do a=nt(t,i.length),a!==void 0&&i.push(a);while(a!==void 0);return i},map(i){return this.toArray().map(i)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(i){return this.toArray().forEach(i)},concat(i){return this.toArray().concat(i)},every(i){return this.toArray().every(i)},filter(i){return this.toArray().filter(i)},find(i){let a=0;for(const s of this){if(i(s,a))return s;a+=1}},findIndex(i){let a=0;for(const s of this){if(i(s,a))return a;a+=1}return-1},includes(i){return this.find(a=>a===i)!==void 0},join(i){return this.toArray().join(i)},reduce(i,a){return this.toArray().reduce(i,a)},reduceRight(i,a){return this.toArray().reduceRight(i,a)},lastIndexOf(i,a=1/0){return this.toArray().lastIndexOf(i,a)},slice(i,a){return this.toArray().slice(i,a)},some(i){let a=0;for(const s of this){if(i(s,a))return!0;a+=1}return!1},[Symbol.iterator]:function*(){let i=0,a=nt(t,i);for(;a!==void 0;)yield a,i+=1,a=nt(t,i)}}}function Pg(t){const{context:e,objectId:n}=t;return{set(r,o){return this[r]=o},get(r){return this[r]},toString(){return e.text(n).replace(/ï¿¼/g,"")},toSpans(){const r=[];let o="";const i=e.length(n);for(let a=0;a<i;a++){const s=this[a];typeof s=="string"?o+=s:(o.length>0&&(r.push(o),o=""),r.push(s))}return o.length>0&&r.push(o),r},toJSON(){return this.toString()},indexOf(r,o=0){return e.text(n).indexOf(r,o)},insertAt(r,...o){o.every(i=>typeof i=="string")?e.splice(n,r,0,o.join("")):fi(t).insertAt(r,...o)}}}function hi(t){if(!(t instanceof Tt))throw new Error("value was not a Text instance")}function no(t){if(typeof t!="string")throw new Error("value was not a string")}function Mg(t){const e=t.map(n=>{if(typeof n=="number")return n.toString();if(typeof n=="string")return n.replace(/~/g,"~0").replace(/\//g,"~1")});return t.length===0?"":"/"+e.join("/")}function Ug(t){for(const e in t)He[e]=t[e]}const He={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};function Ne(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");const n=Reflect.get(t,Nt);if(n===void 0||n==null||e&&Dg(t)!=="_root")throw new RangeError("must be the document root");return n}function Uc(t){return Reflect.get(t,gn)}function Dg(t){return typeof t!="object"||t===null?null:Reflect.get(t,pn)}function ro(t){return!!Reflect.get(t,Xr)}const Lg="/automerge_wasm_bg2.wasm";let p;function Dc(t){p=t}const Pt=new Array(128).fill(void 0);Pt.push(void 0,null,!0,!1);function B(t){return Pt[t]}let rt=0,oo=null;function io(){return(oo===null||oo.byteLength===0)&&(oo=new Uint8Array(p.memory.buffer)),oo}const Ng=typeof TextEncoder>"u"?(0,an.require)("util").TextEncoder:TextEncoder;let ao=new Ng("utf-8");const Fg=typeof ao.encodeInto=="function"?function(t,e){return ao.encodeInto(t,e)}:function(t,e){const n=ao.encode(t);return e.set(n),{read:t.length,written:n.length}};function yt(t,e,n){if(n===void 0){const s=ao.encode(t),c=e(s.length,1)>>>0;return io().subarray(c,c+s.length).set(s),rt=s.length,c}let r=t.length,o=e(r,1)>>>0;const i=io();let a=0;for(;a<r;a++){const s=t.charCodeAt(a);if(s>127)break;i[o+a]=s}if(a!==r){a!==0&&(t=t.slice(a)),o=n(o,r,r=a+t.length*3,1)>>>0;const s=io().subarray(o+a,o+r),c=Fg(t,s);a+=c.written}return rt=a,o}function me(t){return t==null}let so=null;function S(){return(so===null||so.byteLength===0)&&(so=new Int32Array(p.memory.buffer)),so}let er=Pt.length;function Bg(t){t<132||(Pt[t]=er,er=t)}function U(t){const e=B(t);return Bg(t),e}const Vg=typeof TextDecoder>"u"?(0,an.require)("util").TextDecoder:TextDecoder;let Lc=new Vg("utf-8",{ignoreBOM:!0,fatal:!0});Lc.decode();function Qe(t,e){return t=t>>>0,Lc.decode(io().subarray(t,t+e))}function A(t){er===Pt.length&&Pt.push(Pt.length+1);const e=er;return er=Pt[e],Pt[e]=t,e}let co=null;function uo(){return(co===null||co.byteLength===0)&&(co=new Float64Array(p.memory.buffer)),co}function gi(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let i="[";o>0&&(i+=gi(t[0]));for(let a=1;a<o;a++)i+=", "+gi(t[a]);return i+="]",i}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function bn(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function $g(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.create(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return mt.__wrap(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function zg(t,e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.load(i,A(t),A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return mt.__wrap(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function Hg(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.encodeChange(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return U(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function Kg(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.decodeChange(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return U(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function qg(){const t=p.initSyncState();return dt.__wrap(t)}function Jg(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.importSyncState(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return dt.__wrap(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function Wg(t){bn(t,dt);const e=p.exportSyncState(t.__wbg_ptr);return U(e)}function Qg(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.encodeSyncMessage(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return U(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function Yg(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.decodeSyncMessage(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return U(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function Zg(t){bn(t,dt);const e=p.encodeSyncState(t.__wbg_ptr);return U(e)}function Xg(t){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.decodeSyncState(o,A(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return dt.__wrap(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}function Fe(t,e){try{return t.apply(this,e)}catch(n){p.__wbindgen_exn_store(A(n))}}const Gg=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),Nc=new FinalizationRegistry(t=>p.__wbg_automerge_free(t>>>0));class mt{static __wrap(e){e=e>>>0;const n=Object.create(mt.prototype);return n.__wbg_ptr=e,Nc.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Nc.unregister(this),e}free(){const e=this.__destroy_into_raw();p.__wbg_automerge_free(e)}static new(e,n){try{const c=p.__wbindgen_add_to_stack_pointer(-16);var r=me(e)?0:yt(e,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;p.automerge_new(c,r,o,n);var i=S()[c/4+0],a=S()[c/4+1],s=S()[c/4+2];if(s)throw U(a);return mt.__wrap(i)}finally{p.__wbindgen_add_to_stack_pointer(16)}}clone(e){try{const s=p.__wbindgen_add_to_stack_pointer(-16);var n=me(e)?0:yt(e,p.__wbindgen_malloc,p.__wbindgen_realloc),r=rt;p.automerge_clone(s,this.__wbg_ptr,n,r);var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return mt.__wrap(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}fork(e,n){try{const c=p.__wbindgen_add_to_stack_pointer(-16);var r=me(e)?0:yt(e,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;p.automerge_fork(c,this.__wbg_ptr,r,o,A(n));var i=S()[c/4+0],a=S()[c/4+1],s=S()[c/4+2];if(s)throw U(a);return mt.__wrap(i)}finally{p.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const e=p.automerge_pendingOps(this.__wbg_ptr);return U(e)}commit(e,n){var r=me(e)?0:yt(e,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;const i=p.automerge_commit(this.__wbg_ptr,r,o,!me(n),me(n)?0:n);return U(i)}merge(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);bn(e,mt),p.automerge_merge(i,this.__wbg_ptr,e.__wbg_ptr);var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}rollback(){return p.automerge_rollback(this.__wbg_ptr)}keys(e,n){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_keys(a,this.__wbg_ptr,A(e),me(n)?0:A(n));var r=S()[a/4+0],o=S()[a/4+1],i=S()[a/4+2];if(i)throw U(o);return U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}text(e,n){let r,o;try{const d=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_text(d,this.__wbg_ptr,A(e),me(n)?0:A(n));var i=S()[d/4+0],a=S()[d/4+1],s=S()[d/4+2],c=S()[d/4+3],u=i,_=a;if(c)throw u=0,_=0,U(s);return r=u,o=_,Qe(u,_)}finally{p.__wbindgen_add_to_stack_pointer(16),p.__wbindgen_free(r,o,1)}}splice(e,n,r,o){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_splice(s,this.__wbg_ptr,A(e),n,r,A(o));var i=S()[s/4+0],a=S()[s/4+1];if(a)throw U(i)}finally{p.__wbindgen_add_to_stack_pointer(16)}}updateText(e,n){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_updateText(i,this.__wbg_ptr,A(e),A(n));var r=S()[i/4+0],o=S()[i/4+1];if(o)throw U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}push(e,n,r){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_push(a,this.__wbg_ptr,A(e),A(n),A(r));var o=S()[a/4+0],i=S()[a/4+1];if(i)throw U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}pushObject(e,n){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_pushObject(s,this.__wbg_ptr,A(e),A(n));var r=S()[s/4+0],o=S()[s/4+1],i=S()[s/4+2],a=S()[s/4+3];if(a)throw U(i);let c;return r!==0&&(c=Qe(r,o).slice(),p.__wbindgen_free(r,o*1,1)),c}finally{p.__wbindgen_add_to_stack_pointer(16)}}insert(e,n,r,o){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_insert(s,this.__wbg_ptr,A(e),n,A(r),A(o));var i=S()[s/4+0],a=S()[s/4+1];if(a)throw U(i)}finally{p.__wbindgen_add_to_stack_pointer(16)}}insertObject(e,n,r){try{const c=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_insertObject(c,this.__wbg_ptr,A(e),n,A(r));var o=S()[c/4+0],i=S()[c/4+1],a=S()[c/4+2],s=S()[c/4+3];if(s)throw U(a);let u;return o!==0&&(u=Qe(o,i).slice(),p.__wbindgen_free(o,i*1,1)),u}finally{p.__wbindgen_add_to_stack_pointer(16)}}put(e,n,r,o){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_put(s,this.__wbg_ptr,A(e),A(n),A(r),A(o));var i=S()[s/4+0],a=S()[s/4+1];if(a)throw U(i)}finally{p.__wbindgen_add_to_stack_pointer(16)}}putObject(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_putObject(s,this.__wbg_ptr,A(e),A(n),A(r));var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}increment(e,n,r){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_increment(a,this.__wbg_ptr,A(e),A(n),A(r));var o=S()[a/4+0],i=S()[a/4+1];if(i)throw U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}get(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_get(s,this.__wbg_ptr,A(e),A(n),me(r)?0:A(r));var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}getWithType(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getWithType(s,this.__wbg_ptr,A(e),A(n),me(r)?0:A(r));var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}getAll(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getAll(s,this.__wbg_ptr,A(e),A(n),me(r)?0:A(r));var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_enableFreeze(i,this.__wbg_ptr,A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(e,n){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_registerDatatype(i,this.__wbg_ptr,A(e),A(n));var r=S()[i/4+0],o=S()[i/4+1];if(o)throw U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}applyPatches(e,n){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_applyPatches(a,this.__wbg_ptr,A(e),A(n));var r=S()[a/4+0],o=S()[a/4+1],i=S()[a/4+2];if(i)throw U(o);return U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}applyAndReturnPatches(e,n){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_applyAndReturnPatches(a,this.__wbg_ptr,A(e),A(n));var r=S()[a/4+0],o=S()[a/4+1],i=S()[a/4+2];if(i)throw U(o);return U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}diffIncremental(){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_diffIncremental(o,this.__wbg_ptr);var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return U(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}updateDiffCursor(){p.automerge_updateDiffCursor(this.__wbg_ptr)}resetDiffCursor(){p.automerge_resetDiffCursor(this.__wbg_ptr)}diff(e,n){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_diff(a,this.__wbg_ptr,A(e),A(n));var r=S()[a/4+0],o=S()[a/4+1],i=S()[a/4+2];if(i)throw U(o);return U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}isolate(e){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_isolate(o,this.__wbg_ptr,A(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}integrate(){p.automerge_integrate(this.__wbg_ptr)}length(e,n){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_length(a,this.__wbg_ptr,A(e),me(n)?0:A(n));var r=uo()[a/8+0],o=S()[a/4+2],i=S()[a/4+3];if(i)throw U(o);return r}finally{p.__wbindgen_add_to_stack_pointer(16)}}delete(e,n){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_delete(i,this.__wbg_ptr,A(e),A(n));var r=S()[i/4+0],o=S()[i/4+1];if(o)throw U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}save(){const e=p.automerge_save(this.__wbg_ptr);return U(e)}saveIncremental(){const e=p.automerge_saveIncremental(this.__wbg_ptr);return U(e)}saveSince(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_saveSince(i,this.__wbg_ptr,A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}saveNoCompress(){const e=p.automerge_saveNoCompress(this.__wbg_ptr);return U(e)}saveAndVerify(){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_saveAndVerify(o,this.__wbg_ptr);var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw U(n);return U(e)}finally{p.__wbindgen_add_to_stack_pointer(16)}}loadIncremental(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_loadIncremental(i,this.__wbg_ptr,A(e));var n=uo()[i/8+0],r=S()[i/4+2],o=S()[i/4+3];if(o)throw U(r);return n}finally{p.__wbindgen_add_to_stack_pointer(16)}}applyChanges(e){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_applyChanges(o,this.__wbg_ptr,A(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}getChanges(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getChanges(i,this.__wbg_ptr,A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getChangeByHash(i,this.__wbg_ptr,A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(e){bn(e,mt);const n=p.automerge_getChangesAdded(this.__wbg_ptr,e.__wbg_ptr);return U(n)}getHeads(){const e=p.automerge_getHeads(this.__wbg_ptr);return U(e)}getActorId(){let e,n;try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getActorId(i,this.__wbg_ptr);var r=S()[i/4+0],o=S()[i/4+1];return e=r,n=o,Qe(r,o)}finally{p.__wbindgen_add_to_stack_pointer(16),p.__wbindgen_free(e,n,1)}}getLastLocalChange(){const e=p.automerge_getLastLocalChange(this.__wbg_ptr);return U(e)}dump(){p.automerge_dump(this.__wbg_ptr)}getMissingDeps(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getMissingDeps(i,this.__wbg_ptr,me(e)?0:A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(e,n){try{const i=p.__wbindgen_add_to_stack_pointer(-16);bn(e,dt),p.automerge_receiveSyncMessage(i,this.__wbg_ptr,e.__wbg_ptr,A(n));var r=S()[i/4+0],o=S()[i/4+1];if(o)throw U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(e){bn(e,dt);const n=p.automerge_generateSyncMessage(this.__wbg_ptr,e.__wbg_ptr);return U(n)}toJS(e){try{const i=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_toJS(i,this.__wbg_ptr,A(e));var n=S()[i/4+0],r=S()[i/4+1],o=S()[i/4+2];if(o)throw U(r);return U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}materialize(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_materialize(s,this.__wbg_ptr,A(e),me(n)?0:A(n),A(r));var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}getCursor(e,n,r){let o,i;try{const l=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getCursor(l,this.__wbg_ptr,A(e),n,me(r)?0:A(r));var a=S()[l/4+0],s=S()[l/4+1],c=S()[l/4+2],u=S()[l/4+3],_=a,d=s;if(u)throw _=0,d=0,U(c);return o=_,i=d,Qe(_,d)}finally{p.__wbindgen_add_to_stack_pointer(16),p.__wbindgen_free(o,i,1)}}getCursorPosition(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_getCursorPosition(s,this.__wbg_ptr,A(e),A(n),me(r)?0:A(r));var o=uo()[s/8+0],i=S()[s/4+2],a=S()[s/4+3];if(a)throw U(i);return o}finally{p.__wbindgen_add_to_stack_pointer(16)}}emptyChange(e,n){var r=me(e)?0:yt(e,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;const i=p.automerge_emptyChange(this.__wbg_ptr,r,o,!me(n),me(n)?0:n);return U(i)}mark(e,n,r,o,i){try{const c=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_mark(c,this.__wbg_ptr,A(e),A(n),A(r),A(o),A(i));var a=S()[c/4+0],s=S()[c/4+1];if(s)throw U(a)}finally{p.__wbindgen_add_to_stack_pointer(16)}}unmark(e,n,r){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_unmark(a,this.__wbg_ptr,A(e),A(n),A(r));var o=S()[a/4+0],i=S()[a/4+1];if(i)throw U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}marks(e,n){try{const a=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_marks(a,this.__wbg_ptr,A(e),me(n)?0:A(n));var r=S()[a/4+0],o=S()[a/4+1],i=S()[a/4+2];if(i)throw U(o);return U(r)}finally{p.__wbindgen_add_to_stack_pointer(16)}}marksAt(e,n,r){try{const s=p.__wbindgen_add_to_stack_pointer(-16);p.automerge_marksAt(s,this.__wbg_ptr,A(e),n,me(r)?0:A(r));var o=S()[s/4+0],i=S()[s/4+1],a=S()[s/4+2];if(a)throw U(i);return U(o)}finally{p.__wbindgen_add_to_stack_pointer(16)}}}const Fc=new FinalizationRegistry(t=>p.__wbg_syncstate_free(t>>>0));class dt{static __wrap(e){e=e>>>0;const n=Object.create(dt.prototype);return n.__wbg_ptr=e,Fc.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Fc.unregister(this),e}free(){const e=this.__destroy_into_raw();p.__wbg_syncstate_free(e)}get sharedHeads(){const e=p.syncstate_sharedHeads(this.__wbg_ptr);return U(e)}get lastSentHeads(){const e=p.syncstate_lastSentHeads(this.__wbg_ptr);return U(e)}set lastSentHeads(e){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.syncstate_set_lastSentHeads(o,this.__wbg_ptr,A(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(e){try{const o=p.__wbindgen_add_to_stack_pointer(-16);p.syncstate_set_sentHashes(o,this.__wbg_ptr,A(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw U(n)}finally{p.__wbindgen_add_to_stack_pointer(16)}}clone(){const e=p.syncstate_clone(this.__wbg_ptr);return dt.__wrap(e)}}function Bc(t,e){const n=B(e),r=typeof n=="string"?n:void 0;var o=me(r)?0:yt(r,p.__wbindgen_malloc,p.__wbindgen_realloc),i=rt;S()[t/4+1]=i,S()[t/4+0]=o}function Vc(t){U(t)}function $c(t,e){const n=new Error(Qe(t,e));return A(n)}function zc(t){const e=B(t);return A(e)}function Hc(t,e){const n=Qe(t,e);return A(n)}function Kc(t){return A(t)}function qc(t,e){const n=B(e),r=typeof n=="number"?n:void 0;uo()[t/8+1]=me(r)?0:r,S()[t/4+0]=!me(r)}function Jc(t){return B(t)===void 0}function Wc(t){const e=B(t);return typeof e=="boolean"?e?1:0:2}function Qc(t){return B(t)===null}function Yc(t){return typeof B(t)=="function"}function Zc(t){return typeof B(t)=="string"}function Xc(t){const e=B(t);return typeof e=="object"&&e!==null}function Gc(t){return Array.isArray(B(t))}function eu(t,e){const n=B(e),r=JSON.stringify(n===void 0?null:n),o=yt(r,p.__wbindgen_malloc,p.__wbindgen_realloc),i=rt;S()[t/4+1]=i,S()[t/4+0]=o}function tu(){const t=new Error;return A(t)}function nu(t,e){const n=B(e).stack,r=yt(n,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;S()[t/4+1]=o,S()[t/4+0]=r}function ru(t,e){let n,r;try{n=t,r=e,console.error(Qe(t,e))}finally{p.__wbindgen_free(n,r,1)}}function ou(t,e){return B(t)==B(e)}function iu(t,e){const n=String(B(e)),r=yt(n,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;S()[t/4+1]=o,S()[t/4+0]=r}function au(t){return A(t)}function su(t){const e=BigInt.asUintN(64,t);return A(e)}function cu(t,e,n){B(t)[U(e)]=U(n)}function uu(){return Fe(function(t,e){B(t).getRandomValues(B(e))},arguments)}function du(){return Fe(function(t,e){B(t).randomFillSync(U(e))},arguments)}function _u(t){const e=B(t).crypto;return A(e)}function lu(t){const e=B(t).process;return A(e)}function fu(t){const e=B(t).versions;return A(e)}function hu(t){const e=B(t).node;return A(e)}function gu(t){const e=B(t).msCrypto;return A(e)}function pu(){return Fe(function(){const t=an.require;return A(t)},arguments)}function bu(t){console.log(B(t))}function yu(t,e){console.log(B(t),B(e))}function mu(t,e){const n=B(t)[e>>>0];return A(n)}function wu(t){return B(t).length}function vu(){const t=new Array;return A(t)}function Su(t,e){const n=new Function(Qe(t,e));return A(n)}function ku(t){const e=B(t).next;return A(e)}function xu(){return Fe(function(t){const e=B(t).next();return A(e)},arguments)}function Au(t){return B(t).done}function Eu(t){const e=B(t).value;return A(e)}function Iu(){return A(Symbol.iterator)}function Ou(){return Fe(function(t,e){const n=Reflect.get(B(t),B(e));return A(n)},arguments)}function Cu(){return Fe(function(t,e){const n=B(t).call(B(e));return A(n)},arguments)}function ju(){const t=new Object;return A(t)}function Ru(t){return B(t).length}function Tu(t,e,n){B(t)[e>>>0]=U(n)}function Pu(t){const e=Array.from(B(t));return A(e)}function Mu(t){return Array.isArray(B(t))}function Uu(t,e){return B(t).push(B(e))}function Du(t,e){return B(t).unshift(B(e))}function Lu(t){let e;try{e=B(t)instanceof ArrayBuffer}catch{e=!1}return e}function Nu(t,e){const n=new Error(Qe(t,e));return A(n)}function Fu(){return Fe(function(t,e,n){const r=B(t).call(B(e),B(n));return A(r)},arguments)}function Bu(t){let e;try{e=B(t)instanceof Date}catch{e=!1}return e}function Vu(t){return B(t).getTime()}function $u(t){const e=new Date(B(t));return A(e)}function zu(t){let e;try{e=B(t)instanceof Object}catch{e=!1}return e}function Hu(t,e){const n=Object.assign(B(t),B(e));return A(n)}function Ku(t,e,n){const r=Object.defineProperty(B(t),B(e),B(n));return A(r)}function qu(t){const e=Object.entries(B(t));return A(e)}function Ju(t){const e=Object.freeze(B(t));return A(e)}function Wu(t){const e=Object.keys(B(t));return A(e)}function Qu(t){const e=Object.values(B(t));return A(e)}function Yu(t,e){const n=new RangeError(Qe(t,e));return A(n)}function Zu(){return Fe(function(t,e,n){const r=Reflect.apply(B(t),B(e),B(n));return A(r)},arguments)}function Xu(){return Fe(function(t,e){return Reflect.deleteProperty(B(t),B(e))},arguments)}function Gu(){return Fe(function(t){const e=Reflect.ownKeys(B(t));return A(e)},arguments)}function ed(){return Fe(function(t,e,n){return Reflect.set(B(t),B(e),B(n))},arguments)}function td(t){const e=B(t).buffer;return A(e)}function nd(t,e){const n=B(t).concat(B(e));return A(n)}function rd(t,e,n){const r=B(t).slice(e>>>0,n>>>0);return A(r)}function od(t,e){const n=Symbol.for(Qe(t,e));return A(n)}function id(t){const e=B(t).toString();return A(e)}function ad(){return Fe(function(){const t=self.self;return A(t)},arguments)}function sd(){return Fe(function(){const t=window.window;return A(t)},arguments)}function cd(){return Fe(function(){const t=globalThis.globalThis;return A(t)},arguments)}function ud(){return Fe(function(){const t=global.global;return A(t)},arguments)}function dd(t,e,n){const r=new Uint8Array(B(t),e>>>0,n>>>0);return A(r)}function _d(t){const e=new Uint8Array(B(t));return A(e)}function ld(t,e,n){B(t).set(B(e),n>>>0)}function fd(t){return B(t).length}function hd(t){let e;try{e=B(t)instanceof Uint8Array}catch{e=!1}return e}function gd(t){const e=new Uint8Array(t>>>0);return A(e)}function pd(t,e,n){const r=B(t).subarray(e>>>0,n>>>0);return A(r)}function bd(t,e){const n=gi(B(e)),r=yt(n,p.__wbindgen_malloc,p.__wbindgen_realloc),o=rt;S()[t/4+1]=o,S()[t/4+0]=r}function yd(t,e){throw new Error(Qe(t,e))}function md(){const t=p.memory;return A(t)}URL=globalThis.URL;const V=await La({"./automerge_wasm_bg.js":{__wbindgen_string_get:Bc,__wbindgen_object_drop_ref:Vc,__wbindgen_error_new:$c,__wbindgen_object_clone_ref:zc,__wbindgen_string_new:Hc,__wbindgen_number_new:Kc,__wbindgen_number_get:qc,__wbindgen_is_undefined:Jc,__wbindgen_boolean_get:Wc,__wbindgen_is_null:Qc,__wbindgen_is_function:Yc,__wbindgen_is_string:Zc,__wbindgen_is_object:Xc,__wbindgen_is_array:Gc,__wbindgen_json_serialize:eu,__wbg_new_abda76e883ba8a5f:tu,__wbg_stack_658279fe44541cf6:nu,__wbg_error_f851667af71bcfc6:ru,__wbindgen_jsval_loose_eq:ou,__wbg_String_91fba7ded13ba54c:iu,__wbindgen_bigint_from_i64:au,__wbindgen_bigint_from_u64:su,__wbg_set_20cbc34131e76824:cu,__wbg_getRandomValues_504510b5564925af:uu,__wbg_randomFillSync_a0d98aa11c81fe89:du,__wbg_crypto_58f13aa23ffcb166:_u,__wbg_process_5b786e71d465a513:lu,__wbg_versions_c2ab80650590b6a2:fu,__wbg_node_523d7bd03ef69fba:hu,__wbg_msCrypto_abcb1295e768d1f2:gu,__wbg_require_2784e593a4674877:pu,__wbg_log_a4530b4fe289336f:bu,__wbg_log_00cf3417193182f2:yu,__wbg_get_f01601b5a68d10e3:mu,__wbg_length_1009b1af0c481d7b:wu,__wbg_new_ffc6d4d085022169:vu,__wbg_newnoargs_c62ea9419c21fbac:Su,__wbg_next_9b877f231f476d01:ku,__wbg_next_6529ee0cca8d57ed:xu,__wbg_done_5fe336b092d60cf2:Au,__wbg_value_0c248a78fdc8e19f:Eu,__wbg_iterator_db7ca081358d4fb2:Iu,__wbg_get_7b48513de5dc5ea4:Ou,__wbg_call_90c26b09837aba1c:Cu,__wbg_new_9fb8d994e1c0aaac:ju,__wbg_length_36658cb09b6ec34a:Ru,__wbg_set_f2740edb12e318cd:Tu,__wbg_from_71add2e723d1f1b2:Pu,__wbg_isArray_74fb723e24f76012:Mu,__wbg_push_901f3914205d44de:Uu,__wbg_unshift_5436cf2bdfb8635d:Du,__wbg_instanceof_ArrayBuffer_e7d53d51371448e2:Lu,__wbg_new_a64e3f2afc2cf2f8:Nu,__wbg_call_5da1969d7cd31ccd:Fu,__wbg_instanceof_Date_cfa5d171ed8093a1:Bu,__wbg_getTime_9272be78826033e1:Vu,__wbg_new_d77fabdc03b9edd6:$u,__wbg_instanceof_Object_702c4990f4c3db8d:zu,__wbg_assign_6fdd54658ed70520:Hu,__wbg_defineProperty_2982dad69ce66029:Ku,__wbg_entries_9e2e2aa45aa5094a:qu,__wbg_freeze_3cb3d8155bb1dc4d:Ju,__wbg_keys_fb74497f0cb41c2a:Wu,__wbg_values_ab825057174d69d1:Qu,__wbg_new_9fa4bec794556db1:Yu,__wbg_apply_4d8fcf4ddc362ff9:Zu,__wbg_deleteProperty_8c212ef4944e69d8:Xu,__wbg_ownKeys_7ac8657f7af0c859:Gu,__wbg_set_759f75cd92b612d2:ed,__wbg_buffer_a448f833075b71ba:td,__wbg_concat_48d0d62f514d0161:nd,__wbg_slice_be7863d04044cbc1:rd,__wbg_for_bcf4067191afa30f:od,__wbg_toString_b18b2b1e8378cebc:id,__wbg_self_f0e34d89f33b99fd:ad,__wbg_window_d3b084224f4774d7:sd,__wbg_globalThis_9caa27ff917c6860:cd,__wbg_global_35dfdd59a4da3e74:ud,__wbg_newwithbyteoffsetandlength_d0482f893617af71:dd,__wbg_new_8f67e318f15d7254:_d,__wbg_set_2357bf09366ee480:ld,__wbg_length_1d25fa9e4ac21ce7:fd,__wbg_instanceof_Uint8Array_bced6f43aed8c1aa:hd,__wbg_newwithlength_6c2df9e2f3028c43:gd,__wbg_subarray_2e940e41c0f5a1d9:pd,__wbindgen_debug_string:bd,__wbindgen_throw:yd,__wbindgen_memory:md}},Lg),ep=V.memory,tp=V.__wbg_syncstate_free,np=V.syncstate_sharedHeads,rp=V.syncstate_lastSentHeads,op=V.syncstate_set_lastSentHeads,ip=V.syncstate_set_sentHashes,ap=V.syncstate_clone,sp=V.__wbg_automerge_free,cp=V.automerge_new,up=V.automerge_clone,dp=V.automerge_fork,_p=V.automerge_pendingOps,lp=V.automerge_commit,fp=V.automerge_merge,hp=V.automerge_rollback,gp=V.automerge_keys,pp=V.automerge_text,bp=V.automerge_splice,yp=V.automerge_updateText,mp=V.automerge_push,wp=V.automerge_pushObject,vp=V.automerge_insert,Sp=V.automerge_insertObject,kp=V.automerge_put,xp=V.automerge_putObject,Ap=V.automerge_increment,Ep=V.automerge_get,Ip=V.automerge_getWithType,Op=V.automerge_getAll,Cp=V.automerge_enableFreeze,jp=V.automerge_registerDatatype,Rp=V.automerge_applyPatches,Tp=V.automerge_applyAndReturnPatches,Pp=V.automerge_diffIncremental,Mp=V.automerge_updateDiffCursor,Up=V.automerge_resetDiffCursor,Dp=V.automerge_diff,Lp=V.automerge_isolate,Np=V.automerge_integrate,Fp=V.automerge_length,Bp=V.automerge_delete,Vp=V.automerge_save,$p=V.automerge_saveIncremental,zp=V.automerge_saveSince,Hp=V.automerge_saveNoCompress,Kp=V.automerge_saveAndVerify,qp=V.automerge_loadIncremental,Jp=V.automerge_applyChanges,Wp=V.automerge_getChanges,Qp=V.automerge_getChangeByHash,Yp=V.automerge_getChangesAdded,Zp=V.automerge_getHeads,Xp=V.automerge_getActorId,Gp=V.automerge_getLastLocalChange,eb=V.automerge_dump,tb=V.automerge_getMissingDeps,nb=V.automerge_receiveSyncMessage,rb=V.automerge_generateSyncMessage,ob=V.automerge_toJS,ib=V.automerge_materialize,ab=V.automerge_getCursor,sb=V.automerge_getCursorPosition,cb=V.automerge_emptyChange,ub=V.automerge_mark,db=V.automerge_unmark,_b=V.automerge_marks,lb=V.automerge_marksAt,fb=V.create,hb=V.load,gb=V.encodeChange,pb=V.decodeChange,bb=V.initSyncState,yb=V.importSyncState,mb=V.exportSyncState,wb=V.encodeSyncMessage,vb=V.decodeSyncMessage,Sb=V.encodeSyncState,kb=V.decodeSyncState,xb=V.__wbindgen_malloc,Ab=V.__wbindgen_realloc,Eb=V.__wbindgen_add_to_stack_pointer,Ib=V.__wbindgen_free,Ob=V.__wbindgen_exn_store,Cb=Object.freeze(Object.defineProperty({__proto__:null,__wbg_automerge_free:sp,__wbg_syncstate_free:tp,__wbindgen_add_to_stack_pointer:Eb,__wbindgen_exn_store:Ob,__wbindgen_free:Ib,__wbindgen_malloc:xb,__wbindgen_realloc:Ab,automerge_applyAndReturnPatches:Tp,automerge_applyChanges:Jp,automerge_applyPatches:Rp,automerge_clone:up,automerge_commit:lp,automerge_delete:Bp,automerge_diff:Dp,automerge_diffIncremental:Pp,automerge_dump:eb,automerge_emptyChange:cb,automerge_enableFreeze:Cp,automerge_fork:dp,automerge_generateSyncMessage:rb,automerge_get:Ep,automerge_getActorId:Xp,automerge_getAll:Op,automerge_getChangeByHash:Qp,automerge_getChanges:Wp,automerge_getChangesAdded:Yp,automerge_getCursor:ab,automerge_getCursorPosition:sb,automerge_getHeads:Zp,automerge_getLastLocalChange:Gp,automerge_getMissingDeps:tb,automerge_getWithType:Ip,automerge_increment:Ap,automerge_insert:vp,automerge_insertObject:Sp,automerge_integrate:Np,automerge_isolate:Lp,automerge_keys:gp,automerge_length:Fp,automerge_loadIncremental:qp,automerge_mark:ub,automerge_marks:_b,automerge_marksAt:lb,automerge_materialize:ib,automerge_merge:fp,automerge_new:cp,automerge_pendingOps:_p,automerge_push:mp,automerge_pushObject:wp,automerge_put:kp,automerge_putObject:xp,automerge_receiveSyncMessage:nb,automerge_registerDatatype:jp,automerge_resetDiffCursor:Up,automerge_rollback:hp,automerge_save:Vp,automerge_saveAndVerify:Kp,automerge_saveIncremental:$p,automerge_saveNoCompress:Hp,automerge_saveSince:zp,automerge_splice:bp,automerge_text:pp,automerge_toJS:ob,automerge_unmark:db,automerge_updateDiffCursor:Mp,automerge_updateText:yp,create:fb,decodeChange:pb,decodeSyncMessage:vb,decodeSyncState:kb,encodeChange:gb,encodeSyncMessage:wb,encodeSyncState:Sb,exportSyncState:mb,importSyncState:yb,initSyncState:bb,load:hb,memory:ep,syncstate_clone:ap,syncstate_lastSentHeads:rp,syncstate_set_lastSentHeads:op,syncstate_set_sentHashes:ip,syncstate_sharedHeads:np},Symbol.toStringTag,{value:"Module"}));Dc(Cb);const jb=Object.freeze(Object.defineProperty({__proto__:null,Automerge:mt,SyncState:dt,TextRepresentation:Gg,__wbg_String_91fba7ded13ba54c:iu,__wbg_apply_4d8fcf4ddc362ff9:Zu,__wbg_assign_6fdd54658ed70520:Hu,__wbg_buffer_a448f833075b71ba:td,__wbg_call_5da1969d7cd31ccd:Fu,__wbg_call_90c26b09837aba1c:Cu,__wbg_concat_48d0d62f514d0161:nd,__wbg_crypto_58f13aa23ffcb166:_u,__wbg_defineProperty_2982dad69ce66029:Ku,__wbg_deleteProperty_8c212ef4944e69d8:Xu,__wbg_done_5fe336b092d60cf2:Au,__wbg_entries_9e2e2aa45aa5094a:qu,__wbg_error_f851667af71bcfc6:ru,__wbg_for_bcf4067191afa30f:od,__wbg_freeze_3cb3d8155bb1dc4d:Ju,__wbg_from_71add2e723d1f1b2:Pu,__wbg_getRandomValues_504510b5564925af:uu,__wbg_getTime_9272be78826033e1:Vu,__wbg_get_7b48513de5dc5ea4:Ou,__wbg_get_f01601b5a68d10e3:mu,__wbg_globalThis_9caa27ff917c6860:cd,__wbg_global_35dfdd59a4da3e74:ud,__wbg_instanceof_ArrayBuffer_e7d53d51371448e2:Lu,__wbg_instanceof_Date_cfa5d171ed8093a1:Bu,__wbg_instanceof_Object_702c4990f4c3db8d:zu,__wbg_instanceof_Uint8Array_bced6f43aed8c1aa:hd,__wbg_isArray_74fb723e24f76012:Mu,__wbg_iterator_db7ca081358d4fb2:Iu,__wbg_keys_fb74497f0cb41c2a:Wu,__wbg_length_1009b1af0c481d7b:wu,__wbg_length_1d25fa9e4ac21ce7:fd,__wbg_length_36658cb09b6ec34a:Ru,__wbg_log_00cf3417193182f2:yu,__wbg_log_a4530b4fe289336f:bu,__wbg_msCrypto_abcb1295e768d1f2:gu,__wbg_new_8f67e318f15d7254:_d,__wbg_new_9fa4bec794556db1:Yu,__wbg_new_9fb8d994e1c0aaac:ju,__wbg_new_a64e3f2afc2cf2f8:Nu,__wbg_new_abda76e883ba8a5f:tu,__wbg_new_d77fabdc03b9edd6:$u,__wbg_new_ffc6d4d085022169:vu,__wbg_newnoargs_c62ea9419c21fbac:Su,__wbg_newwithbyteoffsetandlength_d0482f893617af71:dd,__wbg_newwithlength_6c2df9e2f3028c43:gd,__wbg_next_6529ee0cca8d57ed:xu,__wbg_next_9b877f231f476d01:ku,__wbg_node_523d7bd03ef69fba:hu,__wbg_ownKeys_7ac8657f7af0c859:Gu,__wbg_process_5b786e71d465a513:lu,__wbg_push_901f3914205d44de:Uu,__wbg_randomFillSync_a0d98aa11c81fe89:du,__wbg_require_2784e593a4674877:pu,__wbg_self_f0e34d89f33b99fd:ad,__wbg_set_20cbc34131e76824:cu,__wbg_set_2357bf09366ee480:ld,__wbg_set_759f75cd92b612d2:ed,__wbg_set_f2740edb12e318cd:Tu,__wbg_set_wasm:Dc,__wbg_slice_be7863d04044cbc1:rd,__wbg_stack_658279fe44541cf6:nu,__wbg_subarray_2e940e41c0f5a1d9:pd,__wbg_toString_b18b2b1e8378cebc:id,__wbg_unshift_5436cf2bdfb8635d:Du,__wbg_value_0c248a78fdc8e19f:Eu,__wbg_values_ab825057174d69d1:Qu,__wbg_versions_c2ab80650590b6a2:fu,__wbg_window_d3b084224f4774d7:sd,__wbindgen_bigint_from_i64:au,__wbindgen_bigint_from_u64:su,__wbindgen_boolean_get:Wc,__wbindgen_debug_string:bd,__wbindgen_error_new:$c,__wbindgen_is_array:Gc,__wbindgen_is_function:Yc,__wbindgen_is_null:Qc,__wbindgen_is_object:Xc,__wbindgen_is_string:Zc,__wbindgen_is_undefined:Jc,__wbindgen_json_serialize:eu,__wbindgen_jsval_loose_eq:ou,__wbindgen_memory:md,__wbindgen_number_get:qc,__wbindgen_number_new:Kc,__wbindgen_object_clone_ref:zc,__wbindgen_object_drop_ref:Vc,__wbindgen_string_get:Bc,__wbindgen_string_new:Hc,__wbindgen_throw:yd,create:$g,decodeChange:Kg,decodeSyncMessage:Yg,decodeSyncState:Xg,encodeChange:Hg,encodeSyncMessage:Qg,encodeSyncState:Zg,exportSyncState:Wg,importSyncState:Jg,initSyncState:qg,load:zg},Symbol.toStringTag,{value:"Module"}));var Rb=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Tb(t){Ug(t)}Tb(jb);function pi(t){return typeof t=="object"?t:{actor:t}}function bi(t){const e=pi(t),n=!!e.freeze,r=e.patchCallback,o=!e.enableTextV2,i=e.actor,a=He.create({actor:i,text_v1:o});a.enableFreeze(!!e.freeze),a.registerDatatype("counter",c=>new _i(c));const s=e.enableTextV2||!1;return s?a.registerDatatype("str",c=>new li(c)):a.registerDatatype("text",c=>new Tt(c)),a.materialize("/",void 0,{handle:a,heads:void 0,freeze:n,patchCallback:r,textV2:s})}function Pb(t,e){const n=Ne(t),r=n.heads,o=pi(e),i=n.handle.fork(o.actor,r);i.updateDiffCursor();const a=Rb(n,["heads"]);return a.patchCallback=o.patchCallback,i.applyPatches(t,Object.assign(Object.assign({},a),{handle:i}))}function Mb(t,e){return nr(bi(e),"from",{},n=>Object.assign(n,t)).newDoc}function Ub(t,e,n){if(typeof e=="function")return nr(t,"change",{},e).newDoc;if(typeof n=="function")return typeof e=="string"&&(e={message:e}),nr(t,"change",e,n).newDoc;throw RangeError("Invalid args for change")}function Db(t,e,n,r){if(typeof n=="function")return nr(t,"changeAt",{},n,e);if(typeof r=="function")return typeof n=="string"&&(n={message:n}),nr(t,"changeAt",n,r,e);throw RangeError("Invalid args for changeAt")}function tr(t,e,n,r){if(n==null)return t;const o=Ne(t),i=Object.assign(Object.assign({},o),{heads:void 0}),{value:a,patches:s}=o.handle.applyAndReturnPatches(t,i);if(s.length>0){r==null||r(s,{before:t,after:a,source:e});const c=Ne(a);c.mostRecentPatch={before:Ne(t).heads,after:c.handle.getHeads(),patches:s,source:e}}return o.heads=n,a}function nr(t,e,n,r,o){if(typeof r!="function")throw new RangeError("invalid change function");const i=Ne(t);if(t===void 0||i===void 0)throw new RangeError("must be the document root");if(i.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ro(t))throw new RangeError("Calls to Automerge.change cannot be nested");let a=i.handle.getHeads();o&&Vb(o,a)&&(o=void 0),o&&(i.handle.isolate(o),a=o);try{i.heads=a;const s=Tg(i.handle,i.textV2);if(r(s),i.handle.pendingOps()===0)return i.heads=void 0,o&&i.handle.integrate(),{newDoc:t,newHeads:null};{const c=i.handle.commit(n.message,n.time);return i.handle.integrate(),{newDoc:tr(t,e,a,n.patchCallback||i.patchCallback),newHeads:c!=null?[c]:null}}}catch(s){throw i.heads=void 0,i.handle.rollback(),s}}function Lb(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e});const n=Ne(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ro(t))throw new RangeError("Calls to Automerge.change cannot be nested");const r=n.handle.getHeads();return n.handle.emptyChange(e.message,e.time),tr(t,"emptyChange",r)}function Nb(t,e){const n=pi(e),r=n.actor,o=n.patchCallback,i=!n.enableTextV2,a=n.unchecked||!1,s=n.allowMissingChanges||!1,c=n.convertRawStringsToText||!1,u=He.load(t,{text_v1:i,actor:r,unchecked:a,allowMissingDeps:s,convertRawStringsToText:c});u.enableFreeze(!!n.freeze),u.registerDatatype("counter",d=>new _i(d));const _=n.enableTextV2||!1;return _?u.registerDatatype("str",d=>new li(d)):u.registerDatatype("text",d=>new Tt(d)),u.materialize("/",void 0,{handle:u,heads:void 0,patchCallback:o,textV2:_})}function wd(t,e,n){n||(n={});const r=Ne(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Uc(t));if(ro(t))throw new RangeError("Calls to Automerge.change cannot be nested");const o=r.handle.getHeads();return r.handle.loadIncremental(e),tr(t,"loadIncremental",o,n.patchCallback||r.patchCallback)}function vd(t){return Ne(t).handle.save()}function Fb(t,e){const n=Ne(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Uc(t));const r=n.handle.getHeads(),o=Ne(e),i=n.handle.getChangesAdded(o.handle);return n.handle.applyChanges(i),tr(t,"merge",r,n.patchCallback)}function Bb(t,e,n){Sd(e,"before"),Sd(n,"after");const r=Ne(t);return r.mostRecentPatch&&yi(r.mostRecentPatch.before,e)&&yi(r.mostRecentPatch.after,n)?r.mostRecentPatch.patches:r.handle.diff(e,n)}function Vb(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Sd(t,e){if(!Array.isArray(t))throw new Error(`${e} must be an array`)}function yi(t,e){if(!Ad(t)||!Ad(e))return t===e;const n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o]!==r[o]||!yi(t[n[o]],e[r[o]]))return!1;return!0}function kd(t){const e=He.importSyncState(t),n=He.encodeSyncState(e);return e.free(),n}function xd(t){const e=He.decodeSyncState(t),n=He.exportSyncState(e);return e.free(),n}function $b(t,e){const n=Ne(t),r=He.importSyncState(e),o=n.handle.generateSyncMessage(r);return[He.exportSyncState(r),o]}function zb(t,e,n,r){const o=He.importSyncState(e);r||(r={});const i=Ne(t);if(i.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(ro(t))throw new RangeError("Calls to Automerge.change cannot be nested");const a=i.handle.getHeads();i.handle.receiveSyncMessage(o,n);const s=He.exportSyncState(o);return[tr(t,"receiveSyncMessage",a,r.patchCallback||i.patchCallback),s,null]}function Hb(){return He.exportSyncState(He.initSyncState())}function Kb(t){return He.decodeSyncMessage(t)}function wt(t){const e=Ne(t);return e.heads||e.handle.getHeads()}function Ad(t){return typeof t=="object"&&t!==null}function qb(t,e){return Ne(t).handle.saveSince(e)}function mi(t){const e=_o(t);return e.enableTextV2=!0,bi(e)}function Ed(t,e){const n=_o(e);return n.enableTextV2=!0,Pb(t,n)}function Jb(t,e){const n=_o(e);return n.enableTextV2=!0,Mb(t,n)}function Wb(t,e){const n=_o(e);return n.enableTextV2=!0,n.patchCallback?wd(bi(n),t):Nb(t,n)}function _o(t){return typeof t=="object"?t:{actor:t}}var Qb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vi={exports:{}},Si,Id;function Yb(){if(Id)return Si;Id=1;var t=1e3,e=t*60,n=e*60,r=n*24,o=r*7,i=r*365.25;Si=function(_,d){d=d||{};var l=typeof _;if(l==="string"&&_.length>0)return a(_);if(l==="number"&&isFinite(_))return d.long?c(_):s(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function a(_){if(_=String(_),!(_.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(d){var l=parseFloat(d[1]),f=(d[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return l*i;case"weeks":case"week":case"w":return l*o;case"days":case"day":case"d":return l*r;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*e;case"seconds":case"second":case"secs":case"sec":case"s":return l*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}function s(_){var d=Math.abs(_);return d>=r?Math.round(_/r)+"d":d>=n?Math.round(_/n)+"h":d>=e?Math.round(_/e)+"m":d>=t?Math.round(_/t)+"s":_+"ms"}function c(_){var d=Math.abs(_);return d>=r?u(_,d,r,"day"):d>=n?u(_,d,n,"hour"):d>=e?u(_,d,e,"minute"):d>=t?u(_,d,t,"second"):_+" ms"}function u(_,d,l,f){var m=d>=l*1.5;return Math.round(_/l)+" "+f+(m?"s":"")}return Si}function Zb(t){n.debug=n,n.default=n,n.coerce=c,n.disable=i,n.enable=o,n.enabled=a,n.humanize=Yb(),n.destroy=u,Object.keys(t).forEach(_=>{n[_]=t[_]}),n.names=[],n.skips=[],n.formatters={};function e(_){let d=0;for(let l=0;l<_.length;l++)d=(d<<5)-d+_.charCodeAt(l),d|=0;return n.colors[Math.abs(d)%n.colors.length]}n.selectColor=e;function n(_){let d,l=null,f,m;function y(...j){if(!y.enabled)return;const C=y,O=Number(new Date),E=O-(d||O);C.diff=E,C.prev=d,C.curr=O,d=O,j[0]=n.coerce(j[0]),typeof j[0]!="string"&&j.unshift("%O");let $=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(W,K)=>{if(W==="%%")return"%";$++;const Z=n.formatters[K];if(typeof Z=="function"){const I=j[$];W=Z.call(C,I),j.splice($,1),$--}return W}),n.formatArgs.call(C,j),(C.log||n.log).apply(C,j)}return y.namespace=_,y.useColors=n.useColors(),y.color=n.selectColor(_),y.extend=r,y.destroy=n.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(f!==n.namespaces&&(f=n.namespaces,m=n.enabled(_)),m),set:j=>{l=j}}),typeof n.init=="function"&&n.init(y),y}function r(_,d){const l=n(this.namespace+(typeof d>"u"?":":d)+_);return l.log=this.log,l}function o(_){n.save(_),n.namespaces=_,n.names=[],n.skips=[];let d;const l=(typeof _=="string"?_:"").split(/[\s,]+/),f=l.length;for(d=0;d<f;d++)l[d]&&(_=l[d].replace(/\*/g,".*?"),_[0]==="-"?n.skips.push(new RegExp("^"+_.slice(1)+"$")):n.names.push(new RegExp("^"+_+"$")))}function i(){const _=[...n.names.map(s),...n.skips.map(s).map(d=>"-"+d)].join(",");return n.enable(""),_}function a(_){if(_[_.length-1]==="*")return!0;let d,l;for(d=0,l=n.skips.length;d<l;d++)if(n.skips[d].test(_))return!1;for(d=0,l=n.names.length;d<l;d++)if(n.names[d].test(_))return!0;return!1}function s(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function c(_){return _ instanceof Error?_.stack||_.message:_}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Xb=Zb;(function(t,e){var n={};e.formatArgs=o,e.save=i,e.load=a,e.useColors=r,e.storage=s(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const _="color: "+this.color;u.splice(1,0,_,"color: inherit");let d=0,l=0;u[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(d++,f==="%c"&&(l=d))}),u.splice(l,0,_)}e.log=console.debug||console.log||(()=>{});function i(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function a(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=n.DEBUG),u}function s(){try{return localStorage}catch{}}t.exports=Xb(e);const{formatters:c}=t.exports;c.j=function(u){try{return JSON.stringify(u)}catch(_){return"[UnexpectedJSONParseError]: "+_.message}}})(vi,vi.exports);var Gb=vi.exports;const Mt=wi(Gb);var Od={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(c,u,_){this.fn=c,this.context=u,this.once=_||!1}function i(c,u,_,d,l){if(typeof _!="function")throw new TypeError("The listener must be a function");var f=new o(_,d||c,l),m=n?n+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],f]:c._events[m].push(f):(c._events[m]=f,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],u,_;if(this._eventsCount===0)return c;for(_ in u=this._events)e.call(u,_)&&c.push(n?_.slice(1):_);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},s.prototype.listeners=function(c){var u=n?n+c:c,_=this._events[u];if(!_)return[];if(_.fn)return[_.fn];for(var d=0,l=_.length,f=new Array(l);d<l;d++)f[d]=_[d].fn;return f},s.prototype.listenerCount=function(c){var u=n?n+c:c,_=this._events[u];return _?_.fn?1:_.length:0},s.prototype.emit=function(c,u,_,d,l,f){var m=n?n+c:c;if(!this._events[m])return!1;var y=this._events[m],j=arguments.length,C,O;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),j){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,_),!0;case 4:return y.fn.call(y.context,u,_,d),!0;case 5:return y.fn.call(y.context,u,_,d,l),!0;case 6:return y.fn.call(y.context,u,_,d,l,f),!0}for(O=1,C=new Array(j-1);O<j;O++)C[O-1]=arguments[O];y.fn.apply(y.context,C)}else{var E=y.length,$;for(O=0;O<E;O++)switch(y[O].once&&this.removeListener(c,y[O].fn,void 0,!0),j){case 1:y[O].fn.call(y[O].context);break;case 2:y[O].fn.call(y[O].context,u);break;case 3:y[O].fn.call(y[O].context,u,_);break;case 4:y[O].fn.call(y[O].context,u,_,d);break;default:if(!C)for($=1,C=new Array(j-1);$<j;$++)C[$-1]=arguments[$];y[O].fn.apply(y[O].context,C)}}return!0},s.prototype.on=function(c,u,_){return i(this,c,u,_,!1)},s.prototype.once=function(c,u,_){return i(this,c,u,_,!0)},s.prototype.removeListener=function(c,u,_,d){var l=n?n+c:c;if(!this._events[l])return this;if(!u)return a(this,l),this;var f=this._events[l];if(f.fn)f.fn===u&&(!d||f.once)&&(!_||f.context===_)&&a(this,l);else{for(var m=0,y=[],j=f.length;m<j;m++)(f[m].fn!==u||d&&!f[m].once||_&&f[m].context!==_)&&y.push(f[m]);y.length?this._events[l]=y.length===1?y[0]:y:a(this,l)}return this},s.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(Od);var ey=Od.exports;const yn=wi(ey);var H=function(){return H=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},H.apply(this,arguments)};function ki(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function se(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function de(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),o,i=[],a;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i}function be(t,e,n){if(n||arguments.length===2)for(var r=0,o=e.length,i;r<o;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var ge;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(ge||(ge={}));var mn;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(mn||(mn={}));var xi=ge.Start,Ai=ge.Stop,rr=ge.Raise,lo=ge.Send,Cd=ge.Cancel,ty=ge.NullEvent,Ei=ge.Assign;ge.After,ge.DoneState;var jd=ge.Log,ny=ge.Init,Ii=ge.Invoke;ge.ErrorExecution;var Rd=ge.ErrorPlatform,ry=ge.ErrorCustom,Td=ge.Update,oy=ge.Choose,iy=ge.Pure,Pd=".",Md={},Oi="xstate.guard",ay="",Ci;function ji(t,e,n){n===void 0&&(n=Pd);var r=or(t,n),o=or(e,n);return he(o)?he(r)?o===r:!1:he(r)?r in o:Object.keys(r).every(function(i){return i in o?ji(r[i],o[i]):!1})}function Ud(t){try{return he(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function Ri(t,e){try{return wn(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function sy(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function or(t,e){if(sy(t))return t.value;if(wn(t))return fo(t);if(typeof t!="string")return t;var n=Ri(t,e);return fo(n)}function fo(t){if(t.length===1)return t[0];for(var e={},n=e,r=0;r<t.length-1;r++)r===t.length-2?n[t[r]]=t[r+1]:(n[t[r]]={},n=n[t[r]]);return e}function ir(t,e){for(var n={},r=Object.keys(t),o=0;o<r.length;o++){var i=r[o];n[i]=e(t[i],i,t,o)}return n}function Dd(t,e,n){var r,o,i={};try{for(var a=se(Object.keys(t)),s=a.next();!s.done;s=a.next()){var c=s.value,u=t[c];n(u)&&(i[c]=e(u,c,t))}}catch(_){r={error:_}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}var cy=function(t){return function(e){var n,r,o=e;try{for(var i=se(t),a=i.next();!a.done;a=i.next()){var s=a.value;o=o[s]}}catch(c){n={error:c}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}};function uy(t,e){return function(n){var r,o,i=n;try{for(var a=se(t),s=a.next();!s.done;s=a.next()){var c=s.value;i=i[e][c]}}catch(u){r={error:u}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}}function ho(t){if(!t)return[[]];if(he(t))return[[t]];var e=ve(Object.keys(t).map(function(n){var r=t[n];return typeof r!="string"&&(!r||!Object.keys(r).length)?[[n]]:ho(t[n]).map(function(o){return[n].concat(o)})}));return e}function ve(t){var e;return(e=[]).concat.apply(e,be([],de(t),!1))}function Ld(t){return wn(t)?t:[t]}function _t(t){return t===void 0?[]:Ld(t)}function go(t,e,n){var r,o;if(fe(t))return t(e,n.data);var i={};try{for(var a=se(Object.keys(t)),s=a.next();!s.done;s=a.next()){var c=s.value,u=t[c];fe(u)?i[c]=u(e,n.data):i[c]=u}}catch(_){r={error:_}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i}function dy(t){return/^(done|error)\./.test(t)}function Nd(t){return!!(t instanceof Promise||t!==null&&(fe(t)||typeof t=="object")&&fe(t.then))}function _y(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function ly(t,e){var n,r,o=de([[],[]],2),i=o[0],a=o[1];try{for(var s=se(t),c=s.next();!c.done;c=s.next()){var u=c.value;e(u)?i.push(u):a.push(u)}}catch(_){n={error:_}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[i,a]}function Fd(t,e){return ir(t.states,function(n,r){if(n){var o=(he(e)?void 0:e[r])||(n?n.current:void 0);if(o)return{current:o,states:Fd(n,o)}}})}function fy(t,e){return{current:e,states:Fd(t,e)}}function Bd(t,e,n,r){var o=t&&n.reduce(function(i,a){var s,c,u=a.assignment,_={state:r,action:a,_event:e},d={};if(fe(u))d=u(i,e.data,_);else try{for(var l=se(Object.keys(u)),f=l.next();!f.done;f=l.next()){var m=f.value,y=u[m];d[m]=fe(y)?y(i,e.data,_):y}}catch(j){s={error:j}}finally{try{f&&!f.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}return Object.assign({},i,d)},t);return o}var hy=function(){};function wn(t){return Array.isArray(t)}function fe(t){return typeof t=="function"}function he(t){return typeof t=="string"}function Vd(t,e){if(t)return he(t)?{type:Oi,name:t,predicate:e?e[t]:void 0}:fe(t)?{type:Oi,name:t.name,predicate:t}:t}function gy(t){try{return"subscribe"in t&&fe(t.subscribe)}catch{return!1}}var Ft=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();Ci={},Ci[Ft]=function(){return this},Ci[Symbol.observable]=function(){return this};function vn(t){return!!t&&"__xstatenode"in t}function py(t){return!!t&&typeof t.send=="function"}function po(t,e){return he(t)||typeof t=="number"?H({type:t},e):t}function Me(t,e){if(!he(t)&&"$$type"in t&&t.$$type==="scxml")return t;var n=po(t);return H({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function Sn(t,e){var n=Ld(e).map(function(r){return typeof r>"u"||typeof r=="string"||vn(r)?{target:r,event:t}:H(H({},r),{event:t})});return n}function by(t){if(!(t===void 0||t===ay))return _t(t)}function $d(t,e,n,r,o){var i=t.options.guards,a={state:o,cond:e,_event:r};if(e.type===Oi)return((i==null?void 0:i[e.name])||e.predicate)(n,r.data,a);var s=i==null?void 0:i[e.type];if(!s)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return s(n,r.data,a)}function zd(t){return typeof t=="string"?{type:t}:t}function bo(t,e,n){var r=function(){},o=typeof t=="object",i=o?t:null;return{next:((o?t.next:t)||r).bind(i),error:((o?t.error:e)||r).bind(i),complete:((o?t.complete:n)||r).bind(i)}}function yo(t,e){return"".concat(t,":invocation[").concat(e,"]")}function Ti(t){return(t.type===rr||t.type===lo&&t.to===mn.Internal)&&typeof t.delay!="number"}var kn=Me({type:ny});function Pi(t,e){return e&&e[t]||void 0}function ar(t,e){var n;if(he(t)||typeof t=="number"){var r=Pi(t,e);fe(r)?n={type:t,exec:r}:r?n=r:n={type:t,exec:void 0}}else if(fe(t))n={type:t.name||t.toString(),exec:t};else{var r=Pi(t.type,e);if(fe(r))n=H(H({},t),{exec:r});else if(r){var o=r.type||t.type;n=H(H(H({},r),t),{type:o})}else n=t}return n}var Bt=function(t,e){if(!t)return[];var n=wn(t)?t:[t];return n.map(function(r){return ar(r,e)})};function Mi(t){var e=ar(t);return H(H({id:he(t)?t:e.id},e),{type:e.type})}function yy(t,e){return{type:rr,event:typeof t=="function"?t:po(t),delay:e?e.delay:void 0,id:e==null?void 0:e.id}}function my(t,e,n,r){var o={_event:n},i=Me(fe(t.event)?t.event(e,n.data,o):t.event),a;if(he(t.delay)){var s=r&&r[t.delay];a=fe(s)?s(e,n.data,o):s}else a=fe(t.delay)?t.delay(e,n.data,o):t.delay;return H(H({},t),{type:rr,_event:i,delay:a})}function wy(t,e){return{to:e?e.to:void 0,type:lo,event:fe(t)?t:po(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:fe(t)?t.name:Ud(t)}}function vy(t,e,n,r){var o={_event:n},i=Me(fe(t.event)?t.event(e,n.data,o):t.event),a;if(he(t.delay)){var s=r&&r[t.delay];a=fe(s)?s(e,n.data,o):s}else a=fe(t.delay)?t.delay(e,n.data,o):t.delay;var c=fe(t.to)?t.to(e,n.data,o):t.to;return H(H({},t),{to:c,_event:i,event:i.data,delay:a})}var Sy=function(t,e,n){return H(H({},t),{value:he(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})},ky=function(t){return{type:Cd,sendId:t}};function xy(t){var e=Mi(t);return{type:ge.Start,activity:e,exec:void 0}}function Ay(t){var e=fe(t)?t:Mi(t);return{type:ge.Stop,activity:e,exec:void 0}}function Ey(t,e,n){var r=fe(t.activity)?t.activity(e,n.data):t.activity,o=typeof r=="string"?{id:r}:r,i={type:ge.Stop,activity:o};return i}var Iy=function(t){return{type:Ei,assignment:t}};function Oy(t,e){var n=e?"#".concat(e):"";return"".concat(ge.After,"(").concat(t,")").concat(n)}function mo(t,e){var n="".concat(ge.DoneState,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function wo(t,e){var n="".concat(ge.DoneInvoke,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function sr(t,e){var n="".concat(ge.ErrorPlatform,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}var Cy=function(t){var e,n,r=[];try{for(var o=se(t),i=o.next();!i.done;i=o.next())for(var a=i.value,s=0;s<a.actions.length;){if(a.actions[s].type===Ei){r.push(a.actions[s]),a.actions.splice(s,1);continue}s++}}catch(c){e={error:c}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r};function vo(t,e,n,r,o,i,a){a===void 0&&(a=!1);var s=a?[]:Cy(o),c=s.length?Bd(n,r,s,e):n,u=a?[n]:void 0,_=[];function d(m,y){var j;switch(y.type){case rr:{var C=my(y,c,r,t.options.delays);return i&&typeof C.delay=="number"&&i(C,c,r),C}case lo:var O=vy(y,c,r,t.options.delays);return i&&O.to!==mn.Internal&&(m==="entry"?_.push(O):i(O,c,r)),O;case jd:{var E=Sy(y,c,r);return i==null||i(E,c,r),E}case oy:{var $=y,W=(j=$.conds.find(function(F){var T=Vd(F.cond,t.options.guards);return!T||$d(t,T,c,r,i?void 0:e)}))===null||j===void 0?void 0:j.actions;if(!W)return[];var K=de(vo(t,e,c,r,[{type:m,actions:Bt(_t(W),t.options.actions)}],i,a),2),Z=K[0],I=K[1];return c=I,u==null||u.push(c),Z}case iy:{var W=y.get(c,r.data);if(!W)return[];var D=de(vo(t,e,c,r,[{type:m,actions:Bt(_t(W),t.options.actions)}],i,a),2),Q=D[0],J=D[1];return c=J,u==null||u.push(c),Q}case Ai:{var E=Ey(y,c,r);return i==null||i(E,n,r),E}case Ei:{c=Bd(c,r,[y],i?void 0:e),u==null||u.push(c);break}default:var X=ar(y,t.options.actions),w=X.exec;if(i)i(X,c,r);else if(w&&u){var z=u.length-1,M=H(H({},X),{exec:function(F){for(var T=[],G=1;G<arguments.length;G++)T[G-1]=arguments[G];w.apply(void 0,be([u[z]],de(T),!1))}});X=M}return X}}function l(m){var y,j,C=[];try{for(var O=se(m.actions),E=O.next();!E.done;E=O.next()){var $=E.value,W=d(m.type,$);W&&(C=C.concat(W))}}catch(K){y={error:K}}finally{try{E&&!E.done&&(j=O.return)&&j.call(O)}finally{if(y)throw y.error}}return _.forEach(function(K){i(K,c,r)}),_.length=0,C}var f=ve(o.map(l));return[f,c]}var Hd=[],xn=function(t,e){Hd.push(t);var n=e(t);return Hd.pop(),n};function Kd(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[Ft]=function(){return this},e}function jy(t,e,n,r){var o,i=zd(t.src),a=(o=e==null?void 0:e.options.services)===null||o===void 0?void 0:o[i.type],s=t.data?go(t.data,n,r):void 0,c=a?qd(a,t.id,s):Kd(t.id);return c.meta=t,c}function qd(t,e,n){var r=Kd(e);if(r.deferred=!0,vn(t)){var o=r.state=xn(void 0,function(){return(n?t.withContext(n):t).initialState});r.getSnapshot=function(){return o}}return r}function Ry(t){try{return typeof t.send=="function"}catch{return!1}}function Ty(t){return Ry(t)&&"id"in t}function Py(t){var e;return H((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[Ft]=function(){return this},e),t)}var So=function(t){return t.type==="atomic"||t.type==="final"};function Jd(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function cr(t){return Jd(t).filter(function(e){return e.type!=="history"})}function Wd(t){var e=[t];return So(t)?e:e.concat(ve(cr(t).map(Wd)))}function ur(t,e){var n,r,o,i,a,s,c,u,_=new Set(t),d=Ui(_),l=new Set(e);try{for(var f=se(l),m=f.next();!m.done;m=f.next())for(var y=m.value,j=y.parent;j&&!l.has(j);)l.add(j),j=j.parent}catch(D){n={error:D}}finally{try{m&&!m.done&&(r=f.return)&&r.call(f)}finally{if(n)throw n.error}}var C=Ui(l);try{for(var O=se(l),E=O.next();!E.done;E=O.next()){var y=E.value;if(y.type==="compound"&&(!C.get(y)||!C.get(y).length))d.get(y)?d.get(y).forEach(function(Q){return l.add(Q)}):y.initialStateNodes.forEach(function(Q){return l.add(Q)});else if(y.type==="parallel")try{for(var $=(a=void 0,se(cr(y))),W=$.next();!W.done;W=$.next()){var K=W.value;l.has(K)||(l.add(K),d.get(K)?d.get(K).forEach(function(Q){return l.add(Q)}):K.initialStateNodes.forEach(function(Q){return l.add(Q)}))}}catch(Q){a={error:Q}}finally{try{W&&!W.done&&(s=$.return)&&s.call($)}finally{if(a)throw a.error}}}}catch(D){o={error:D}}finally{try{E&&!E.done&&(i=O.return)&&i.call(O)}finally{if(o)throw o.error}}try{for(var Z=se(l),I=Z.next();!I.done;I=Z.next())for(var y=I.value,j=y.parent;j&&!l.has(j);)l.add(j),j=j.parent}catch(D){c={error:D}}finally{try{I&&!I.done&&(u=Z.return)&&u.call(Z)}finally{if(c)throw c.error}}return l}function Qd(t,e){var n=e.get(t);if(!n)return{};if(t.type==="compound"){var r=n[0];if(r){if(So(r))return r.key}else return{}}var o={};return n.forEach(function(i){o[i.key]=Qd(i,e)}),o}function Ui(t){var e,n,r=new Map;try{for(var o=se(t),i=o.next();!i.done;i=o.next()){var a=i.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}function My(t,e){var n=ur([t],e);return Qd(t,Ui(n))}function dr(t,e){return Array.isArray(t)?t.some(function(n){return n===e}):t instanceof Set?t.has(e):!1}function Uy(t){return be([],de(new Set(ve(be([],de(t.map(function(e){return e.ownEvents})),!1)))),!1)}function ko(t,e){return e.type==="compound"?cr(e).some(function(n){return n.type==="final"&&dr(t,n)}):e.type==="parallel"?cr(e).every(function(n){return ko(t,n)}):!1}function Dy(t){return t===void 0&&(t=[]),t.reduce(function(e,n){return n.meta!==void 0&&(e[n.id]=n.meta),e},{})}function Yd(t){return new Set(ve(t.map(function(e){return e.tags})))}function Zd(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(he(t)||he(e))return t===e;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(function(o){return Zd(t[o],e[o])})}function Ly(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function Ny(t,e){var n=t.exec,r=H(H({},t),{exec:n!==void 0?function(){return n(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return r}var vt=function(){function t(e){var n=this,r;this.actions=[],this.activities=Md,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Md,this.meta=Dy(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&r!==void 0?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Uy(n.configuration)}})}return t.from=function(e,n){if(e instanceof t)return e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=kn;return new t({value:e,context:n,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var r=kn;return new t({value:e.value,context:n,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(e,n){var r=this;if(e===void 0&&(e=this.value),n===void 0&&(n="."),he(e))return[e];var o=Object.keys(e);return o.concat.apply(o,be([],de(o.map(function(i){return r.toStrings(e[i],n).map(function(a){return i+n+a})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var n=e.tags;e.machine;var r=ki(e,["configuration","transitions","tags","machine"]);return H(H({},r),{tags:Array.from(n)})},t.prototype.matches=function(e){return ji(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var n;hy(!!this.machine);var r=(n=this.machine)===null||n===void 0?void 0:n.getTransitionData(this,e);return!!(r!=null&&r.transitions.length)&&r.transitions.some(function(o){return o.target!==void 0||o.actions.length})},t}(),Fy={deferEvents:!1},Xd=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=H(H({},Fy),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(n){throw this.clear(),n}finally{this.processingEvent=!1}},t}(),Di=new Map,By=0,_r={bookId:function(){return"x:".concat(By++)},register:function(t,e){return Di.set(t,e),t},get:function(t){return Di.get(t)},free:function(t){Di.delete(t)}};function Li(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function Vy(){var t=Li();if(t&&"__xstate__"in t)return t.__xstate__}function $y(t){if(Li()){var e=Vy();e&&e.register(t)}}function zy(t,e){e===void 0&&(e={});var n=t.initialState,r=new Set,o=[],i=!1,a=function(){if(!i){for(i=!0;o.length>0;){var u=o.shift();n=t.transition(n,u,c),r.forEach(function(_){return _.next(n)})}i=!1}},s=Py({id:e.id,send:function(u){o.push(u),a()},getSnapshot:function(){return n},subscribe:function(u,_,d){var l=bo(u,_,d);return r.add(l),l.next(n),{unsubscribe:function(){r.delete(l)}}}}),c={parent:e.parent,self:s,id:e.id||"anonymous",observers:r};return n=t.start?t.start(c):n,s}var Hy={sync:!1,autoForward:!1},Ce;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(Ce||(Ce={}));var Ky=function(){function t(e,n){n===void 0&&(n=t.defaultOptions);var r=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Ce.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(_,d){if(wn(_))return r.batch(_),r.state;var l=Me(po(_,d));if(r.status===Ce.Stopped)return r.state;if(r.status!==Ce.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(l.name,'" was sent to uninitialized service "').concat(r.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(l.data)));return r.scheduler.schedule(function(){r.forward(l);var f=r._nextState(l);r.update(f,l)}),r._state},this.sendTo=function(_,d,l){var f=r.parent&&(d===mn.Parent||r.parent.id===d),m=f?r.parent:he(d)?d===mn.Internal?r:r.children.get(d)||_r.get(d):py(d)?d:void 0;if(!m){if(!f)throw new Error("Unable to send event to child '".concat(d,"' from service '").concat(r.id,"'."));return}if("machine"in m){if(r.status!==Ce.Stopped||r.parent!==m||r.state.done){var y=H(H({},_),{name:_.name===ry?"".concat(sr(r.id)):_.name,origin:r.sessionId});!l&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([m,y]):m.send(y)}}else!l&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([m,_.data]):m.send(_.data)},this._exec=function(_,d,l,f){f===void 0&&(f=r.machine.options.actions);var m=_.exec||Pi(_.type,f),y=fe(m)?m:m?m.exec:_.exec;if(y)try{return y(d,l.data,r.machine.config.predictableActionArguments?{action:_,_event:l}:{action:_,state:r.state,_event:l})}catch(z){throw r.parent&&r.parent.send({type:"xstate.error",data:z}),z}switch(_.type){case rr:{var j=_;r.defer(j);break}case lo:var C=_;if(typeof C.delay=="number"){r.defer(C);return}else C.to?r.sendTo(C._event,C.to,l===kn):r.send(C._event);break;case Cd:r.cancel(_.sendId);break;case xi:{if(r.status!==Ce.Running)return;var O=_.activity;if(!r.machine.config.predictableActionArguments&&!r.state.activities[O.id||O.type])break;if(O.type===ge.Invoke){var E=zd(O.src),$=r.machine.options.services?r.machine.options.services[E.type]:void 0,W=O.id,K=O.data,Z="autoForward"in O?O.autoForward:!!O.forward;if(!$)return;var I=K?go(K,d,l):void 0;if(typeof $=="string")return;var D=fe($)?$(d,l.data,{data:I,src:E,meta:O.meta}):$;if(!D)return;var Q=void 0;vn(D)&&(D=I?D.withContext(I):D,Q={autoForward:Z}),r.spawn(D,W,Q)}else r.spawnActivity(O);break}case Ai:{r.stopChild(_.activity.id);break}case jd:var J=_,X=J.label,w=J.value;X?r.logger(X,w):r.logger(w);break}};var o=H(H({},t.defaultOptions),n),i=o.clock,a=o.logger,s=o.parent,c=o.id,u=c!==void 0?c:e.id;this.id=u,this.logger=a,this.clock=i,this.parent=s,this.options=o,this.scheduler=new Xd({deferEvents:this.options.deferEvents}),this.sessionId=_r.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:xn(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,n){var r,o;try{for(var i=se(e.actions),a=i.next();!a.done;a=i.next()){var s=a.value;this.exec(s,e,n)}}catch(c){r={error:c}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},t.prototype.update=function(e,n){var r,o,i,a,s,c,u,_,d=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||n===kn)&&this.options.execute)this.execute(this.state);else for(var l=void 0;l=this._outgoingQueue.shift();)l[0].send(l[1]);if(this.children.forEach(function(D){d.state.children[D.id]=D}),this.devTools&&this.devTools.send(n.data,e),e.event)try{for(var f=se(this.eventListeners),m=f.next();!m.done;m=f.next()){var y=m.value;y(e.event)}}catch(D){r={error:D}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}try{for(var j=se(this.listeners),C=j.next();!C.done;C=j.next()){var y=C.value;y(e,e.event)}}catch(D){i={error:D}}finally{try{C&&!C.done&&(a=j.return)&&a.call(j)}finally{if(i)throw i.error}}try{for(var O=se(this.contextListeners),E=O.next();!E.done;E=O.next()){var $=E.value;$(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(D){s={error:D}}finally{try{E&&!E.done&&(c=O.return)&&c.call(O)}finally{if(s)throw s.error}}if(this.state.done){var W=e.configuration.find(function(D){return D.type==="final"&&D.parent===d.machine}),K=W&&W.doneData?go(W.doneData,e.context,n):void 0;this._doneEvent=wo(this.id,K);try{for(var Z=se(this.doneListeners),I=Z.next();!I.done;I=Z.next()){var y=I.value;y(this._doneEvent)}}catch(D){u={error:D}}finally{try{I&&!I.done&&(_=Z.return)&&_.call(Z)}finally{if(u)throw u.error}}this._stop(),this._stopChildren(),_r.free(this.sessionId)}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===Ce.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,n,r){var o=this,i=bo(e,n,r);this.listeners.add(i.next),this.status!==Ce.NotStarted&&i.next(this.state);var a=function(){o.doneListeners.delete(a),o.stopListeners.delete(a),i.complete()};return this.status===Ce.Stopped?i.complete():(this.onDone(a),this.onStop(a)),{unsubscribe:function(){o.listeners.delete(i.next),o.doneListeners.delete(a),o.stopListeners.delete(a)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.status===Ce.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var n=this;if(this.status===Ce.Running)return this;this.machine._init(),_r.register(this.sessionId,this),this.initialized=!0,this.status=Ce.Running;var r=e===void 0?this.initialState:xn(this,function(){return Ly(e)?n.machine.resolveState(e):n.machine.resolveState(vt.from(e,n.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){n.update(r,kn)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){fe(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,n,r,o,i,a,s,c,u,_;try{for(var d=se(this.listeners),l=d.next();!l.done;l=d.next()){var f=l.value;this.listeners.delete(f)}}catch(Z){e={error:Z}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(e)throw e.error}}try{for(var m=se(this.stopListeners),y=m.next();!y.done;y=m.next()){var f=y.value;f(),this.stopListeners.delete(f)}}catch(Z){r={error:Z}}finally{try{y&&!y.done&&(o=m.return)&&o.call(m)}finally{if(r)throw r.error}}try{for(var j=se(this.contextListeners),C=j.next();!C.done;C=j.next()){var f=C.value;this.contextListeners.delete(f)}}catch(Z){i={error:Z}}finally{try{C&&!C.done&&(a=j.return)&&a.call(j)}finally{if(i)throw i.error}}try{for(var O=se(this.doneListeners),E=O.next();!E.done;E=O.next()){var f=E.value;this.doneListeners.delete(f)}}catch(Z){s={error:Z}}finally{try{E&&!E.done&&(c=O.return)&&c.call(O)}finally{if(s)throw s.error}}if(!this.initialized)return this;this.initialized=!1,this.status=Ce.Stopped,this._initialState=void 0;try{for(var $=se(Object.keys(this.delayedEventsMap)),W=$.next();!W.done;W=$.next()){var K=W.value;this.clock.clearTimeout(this.delayedEventsMap[K])}}catch(Z){u={error:Z}}finally{try{W&&!W.done&&(_=$.return)&&_.call($)}finally{if(u)throw u.error}}this.scheduler.clear(),this.scheduler=new Xd({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,n=this.scheduler;return this._stop(),n.schedule(function(){var r;if(!(!((r=e._state)===null||r===void 0)&&r.done)){var o=Me({type:"xstate.stop"}),i=xn(e,function(){var a=ve(be([],de(e.state.configuration),!1).sort(function(d,l){return l.order-d.order}).map(function(d){return Bt(d.onExit,e.machine.options.actions)})),s=de(vo(e.machine,e.state,e.state.context,o,[{type:"exit",actions:a}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),c=s[0],u=s[1],_=new vt({value:e.state.value,context:u,_event:o,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:c.filter(function(d){return!Ti(d)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return _.changed=!0,_});e.update(i,o),e._stopChildren(),_r.free(e.sessionId)}}),this},t.prototype.batch=function(e){var n=this;if(!(this.status===Ce.NotStarted&&this.options.deferEvents)&&this.status!==Ce.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var r=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var o,i,a=n.state,s=!1,c=[],u=function(f){var m=Me(f);n.forward(m),a=xn(n,function(){return n.machine.transition(a,m,void 0,r||void 0)}),c.push.apply(c,be([],de(n.machine.config.predictableActionArguments?a.actions:a.actions.map(function(y){return Ny(y,a)})),!1)),s=s||!!a.changed};try{for(var _=se(e),d=_.next();!d.done;d=_.next()){var l=d.value;u(l)}}catch(f){o={error:f}}finally{try{d&&!d.done&&(i=_.return)&&i.call(_)}finally{if(o)throw o.error}}a.changed=s,a.actions=c,n.update(a,Me(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,n){var r=this;n===void 0&&(n=!!this.machine.config.predictableActionArguments&&this._exec);var o=Me(e);if(o.name.indexOf(Rd)===0&&!this.state.nextEvents.some(function(a){return a.indexOf(Rd)===0}))throw o.data.data;var i=xn(this,function(){return r.machine.transition(r.state,o,void 0,n||void 0)});return i},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var n,r;try{for(var o=se(this.forwardTo),i=o.next();!i.done;i=o.next()){var a=i.value,s=this.children.get(a);if(!s)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(a,"'."));s.send(e)}}catch(c){n={error:c}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.defer=function(e){var n=this,r=this.clock.setTimeout(function(){"to"in e&&e.to?n.sendTo(e._event,e.to,!0):n.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=r)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,n,r){r===void 0&&(r=this.machine.options.actions),this._exec(e,n.context,n._event,r)},t.prototype.removeChild=function(e){var n;this.children.delete(e),this.forwardTo.delete(e),(n=this.state)===null||n===void 0||delete n.children[e]},t.prototype.stopChild=function(e){var n=this.children.get(e);n&&(this.removeChild(e),fe(n.stop)&&n.stop())},t.prototype.spawn=function(e,n,r){if(this.status!==Ce.Running)return qd(e,n);if(Nd(e))return this.spawnPromise(Promise.resolve(e),n);if(fe(e))return this.spawnCallback(e,n);if(Ty(e))return this.spawnActor(e,n);if(gy(e))return this.spawnObservable(e,n);if(vn(e))return this.spawnMachine(e,H(H({},r),{id:n}));if(_y(e))return this.spawnBehavior(e,n);throw new Error('Unable to spawn entity "'.concat(n,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,n){var r=this;n===void 0&&(n={});var o=new t(e,H(H({},this.options),{parent:this,id:n.id||e.id})),i=H(H({},Hy),n);i.sync&&o.onTransition(function(s){r.send(Td,{state:s,id:o.id})});var a=o;return this.children.set(o.id,a),i.autoForward&&this.forwardTo.add(o.id),o.onDone(function(s){r.removeChild(o.id),r.send(Me(s,{origin:o.id}))}).start(),a},t.prototype.spawnBehavior=function(e,n){var r=zy(e,{id:n,parent:this});return this.children.set(n,r),r},t.prototype.spawnPromise=function(e,n){var r,o=this,i=!1,a;e.then(function(c){i||(a=c,o.removeChild(n),o.send(Me(wo(n,c),{origin:n})))},function(c){if(!i){o.removeChild(n);var u=sr(n,c);try{o.send(Me(u,{origin:n}))}catch{o.devTools&&o.devTools.send(u,o.state),o.machine.strict&&o.stop()}}});var s=(r={id:n,send:function(){},subscribe:function(c,u,_){var d=bo(c,u,_),l=!1;return e.then(function(f){l||(d.next(f),!l&&d.complete())},function(f){l||d.error(f)}),{unsubscribe:function(){return l=!0}}},stop:function(){i=!0},toJSON:function(){return{id:n}},getSnapshot:function(){return a}},r[Ft]=function(){return this},r);return this.children.set(n,s),s},t.prototype.spawnCallback=function(e,n){var r,o=this,i=!1,a=new Set,s=new Set,c,u=function(l){c=l,s.forEach(function(f){return f(l)}),!i&&o.send(Me(l,{origin:n}))},_;try{_=e(u,function(l){a.add(l)})}catch(l){this.send(sr(n,l))}if(Nd(_))return this.spawnPromise(_,n);var d=(r={id:n,send:function(l){return a.forEach(function(f){return f(l)})},subscribe:function(l){var f=bo(l);return s.add(f.next),{unsubscribe:function(){s.delete(f.next)}}},stop:function(){i=!0,fe(_)&&_()},toJSON:function(){return{id:n}},getSnapshot:function(){return c}},r[Ft]=function(){return this},r);return this.children.set(n,d),d},t.prototype.spawnObservable=function(e,n){var r,o=this,i,a=e.subscribe(function(c){i=c,o.send(Me(c,{origin:n}))},function(c){o.removeChild(n),o.send(Me(sr(n,c),{origin:n}))},function(){o.removeChild(n),o.send(Me(wo(n),{origin:n}))}),s=(r={id:n,send:function(){},subscribe:function(c,u,_){return e.subscribe(c,u,_)},stop:function(){return a.unsubscribe()},getSnapshot:function(){return i},toJSON:function(){return{id:n}}},r[Ft]=function(){return this},r);return this.children.set(n,s),s},t.prototype.spawnActor=function(e,n){return this.children.set(n,e),e},t.prototype.spawnActivity=function(e){var n=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(n){var r=n(this.state.context,e);this.spawnEffect(e.id,r)}},t.prototype.spawnEffect=function(e,n){var r;this.children.set(e,(r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:n||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},r[Ft]=function(){return this},r))},t.prototype.attachDev=function(){var e=Li();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var n=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(H(H({name:this.id,autoPause:!0,stateSanitizer:function(r){return{value:r.value,context:r.context,actions:r.actions}}},n),{features:H({jump:!1,skip:!1},n?n.features:void 0)}),this.machine),this.devTools.init(this.state)}$y(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[Ft]=function(){return this},t.prototype.getSnapshot=function(){return this.status===Ce.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,n){return setTimeout(e,n)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=Gd,t}();function Gd(t,e){var n=new Ky(t,e);return n}function qy(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function xo(t){return H(H({type:Ii},t),{toJSON:function(){t.onDone,t.onError;var e=ki(t,["onDone","onError"]);return H(H({},e),{type:Ii,src:qy(t.src)})}})}var Ao="",Ni="#",Fi="*",An={},En=function(t){return t[0]===Ni},Jy=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Wy=function(){function t(e,n,r,o){r===void 0&&(r="context"in e?e.context:void 0);var i=this,a;this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(Jy(),n),this.parent=o==null?void 0:o.parent,this.key=this.config.key||(o==null?void 0:o.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:Pd),this.id=this.config.id||be([this.machine.key],de(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(a=this.config.schema)!==null&&a!==void 0?a:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?ir(this.config.states,function(u,_){var d,l=new t(u,{},void 0,{parent:i,key:_});return Object.assign(i.idMap,H((d={},d[l.id]=l,d),l.idMap)),l}):An;var s=0;function c(u){var _,d;u.order=s++;try{for(var l=se(Jd(u)),f=l.next();!f.done;f=l.next()){var m=f.value;c(m)}}catch(y){_={error:y}}finally{try{f&&!f.done&&(d=l.return)&&d.call(l)}finally{if(_)throw _.error}}}c(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(u){var _=u.event;return _===Ao}):Ao in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=_t(this.config.entry||this.config.onEntry).map(function(u){return ar(u)}),this.onExit=_t(this.config.exit||this.config.onExit).map(function(u){return ar(u)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=_t(this.config.invoke).map(function(u,_){var d,l;if(vn(u)){var f=yo(i.id,_);return i.machine.options.services=H((d={},d[f]=u,d),i.machine.options.services),xo({src:f,id:f})}else if(he(u.src)){var f=u.id||yo(i.id,_);return xo(H(H({},u),{id:f,src:u.src}))}else if(vn(u.src)||fe(u.src)){var f=u.id||yo(i.id,_);return i.machine.options.services=H((l={},l[f]=u.src,l),i.machine.options.services),xo(H(H({id:f},u),{src:f}))}else{var m=u.src;return xo(H(H({id:yo(i.id,_)},u),{src:m}))}}),this.activities=_t(this.config.activities).concat(this.invoke).map(function(u){return Mi(u)}),this.transition=this.transition.bind(this),this.tags=_t(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Wd(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,n){var r=this.options,o=r.actions,i=r.activities,a=r.guards,s=r.services,c=r.delays;return new t(this.config,{actions:H(H({},o),e.actions),activities:H(H({},i),e.activities),guards:H(H({},a),e.guards),services:H(H({},s),e.services),delays:H(H({},c),e.delays)},n??this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return fe(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:ir(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(n,r){return n[r.eventType]=n[r.eventType]||[],n[r.eventType].push(r),n},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var n=e===Ao,r=this.transitions.filter(function(o){var i=o.eventType===e;return n?i:i||o.eventType===Fi});return this.__cache.candidates[e]=r,r},t.prototype.getDelayedTransitions=function(){var e=this,n=this.config.after;if(!n)return[];var r=function(i,a){var s=fe(i)?"".concat(e.id,":delay[").concat(a,"]"):i,c=Oy(s,e.id);return e.onEntry.push(wy(c,{delay:i})),e.onExit.push(ky(c)),c},o=wn(n)?n.map(function(i,a){var s=r(i.delay,a);return H(H({},i),{event:s})}):ve(Object.keys(n).map(function(i,a){var s=n[i],c=he(s)?{target:s}:s,u=isNaN(+i)?i:+i,_=r(u,a);return _t(c).map(function(d){return H(H({},d),{event:_,delay:u})})}));return o.map(function(i){var a=i.delay;return H(H({},e.formatTransition(i)),{delay:a})})},t.prototype.getStateNodes=function(e){var n,r=this;if(!e)return[];var o=e instanceof vt?e.value:or(e,this.delimiter);if(he(o)){var i=this.getStateNode(o).initial;return i!==void 0?this.getStateNodes((n={},n[o]=i,n)):[this,this.states[o]]}var a=Object.keys(o),s=[this];return s.push.apply(s,be([],de(ve(a.map(function(c){return r.getStateNode(c).getStateNodes(o[c])}))),!1)),s},t.prototype.handles=function(e){var n=Ud(e);return this.events.includes(n)},t.prototype.resolveState=function(e){var n=e instanceof vt?e:vt.create(e),r=Array.from(ur([],this.getStateNodes(n.value)));return new vt(H(H({},n),{value:this.resolve(n.value),configuration:r,done:ko(r,this),tags:Yd(r),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,n,r){var o=this.getStateNode(e),i=o.next(n,r);return!i||!i.transitions.length?this.next(n,r):i},t.prototype.transitionCompoundNode=function(e,n,r){var o=Object.keys(e),i=this.getStateNode(o[0]),a=i._transition(e[o[0]],n,r);return!a||!a.transitions.length?this.next(n,r):a},t.prototype.transitionParallelNode=function(e,n,r){var o,i,a={};try{for(var s=se(Object.keys(e)),c=s.next();!c.done;c=s.next()){var u=c.value,_=e[u];if(_){var d=this.getStateNode(u),l=d._transition(_,n,r);l&&(a[u]=l)}}}catch(C){o={error:C}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}var f=Object.keys(a).map(function(C){return a[C]}),m=ve(f.map(function(C){return C.transitions})),y=f.some(function(C){return C.transitions.length>0});if(!y)return this.next(n,r);var j=ve(Object.keys(a).map(function(C){return a[C].configuration}));return{transitions:m,exitSet:ve(f.map(function(C){return C.exitSet})),configuration:j,source:n,actions:ve(Object.keys(a).map(function(C){return a[C].actions}))}},t.prototype._transition=function(e,n,r){return he(e)?this.transitionLeafNode(e,n,r):Object.keys(e).length===1?this.transitionCompoundNode(e,n,r):this.transitionParallelNode(e,n,r)},t.prototype.getTransitionData=function(e,n){return this._transition(e.value,e,Me(n))},t.prototype.next=function(e,n){var r,o,i=this,a=n.name,s=[],c=[],u;try{for(var _=se(this.getCandidates(a)),d=_.next();!d.done;d=_.next()){var l=d.value,f=l.cond,m=l.in,y=e.context,j=m?he(m)&&En(m)?e.matches(or(this.getStateNodeById(m).path,this.delimiter)):ji(or(m,this.delimiter),cy(this.path.slice(0,-2))(e.value)):!0,C=!1;try{C=!f||$d(this.machine,f,y,n,e)}catch($){throw new Error("Unable to evaluate guard '".concat(f.name||f.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,`':
`).concat($.message))}if(C&&j){l.target!==void 0&&(c=l.target),s.push.apply(s,be([],de(l.actions),!1)),u=l;break}}}catch($){r={error:$}}finally{try{d&&!d.done&&(o=_.return)&&o.call(_)}finally{if(r)throw r.error}}if(u){if(!c.length)return{transitions:[u],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var O=ve(c.map(function($){return i.getRelativeStateNodes($,e.historyValue)})),E=!!u.internal;return{transitions:[u],exitSet:E?[]:ve(c.map(function($){return i.getPotentiallyReenteringNodes($)})),configuration:O,source:e,actions:s}}},t.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var n=[],r=this,o=e;r&&r!==o;)n.push(r),r=r.parent;return r!==o?[]:(n.push(o),n)},t.prototype.getActions=function(e,n,r,o,i,a,s){var c,u,_,d,l=this,f=a?ur([],this.getStateNodes(a.value)):[],m=new Set;try{for(var y=se(Array.from(e).sort(function(J,X){return J.order-X.order})),j=y.next();!j.done;j=y.next()){var C=j.value;(!dr(f,C)||dr(r.exitSet,C)||C.parent&&m.has(C.parent))&&m.add(C)}}catch(J){c={error:J}}finally{try{j&&!j.done&&(u=y.return)&&u.call(y)}finally{if(c)throw c.error}}try{for(var O=se(f),E=O.next();!E.done;E=O.next()){var C=E.value;(!dr(e,C)||dr(r.exitSet,C.parent))&&r.exitSet.push(C)}}catch(J){_={error:J}}finally{try{E&&!E.done&&(d=O.return)&&d.call(O)}finally{if(_)throw _.error}}r.exitSet.sort(function(J,X){return X.order-J.order});var $=Array.from(m).sort(function(J,X){return J.order-X.order}),W=new Set(r.exitSet),K=ve($.map(function(J){var X=[];if(J.type!=="final")return X;var w=J.parent;if(!w.parent)return X;X.push(mo(J.id,J.doneData),mo(w.id,J.doneData?go(J.doneData,o,i):void 0));var z=w.parent;return z.type==="parallel"&&cr(z).every(function(M){return ko(r.configuration,M)})&&X.push(mo(z.id)),X})),Z=$.map(function(J){var X=J.onEntry,w=J.activities.map(function(z){return xy(z)});return{type:"entry",actions:Bt(s?be(be([],de(X),!1),de(w),!1):be(be([],de(w),!1),de(X),!1),l.machine.options.actions)}}).concat({type:"state_done",actions:K.map(function(J){return yy(J)})}),I=Array.from(W).map(function(J){return{type:"exit",actions:Bt(be(be([],de(J.onExit),!1),de(J.activities.map(function(X){return Ay(X)})),!1),l.machine.options.actions)}}),D=I.concat({type:"transition",actions:Bt(r.actions,this.machine.options.actions)}).concat(Z);if(n){var Q=Bt(ve(be([],de(e),!1).sort(function(J,X){return X.order-J.order}).map(function(J){return J.onExit})),this.machine.options.actions).filter(function(J){return!Ti(J)});return D.concat({type:"stop",actions:Q})}return D},t.prototype.transition=function(e,n,r,o){e===void 0&&(e=this.initialState);var i=Me(n),a;if(e instanceof vt)a=r===void 0?e:this.resolveState(vt.from(e,r));else{var s=he(e)?this.resolve(fo(this.getResolvedPath(e))):this.resolve(e),c=r??this.machine.context;a=this.resolveState(vt.from(s,c))}if(this.strict&&!this.events.includes(i.name)&&!dy(i.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(i.name,"'"));var u=this._transition(a.value,a,i)||{transitions:[],configuration:[],exitSet:[],source:a,actions:[]},_=ur([],this.getStateNodes(a.value)),d=u.configuration.length?ur(_,u.configuration):_;return u.configuration=be([],de(d),!1),this.resolveTransition(u,a,a.context,o,i)},t.prototype.resolveRaisedTransition=function(e,n,r,o){var i,a=e.actions;return e=this.transition(e,n,void 0,o),e._event=r,e.event=r.data,(i=e.actions).unshift.apply(i,be([],de(a),!1)),e},t.prototype.resolveTransition=function(e,n,r,o,i){var a,s,c,u,_=this;i===void 0&&(i=kn);var d=e.configuration,l=!n||e.transitions.length>0,f=l?e.configuration:n?n.configuration:[],m=ko(f,this),y=l?My(this.machine,d):void 0,j=n?n.historyValue?n.historyValue:e.source?this.machine.historyValue(n.value):void 0:void 0,C=this.getActions(new Set(f),m,e,r,i,n,o),O=n?H({},n.activities):{};try{for(var E=se(C),$=E.next();!$.done;$=E.next()){var W=$.value;try{for(var K=(c=void 0,se(W.actions)),Z=K.next();!Z.done;Z=K.next()){var I=Z.value;I.type===xi?O[I.activity.id||I.activity.type]=I:I.type===Ai&&(O[I.activity.id||I.activity.type]=!1)}}catch(ht){c={error:ht}}finally{try{Z&&!Z.done&&(u=K.return)&&u.call(K)}finally{if(c)throw c.error}}}}catch(ht){a={error:ht}}finally{try{$&&!$.done&&(s=E.return)&&s.call(E)}finally{if(a)throw a.error}}var D=de(vo(this,n,r,i,C,o,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),Q=D[0],J=D[1],X=de(ly(Q,Ti),2),w=X[0],z=X[1],M=Q.filter(function(ht){var zn;return ht.type===xi&&((zn=ht.activity)===null||zn===void 0?void 0:zn.type)===Ii}),F=M.reduce(function(ht,zn){return ht[zn.activity.id]=jy(zn.activity,_.machine,J,i),ht},n?H({},n.children):{}),T=new vt({value:y||n.value,context:J,_event:i,_sessionid:n?n._sessionid:null,historyValue:y?j?fy(j,y):void 0:n?n.historyValue:void 0,history:!y||e.source?n:void 0,actions:y?z:[],activities:y?O:n?n.activities:{},events:[],configuration:f,transitions:e.transitions,children:F,done:m,tags:Yd(f),machine:this}),G=r!==J;T.changed=i.name===Td||G;var ee=T.history;ee&&delete ee.history;var oe=!m&&(this._transient||d.some(function(ht){return ht._transient}));if(!l&&(!oe||i.name===Ao))return T;var te=T;if(!m)for(oe&&(te=this.resolveRaisedTransition(te,{type:ty},i,o));w.length;){var ae=w.shift();te=this.resolveRaisedTransition(te,ae._event,i,o)}var Xo=te.changed||(ee?!!te.actions.length||G||typeof ee.value!=typeof te.value||!Zd(te.value,ee.value):void 0);return te.changed=Xo,te.history=ee,te},t.prototype.getStateNode=function(e){if(En(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var n=this.states[e];if(!n)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return n},t.prototype.getStateNodeById=function(e){var n=En(e)?e.slice(Ni.length):e;if(n===this.id)return this;var r=this.machine.idMap[n];if(!r)throw new Error("Child state node '#".concat(n,"' does not exist on machine '").concat(this.id,"'"));return r},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&En(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var n=Ri(e,this.delimiter).slice(),r=this;n.length;){var o=n.shift();if(!o.length)break;r=r.getStateNode(o)}return r},t.prototype.resolve=function(e){var n,r=this;if(!e)return this.initialStateValue||An;switch(this.type){case"parallel":return ir(this.initialStateValue,function(i,a){return i?r.getStateNode(a).resolve(e[a]||i):An});case"compound":if(he(e)){var o=this.getStateNode(e);return o.type==="parallel"||o.type==="compound"?(n={},n[e]=o.initialStateValue,n):e}return Object.keys(e).length?ir(e,function(i,a){return i?r.getStateNode(a).resolve(i):An}):this.initialStateValue||{};default:return e||An}},t.prototype.getResolvedPath=function(e){if(En(e)){var n=this.machine.idMap[e.slice(Ni.length)];if(!n)throw new Error("Unable to find state node '".concat(e,"'"));return n.path}return Ri(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var n;if(this.type==="parallel")n=Dd(this.states,function(r){return r.initialStateValue||An},function(r){return r.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));n=So(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else n={};return this.__cache.initialStateValue=n,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,n){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,n??this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var n=this.config;he(n.target)?e=En(n.target)?fo(this.machine.getStateNodeById(n.target).path.slice(this.path.length-1)):n.target:e=n.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,n,r){return r===void 0&&(r=!0),r?e.type==="history"?e.resolveHistory(n):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(So(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var n=ho(this.initialStateValue);return ve(n.map(function(r){return e.getFromRelativePath(r)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var n=de(e),r=n[0],o=n.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var i=this.getStateNode(r);if(i.type==="history")return i.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(o)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Dd(this.states,function(n,r){if(!e)return n.historyValue();var o=he(e)?void 0:e[r];return n.historyValue(o||n.initialStateValue)},function(n){return!n.history})}},t.prototype.resolveHistory=function(e){var n=this;if(this.type!=="history")return[this];var r=this.parent;if(!e){var o=this.target;return o?ve(ho(o).map(function(a){return r.getFromRelativePath(a)})):r.initialStateNodes}var i=uy(r.path,"states")(e).current;return he(i)?[r.getStateNode(i)]:ve(ho(i).map(function(a){return n.history==="deep"?r.getFromRelativePath(a):[r.states[a[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,n=ve(Object.keys(this.states).map(function(r){return e.states[r].stateIds}));return[this.id].concat(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,n,r,o;if(this.__cache.events)return this.__cache.events;var i=this.states,a=new Set(this.ownEvents);if(i)try{for(var s=se(Object.keys(i)),c=s.next();!c.done;c=s.next()){var u=c.value,_=i[u];if(_.states)try{for(var d=(r=void 0,se(_.events)),l=d.next();!l.done;l=d.next()){var f=l.value;a.add("".concat(f))}}catch(m){r={error:m}}finally{try{l&&!l.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}}}catch(m){e={error:m}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(a)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(n){return!(!n.target&&!n.actions.length&&n.internal)}).map(function(n){return n.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var n=this;if(e!==void 0)return e.map(function(r){if(!he(r))return r;var o=r[0]===n.delimiter;if(o&&!n.parent)return n.getStateNodeByPath(r.slice(1));var i=o?n.key+r:r;if(n.parent)try{var a=n.parent.getStateNodeByPath(i);return a}catch(s){throw new Error("Invalid transition definition for state node '".concat(n.id,`':
`).concat(s.message))}else return n.getStateNodeByPath(i)})},t.prototype.formatTransition=function(e){var n=this,r=by(e.target),o="internal"in e?e.internal:r?r.some(function(c){return he(c)&&c[0]===n.delimiter}):!0,i=this.machine.options.guards,a=this.resolveTarget(r),s=H(H({},e),{actions:Bt(_t(e.actions)),cond:Vd(e.cond,i),target:a,source:this,internal:o,eventType:e.event,toJSON:function(){return H(H({},s),{target:s.target?s.target.map(function(c){return"#".concat(c.id)}):void 0,source:"#".concat(n.id)})}});return s},t.prototype.formatTransitions=function(){var e,n,r=this,o;if(!this.config.on)o=[];else if(Array.isArray(this.config.on))o=this.config.on;else{var i=this.config.on,a=Fi,s=i[a],c=s===void 0?[]:s,u=ki(i,[typeof a=="symbol"?a:a+""]);o=ve(Object.keys(u).map(function(O){var E=Sn(O,u[O]);return E}).concat(Sn(Fi,c)))}var _=this.config.always?Sn("",this.config.always):[],d=this.config.onDone?Sn(String(mo(this.id)),this.config.onDone):[],l=ve(this.invoke.map(function(O){var E=[];return O.onDone&&E.push.apply(E,be([],de(Sn(String(wo(O.id)),O.onDone)),!1)),O.onError&&E.push.apply(E,be([],de(Sn(String(sr(O.id)),O.onError)),!1)),E})),f=this.after,m=ve(be(be(be(be([],de(d),!1),de(l),!1),de(o),!1),de(_),!1).map(function(O){return _t(O).map(function(E){return r.formatTransition(E)})}));try{for(var y=se(f),j=y.next();!j.done;j=y.next()){var C=j.value;m.push(C)}}catch(O){e={error:O}}finally{try{j&&!j.done&&(n=y.return)&&n.call(y)}finally{if(e)throw e.error}}return m},t}();function Qy(t,e){return new Wy(t,e)}var Bi=Iy,e_={},t_={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.__assign=function(){return t.__assign=Object.assign||function(i){for(var a,s=1,c=arguments.length;s<c;s++){a=arguments[s];for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&(i[u]=a[u])}return i},t.__assign.apply(this,arguments)};function e(i,a){var s={};for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&a.indexOf(c)<0&&(s[c]=i[c]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,c=Object.getOwnPropertySymbols(i);u<c.length;u++)a.indexOf(c[u])<0&&Object.prototype.propertyIsEnumerable.call(i,c[u])&&(s[c[u]]=i[c[u]]);return s}function n(i){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&i[a],c=0;if(s)return s.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&c>=i.length&&(i=void 0),{value:i&&i[c++],done:!i}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function r(i,a){var s=typeof Symbol=="function"&&i[Symbol.iterator];if(!s)return i;var c=s.call(i),u,_=[],d;try{for(;(a===void 0||a-- >0)&&!(u=c.next()).done;)_.push(u.value)}catch(l){d={error:l}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(d)throw d.error}}return _}function o(i,a,s){if(s||arguments.length===2)for(var c=0,u=a.length,_;c<u;c++)(_||!(c in a))&&(_||(_=Array.prototype.slice.call(a,0,c)),_[c]=a[c]);return i.concat(_||Array.prototype.slice.call(a))}t.__read=r,t.__rest=e,t.__spreadArray=o,t.__values=n})(t_),Object.defineProperty(e_,"__esModule",{value:!0});var n_=t_,Yy={timeout:1e4};function Zy(t,e,n){var r=n_.__assign(n_.__assign({},Yy),n);return new Promise(function(o,i){var a=!1,s=r.timeout===1/0?void 0:setTimeout(function(){u.unsubscribe(),i(new Error("Timeout of ".concat(r.timeout," ms exceeded")))},r.timeout),c=function(){clearTimeout(s),a=!0,u==null||u.unsubscribe()},u=t.subscribe({next:function(_){e(_)&&(c(),o(_))},error:function(_){c(),i(_)},complete:function(){c(),i(new Error("Actor terminated without satisfying predicate"))}});a&&u.unsubscribe()})}var Xy=e_.waitFor=Zy,In={},Eo={},Be={};Object.defineProperty(Be,"__esModule",{value:!0}),Be.output=Be.exists=Be.hash=Be.bytes=Be.bool=Be.number=void 0;function Io(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}Be.number=Io;function r_(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}Be.bool=r_;function Gy(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Vi(t,...e){if(!Gy(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}Be.bytes=Vi;function o_(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Io(t.outputLen),Io(t.blockLen)}Be.hash=o_;function i_(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}Be.exists=i_;function a_(t,e){Vi(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}Be.output=a_;const em={number:Io,bool:r_,bytes:Vi,hash:o_,exists:i_,output:a_};Be.default=em;var $i={},Oo={};Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.crypto=void 0,Oo.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomBytes=t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.checkOpts=t.Hash=t.concatBytes=t.toBytes=t.utf8ToBytes=t.asyncLoop=t.nextTick=t.hexToBytes=t.bytesToHex=t.isLE=t.rotr=t.createView=t.u32=t.u8=void 0;const e=Oo,n=I=>new Uint8Array(I.buffer,I.byteOffset,I.byteLength);t.u8=n;const r=I=>new Uint32Array(I.buffer,I.byteOffset,Math.floor(I.byteLength/4));t.u32=r;function o(I){return I instanceof Uint8Array||I!=null&&typeof I=="object"&&I.constructor.name==="Uint8Array"}const i=I=>new DataView(I.buffer,I.byteOffset,I.byteLength);t.createView=i;const a=(I,D)=>I<<32-D|I>>>D;if(t.rotr=a,t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!t.isLE)throw new Error("Non little-endian hardware is not supported");const s=Array.from({length:256},(I,D)=>D.toString(16).padStart(2,"0"));function c(I){if(!o(I))throw new Error("Uint8Array expected");let D="";for(let Q=0;Q<I.length;Q++)D+=s[I[Q]];return D}t.bytesToHex=c;const u={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function _(I){if(I>=u._0&&I<=u._9)return I-u._0;if(I>=u._A&&I<=u._F)return I-(u._A-10);if(I>=u._a&&I<=u._f)return I-(u._a-10)}function d(I){if(typeof I!="string")throw new Error("hex string expected, got "+typeof I);const D=I.length,Q=D/2;if(D%2)throw new Error("padded hex string expected, got unpadded hex of length "+D);const J=new Uint8Array(Q);for(let X=0,w=0;X<Q;X++,w+=2){const z=_(I.charCodeAt(w)),M=_(I.charCodeAt(w+1));if(z===void 0||M===void 0){const F=I[w]+I[w+1];throw new Error('hex string expected, got non-hex character "'+F+'" at index '+w)}J[X]=z*16+M}return J}t.hexToBytes=d;const l=async()=>{};t.nextTick=l;async function f(I,D,Q){let J=Date.now();for(let X=0;X<I;X++){Q(X);const w=Date.now()-J;w>=0&&w<D||(await(0,t.nextTick)(),J+=w)}}t.asyncLoop=f;function m(I){if(typeof I!="string")throw new Error(`utf8ToBytes expected string, got ${typeof I}`);return new Uint8Array(new TextEncoder().encode(I))}t.utf8ToBytes=m;function y(I){if(typeof I=="string"&&(I=m(I)),!o(I))throw new Error(`expected Uint8Array, got ${typeof I}`);return I}t.toBytes=y;function j(...I){let D=0;for(let J=0;J<I.length;J++){const X=I[J];if(!o(X))throw new Error("Uint8Array expected");D+=X.length}const Q=new Uint8Array(D);for(let J=0,X=0;J<I.length;J++){const w=I[J];Q.set(w,X),X+=w.length}return Q}t.concatBytes=j;class C{clone(){return this._cloneInto()}}t.Hash=C;const O={}.toString;function E(I,D){if(D!==void 0&&O.call(D)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(I,D)}t.checkOpts=E;function $(I){const D=J=>I().update(y(J)).digest(),Q=I();return D.outputLen=Q.outputLen,D.blockLen=Q.blockLen,D.create=()=>I(),D}t.wrapConstructor=$;function W(I){const D=(J,X)=>I(X).update(y(J)).digest(),Q=I({});return D.outputLen=Q.outputLen,D.blockLen=Q.blockLen,D.create=J=>I(J),D}t.wrapConstructorWithOpts=W;function K(I){const D=(J,X)=>I(X).update(y(J)).digest(),Q=I({});return D.outputLen=Q.outputLen,D.blockLen=Q.blockLen,D.create=J=>I(J),D}t.wrapXOFConstructorWithOpts=K;function Z(I=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(I));throw new Error("crypto.getRandomValues must be defined")}t.randomBytes=Z}($i),Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.SHA2=void 0;const zi=Be,lr=$i;function tm(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),a=Number(n>>o&i),s=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,a,r),t.setUint32(e+u,s,r)}class nm extends lr.Hash{constructor(e,n,r,o){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,lr.createView)(this.buffer)}update(e){(0,zi.exists)(this);const{view:n,buffer:r,blockLen:o}=this;e=(0,lr.toBytes)(e);const i=e.length;for(let a=0;a<i;){const s=Math.min(o-this.pos,i-a);if(s===o){const c=(0,lr.createView)(e);for(;o<=i-a;a+=o)this.process(c,a);continue}r.set(e.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,zi.exists)(this),(0,zi.output)(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:i}=this;let{pos:a}=this;n[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>o-a&&(this.process(r,0),a=0);for(let d=a;d<o;d++)n[d]=0;tm(r,o-8,BigInt(this.length*8),i),this.process(r,0);const s=(0,lr.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,_=this.get();if(u>_.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)s.setUint32(4*d,_[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:i,destroyed:a,pos:s}=this;return e.length=o,e.pos=s,e.finished=i,e.destroyed=a,o%n&&e.buffer.set(r),e}}Eo.SHA2=nm,Object.defineProperty(In,"__esModule",{value:!0}),In.sha224=In.sha256=void 0;const rm=Eo,ot=$i,om=(t,e,n)=>t&e^~t&n,im=(t,e,n)=>t&e^t&n^e&n,am=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Vt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$t=new Uint32Array(64);class s_ extends rm.SHA2{constructor(){super(64,32,8,!1),this.A=Vt[0]|0,this.B=Vt[1]|0,this.C=Vt[2]|0,this.D=Vt[3]|0,this.E=Vt[4]|0,this.F=Vt[5]|0,this.G=Vt[6]|0,this.H=Vt[7]|0}get(){const{A:e,B:n,C:r,D:o,E:i,F:a,G:s,H:c}=this;return[e,n,r,o,i,a,s,c]}set(e,n,r,o,i,a,s,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=i|0,this.F=a|0,this.G=s|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)$t[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const l=$t[d-15],f=$t[d-2],m=(0,ot.rotr)(l,7)^(0,ot.rotr)(l,18)^l>>>3,y=(0,ot.rotr)(f,17)^(0,ot.rotr)(f,19)^f>>>10;$t[d]=y+$t[d-7]+m+$t[d-16]|0}let{A:r,B:o,C:i,D:a,E:s,F:c,G:u,H:_}=this;for(let d=0;d<64;d++){const l=(0,ot.rotr)(s,6)^(0,ot.rotr)(s,11)^(0,ot.rotr)(s,25),f=_+l+om(s,c,u)+am[d]+$t[d]|0,m=((0,ot.rotr)(r,2)^(0,ot.rotr)(r,13)^(0,ot.rotr)(r,22))+im(r,o,i)|0;_=u,u=c,c=s,s=a+f|0,a=i,i=o,o=r,r=f+m|0}r=r+this.A|0,o=o+this.B|0,i=i+this.C|0,a=a+this.D|0,s=s+this.E|0,c=c+this.F|0,u=u+this.G|0,_=_+this.H|0,this.set(r,o,i,a,s,c,u,_)}roundClean(){$t.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class sm extends s_{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}In.sha256=(0,ot.wrapConstructor)(()=>new s_),In.sha224=(0,ot.wrapConstructor)(()=>new sm);function cm(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var r=0;r<t.length;r++){var o=t.charAt(r),i=o.charCodeAt(0);if(e[i]!==255)throw new TypeError(o+" is ambiguous");e[i]=r}var a=t.length,s=t.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function _(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var m=0,y=0,j=0,C=f.length;j!==C&&f[j]===0;)j++,m++;for(var O=(C-j)*u+1>>>0,E=new Uint8Array(O);j!==C;){for(var $=f[j],W=0,K=O-1;($!==0||W<y)&&K!==-1;K--,W++)$+=256*E[K]>>>0,E[K]=$%a>>>0,$=$/a>>>0;if($!==0)throw new Error("Non-zero carry");y=W,j++}for(var Z=O-y;Z!==O&&E[Z]===0;)Z++;for(var I=s.repeat(m);Z<O;++Z)I+=t.charAt(E[Z]);return I}function d(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;for(var m=0,y=0,j=0;f[m]===s;)y++,m++;for(var C=(f.length-m)*c+1>>>0,O=new Uint8Array(C);f[m];){var E=e[f.charCodeAt(m)];if(E===255)return;for(var $=0,W=C-1;(E!==0||$<j)&&W!==-1;W--,$++)E+=a*O[W]>>>0,O[W]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");j=$,m++}for(var K=C-j;K!==C&&O[K]===0;)K++;for(var Z=new Uint8Array(y+(C-K)),I=y;K!==C;)Z[I++]=O[K++];return Z}function l(f){var m=d(f);if(m)return m;throw new Error("Non-base"+a+" character")}return{encode:_,decodeUnsafe:d,decode:l}}var um=cm,dm=um("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Hi=dm,_m=function(t){function e(i){var a=Uint8Array.from(i),s=t(a),c=a.length+4,u=new Uint8Array(c);return u.set(a,0),u.set(s.subarray(0,4),a.length),Hi.encode(u,c)}function n(i){var a=i.slice(0,-4),s=i.slice(-4),c=t(a);if(!(s[0]^c[0]|s[1]^c[1]|s[2]^c[2]|s[3]^c[3]))return a}function r(i){var a=Hi.decodeUnsafe(i);if(a)return n(a)}function o(i){var a=Hi.decode(i),s=n(a);if(!s)throw new Error("Invalid checksum");return s}return{encode:e,decode:o,decodeUnsafe:r}},{sha256:c_}=In,lm=_m;function fm(t){return c_(c_(t))}var hm=lm(fm);const u_=wi(hm),Ki="automerge:",qi=t=>{const e=new RegExp(`^${Ki}(\\w+)$`),[,n]=t.match(e)||[],r=n,o=l_(r);if(!o)throw new Error("Invalid document URL: "+t);return{binaryDocumentId:o,documentId:r}},Ji=t=>{const e=t instanceof Uint8Array||typeof t=="string"?t:"documentId"in t?t.documentId:void 0,n=e instanceof Uint8Array?Wi(e):typeof e=="string"?e:void 0;if(n===void 0)throw new Error("Invalid documentId: "+e);return Ki+n},d_=t=>{if(!t||!t.startsWith(Ki))return!1;const e=t;try{const{documentId:n}=qi(e);return __(n)}catch{return!1}},__=t=>{const e=l_(t);if(e===void 0)return!1;const n=rl(e);return cn(n)},gm=t=>cn(t),pm=()=>{const t=Ra(null,new Uint8Array(16));return Ji({documentId:t})},l_=t=>u_.decodeUnsafe(t),Wi=t=>u_.encode(t),Qi=t=>{if(t instanceof Uint8Array)return Wi(t);if(d_(t))return qi(t).documentId;if(__(t))return t;if(gm(t)){console.warn("Future versions will not support UUIDs as document IDs; use Automerge URLs instead.");const e=ol(t);return Wi(e)}throw new Error(`Invalid AutomergeUrl: '${t}'`)};let Yi;try{Yi=new TextDecoder}catch{}let Y,Yt,R=0;const bm=105,ym=57342,mm=57343,f_=57337,h_=6,On={};let ie={},ke,Co,jo=0,fr=0,Ee,lt,Ae=[],Zi=[],Ke,Ve,hr,g_={useRecords:!1,mapsAsObjects:!0},gr=!1,p_=2;try{new Function("")}catch{p_=1/0}class pr{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,o]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,o);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,o]of Object.entries(this._keyMap))this._mapKey.set(o,r)}let n={};return e.forEach((r,o)=>n[it(this._mapKey.has(o)?this._mapKey.get(o):o)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(o=>this.decodeKeys(o))}return r}decode(e,n){if(Y)return S_(()=>(na(),this?this.decode(e,n):pr.prototype.decode.call(g_,e,n)));Yt=n>-1?n:e.length,R=0,fr=0,Co=null,Ee=null,Y=e;try{Ve=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw Y=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof pr){if(ie=this,Ke=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return ke=this.structures,Ro();(!ke||ke.length>0)&&(ke=[])}else ie=g_,(!ke||ke.length>0)&&(ke=[]),Ke=null;return Ro()}decodeMultiple(e,n){let r,o=0;try{let i=e.length;gr=!0;let a=this?this.decode(e,i):oa.decode(e,i);if(n){if(n(a)===!1)return;for(;R<i;)if(o=R,n(Ro())===!1)return}else{for(r=[a];R<i;)o=R,r.push(Ro());return r}}catch(i){throw i.lastPosition=o,i.values=r,i}finally{gr=!1,na()}}}function Ro(){try{let t=ce();if(Ee){if(R>=Ee.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}R=Ee.postBundlePosition,Ee=null}if(R==Yt)ke=null,Y=null,lt&&(lt=null);else if(R>Yt){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!gr)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw na(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function ce(){let t=Y[R++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=Y[R++];break;case 25:if(e==7)return km();t=Ve.getUint16(R),R+=2;break;case 26:if(e==7){let n=Ve.getFloat32(R);if(ie.useFloat32>2){let r=ra[(Y[R]&127)<<1|Y[R+1]>>7];return R+=4,(r*n+(n>0?.5:-.5)>>0)/r}return R+=4,n}t=Ve.getUint32(R),R+=4;break;case 27:if(e==7){let n=Ve.getFloat64(R);return R+=8,n}if(e>1){if(Ve.getUint32(R)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=Ve.getUint32(R+4)}else ie.int64AsNumber?(t=Ve.getUint32(R)*4294967296,t+=Ve.getUint32(R+4)):t=Ve.getBigUint64(R);R+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,o=0;for(;(r=ce())!=On;)n[o++]=r;return e==4?n:e==3?n.join(""):Buffer.concat(n);case 5:let i;if(ie.mapsAsObjects){let a={};if(ie.keyMap)for(;(i=ce())!=On;)a[it(ie.decodeKey(i))]=ce();else for(;(i=ce())!=On;)a[it(i)]=ce();return a}else{hr&&(ie.mapsAsObjects=!0,hr=!1);let a=new Map;if(ie.keyMap)for(;(i=ce())!=On;)a.set(ie.decodeKey(i),ce());else for(;(i=ce())!=On;)a.set(i,ce());return a}case 7:return On;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return Sm(t);case 3:if(fr>=R)return Co.slice(R-jo,(R+=t)-jo);if(fr==0&&Yt<140&&t<32){let o=t<16?y_(t):vm(t);if(o!=null)return o}return wm(t);case 4:let n=new Array(t);for(let o=0;o<t;o++)n[o]=ce();return n;case 5:if(ie.mapsAsObjects){let o={};if(ie.keyMap)for(let i=0;i<t;i++)o[it(ie.decodeKey(ce()))]=ce();else for(let i=0;i<t;i++)o[it(ce())]=ce();return o}else{hr&&(ie.mapsAsObjects=!0,hr=!1);let o=new Map;if(ie.keyMap)for(let i=0;i<t;i++)o.set(ie.decodeKey(ce()),ce());else for(let i=0;i<t;i++)o.set(ce(),ce());return o}case 6:if(t>=f_){let o=ke[t&8191];if(o)return o.read||(o.read=Xi(o)),o.read();if(t<65536){if(t==mm){let i=jn(),a=ce(),s=ce();ea(a,s);let c={};if(ie.keyMap)for(let u=2;u<i;u++){let _=ie.decodeKey(s[u-2]);c[it(_)]=ce()}else for(let u=2;u<i;u++){let _=s[u-2];c[it(_)]=ce()}return c}else if(t==ym){let i=jn(),a=ce();for(let s=2;s<i;s++)ea(a++,ce());return ce()}else if(t==f_)return Cm();if(ie.getShared&&(ta(),o=ke[t&8191],o))return o.read||(o.read=Xi(o)),o.read()}}let r=Ae[t];if(r)return r.handlesRead?r(ce):r(ce());{let o=ce();for(let i=0;i<Zi.length;i++){let a=Zi[i](t,o);if(a!==void 0)return a}return new Zt(o,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let o=(Ke||Xt())[t];if(o!==void 0)return o;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let o=new Error("Unexpected end of CBOR data");throw o.incomplete=!0,o}throw new Error("Unknown CBOR token "+t)}}const b_=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Xi(t){function e(){let n=Y[R++];if(n=n&31,n>23)switch(n){case 24:n=Y[R++];break;case 25:n=Ve.getUint16(R),R+=2;break;case 26:n=Ve.getUint32(R),R+=4;break;default:throw new Error("Expected array header, but got "+Y[R-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(ce);r=r.next}if(this.slowReads++>=p_){let i=this.length==n?this:this.slice(0,n);return r=ie.keyMap?new Function("r","return {"+i.map(a=>ie.decodeKey(a)).map(a=>b_.test(a)?it(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"):new Function("r","return {"+i.map(a=>b_.test(a)?it(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(ce)}let o={};if(ie.keyMap)for(let i=0;i<n;i++)o[it(ie.decodeKey(this[i]))]=ce();else for(let i=0;i<n;i++)o[it(this[i])]=ce();return o}return t.slowReads=0,e}function it(t){if(typeof t=="string")return t==="__proto__"?"__proto_":t;if(typeof t!="object")return t.toString();throw new Error("Invalid property name type "+typeof t)}let wm=Gi;function Gi(t){let e;if(t<16&&(e=y_(t)))return e;if(t>64&&Yi)return Yi.decode(Y.subarray(R,R+=t));const n=R+t,r=[];for(e="";R<n;){const o=Y[R++];if(!(o&128))r.push(o);else if((o&224)===192){const i=Y[R++]&63;r.push((o&31)<<6|i)}else if((o&240)===224){const i=Y[R++]&63,a=Y[R++]&63;r.push((o&31)<<12|i<<6|a)}else if((o&248)===240){const i=Y[R++]&63,a=Y[R++]&63,s=Y[R++]&63;let c=(o&7)<<18|i<<12|a<<6|s;c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|c&1023),r.push(c)}else r.push(o);r.length>=4096&&(e+=je.apply(String,r),r.length=0)}return r.length>0&&(e+=je.apply(String,r)),e}let je=String.fromCharCode;function vm(t){let e=R,n=new Array(t);for(let r=0;r<t;r++){const o=Y[R++];if((o&128)>0){R=e;return}n[r]=o}return je.apply(String,n)}function y_(t){if(t<4)if(t<2){if(t===0)return"";{let e=Y[R++];if((e&128)>1){R-=1;return}return je(e)}}else{let e=Y[R++],n=Y[R++];if((e&128)>0||(n&128)>0){R-=2;return}if(t<3)return je(e,n);let r=Y[R++];if((r&128)>0){R-=3;return}return je(e,n,r)}else{let e=Y[R++],n=Y[R++],r=Y[R++],o=Y[R++];if((e&128)>0||(n&128)>0||(r&128)>0||(o&128)>0){R-=4;return}if(t<6){if(t===4)return je(e,n,r,o);{let i=Y[R++];if((i&128)>0){R-=5;return}return je(e,n,r,o,i)}}else if(t<8){let i=Y[R++],a=Y[R++];if((i&128)>0||(a&128)>0){R-=6;return}if(t<7)return je(e,n,r,o,i,a);let s=Y[R++];if((s&128)>0){R-=7;return}return je(e,n,r,o,i,a,s)}else{let i=Y[R++],a=Y[R++],s=Y[R++],c=Y[R++];if((i&128)>0||(a&128)>0||(s&128)>0||(c&128)>0){R-=8;return}if(t<10){if(t===8)return je(e,n,r,o,i,a,s,c);{let u=Y[R++];if((u&128)>0){R-=9;return}return je(e,n,r,o,i,a,s,c,u)}}else if(t<12){let u=Y[R++],_=Y[R++];if((u&128)>0||(_&128)>0){R-=10;return}if(t<11)return je(e,n,r,o,i,a,s,c,u,_);let d=Y[R++];if((d&128)>0){R-=11;return}return je(e,n,r,o,i,a,s,c,u,_,d)}else{let u=Y[R++],_=Y[R++],d=Y[R++],l=Y[R++];if((u&128)>0||(_&128)>0||(d&128)>0||(l&128)>0){R-=12;return}if(t<14){if(t===12)return je(e,n,r,o,i,a,s,c,u,_,d,l);{let f=Y[R++];if((f&128)>0){R-=13;return}return je(e,n,r,o,i,a,s,c,u,_,d,l,f)}}else{let f=Y[R++],m=Y[R++];if((f&128)>0||(m&128)>0){R-=14;return}if(t<15)return je(e,n,r,o,i,a,s,c,u,_,d,l,f,m);let y=Y[R++];if((y&128)>0){R-=15;return}return je(e,n,r,o,i,a,s,c,u,_,d,l,f,m,y)}}}}}function Sm(t){return ie.copyBuffers?Uint8Array.prototype.slice.call(Y,R,R+=t):Y.subarray(R,R+=t)}let m_=new Float32Array(1),To=new Uint8Array(m_.buffer,0,4);function km(){let t=Y[R++],e=Y[R++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return To[3]=t&128|(n>>1)+56,To[2]=(t&7)<<5|e>>3,To[1]=e<<5,To[0]=0,m_[0]}new Array(4096);class Zt{constructor(e,n){this.value=e,this.tag=n}}Ae[0]=t=>new Date(t),Ae[1]=t=>new Date(Math.round(t*1e3)),Ae[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+e<<BigInt(8);return e},Ae[3]=t=>BigInt(-1)-Ae[2](t),Ae[4]=t=>+(t[1]+"e"+t[0]),Ae[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const ea=(t,e)=>{t=t-57344;let n=ke[t];n&&n.isShared&&((ke.restoreStructures||(ke.restoreStructures=[]))[t]=n),ke[t]=e,e.read=Xi(e)};Ae[bm]=t=>{let e=t.length,n=t[1];ea(t[0],n);let r={};for(let o=2;o<e;o++){let i=n[o-2];r[it(i)]=t[o]}return r},Ae[14]=t=>Ee?Ee[0].slice(Ee.position0,Ee.position0+=t):new Zt(t,14),Ae[15]=t=>Ee?Ee[1].slice(Ee.position1,Ee.position1+=t):new Zt(t,15);let xm={Error,RegExp};Ae[27]=t=>(xm[t[0]]||Error)(t[1],t[2]);const w_=t=>{if(Y[R++]!=132){let n=new Error("Packed values structure must be followed by a 4 element array");throw Y.length<R&&(n.incomplete=!0),n}let e=t();if(!e||!e.length){let n=new Error("Packed values structure must be followed by a 4 element array");throw n.incomplete=!0,n}return Ke=Ke?e.concat(Ke.slice(e.length)):e,Ke.prefixes=t(),Ke.suffixes=t(),t()};w_.handlesRead=!0,Ae[51]=w_,Ae[h_]=t=>{if(!Ke)if(ie.getShared)ta();else return new Zt(t,h_);if(typeof t=="number")return Ke[16+(t>=0?2*t:-2*t-1)];let e=new Error("No support for non-integer packed references yet");throw t===void 0&&(e.incomplete=!0),e},Ae[28]=t=>{lt||(lt=new Map,lt.id=0);let e=lt.id++,n=Y[R],r;n>>5==4?r=[]:r={};let o={target:r};lt.set(e,o);let i=t();return o.used?Object.assign(r,i):(o.target=i,i)},Ae[28].handlesRead=!0,Ae[29]=t=>{let e=lt.get(t);return e.used=!0,e.target},Ae[258]=t=>new Set(t),(Ae[259]=t=>(ie.mapsAsObjects&&(ie.mapsAsObjects=!1,hr=!0),t())).handlesRead=!0;function Cn(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function Xt(){if(!Ke)if(ie.getShared)ta();else throw new Error("No packed values available");return Ke}const Am=1399353956;Zi.push((t,e)=>{if(t>=225&&t<=255)return Cn(Xt().prefixes[t-224],e);if(t>=28704&&t<=32767)return Cn(Xt().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return Cn(Xt().prefixes[t-1879048192],e);if(t>=216&&t<=223)return Cn(e,Xt().suffixes[t-216]);if(t>=27647&&t<=28671)return Cn(e,Xt().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return Cn(e,Xt().suffixes[t-1811939328]);if(t==Am)return{packedValues:Ke,structures:ke.slice(0),version:e};if(t==55799)return e});const Em=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,v_=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],Im=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<v_.length;t++)Om(v_[t],Im[t]);function Om(t,e){let n="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let o=0;o<2;o++){if(!o&&r==1)continue;let i=r==2?1:r==4?2:3;Ae[o?e:e-4]=r==1||o==Em?a=>{if(!t)throw new Error("Could not find typed array for code "+e);return!ie.copyBuffers&&(r===1||r===2&&!(a.byteOffset&1)||r===4&&!(a.byteOffset&3)||r===8&&!(a.byteOffset&7))?new t(a.buffer,a.byteOffset,a.byteLength):new t(Uint8Array.prototype.slice.call(a,0).buffer)}:a=>{if(!t)throw new Error("Could not find typed array for code "+e);let s=new DataView(a.buffer,a.byteOffset,a.byteLength),c=a.length>>i,u=new t(c),_=s[n];for(let d=0;d<c;d++)u[d]=_.call(s,d<<i,o);return u}}}function Cm(){let t=jn(),e=R+ce();for(let r=2;r<t;r++){let o=jn();R+=o}let n=R;return R=e,Ee=[Gi(jn()),Gi(jn())],Ee.position0=0,Ee.position1=0,Ee.postBundlePosition=R,R=n,ce()}function jn(){let t=Y[R++]&31;if(t>23)switch(t){case 24:t=Y[R++];break;case 25:t=Ve.getUint16(R),R+=2;break;case 26:t=Ve.getUint32(R),R+=4;break}return t}function ta(){if(ie.getShared){let t=S_(()=>(Y=null,ie.getShared()))||{},e=t.structures||[];ie.sharedVersion=t.version,Ke=ie.sharedValues=t.packedValues,ke===!0?ie.structures=ke=e:ke.splice.apply(ke,[0,e.length].concat(e))}}function S_(t){let e=Yt,n=R,r=jo,o=fr,i=Co,a=lt,s=Ee,c=new Uint8Array(Y.slice(0,Yt)),u=ke,_=ie,d=gr,l=t();return Yt=e,R=n,jo=r,fr=o,Co=i,lt=a,Ee=s,Y=c,gr=d,ke=u,ie=_,Ve=new DataView(Y.buffer,Y.byteOffset,Y.byteLength),l}function na(){Y=null,lt=null,ke=null}const ra=new Array(147);for(let t=0;t<256;t++)ra[t]=+("1e"+Math.floor(45.15-t*.30103));let oa=new pr({useRecords:!1});const k_=oa.decode;oa.decodeMultiple;let Po;try{Po=new TextEncoder}catch{}let ia,x_;const Mo=typeof globalThis=="object"&&globalThis.Buffer,br=typeof Mo<"u",aa=br?Mo.allocUnsafeSlow:Uint8Array,A_=br?Mo:Uint8Array,E_=256,I_=br?4294967296:2144337920;let sa,k,ye,b=0,zt,Ie=null;const jm=61440,Rm=/[\u0080-\uFFFF]/,Ye=Symbol("record-id");class O_ extends pr{constructor(e){super(e),this.offset=0;let n,r,o,i,a;e=e||{};let s=A_.prototype.utf8Write?function(w,z,M){return k.utf8Write(w,z,M)}:Po&&Po.encodeInto?function(w,z){return Po.encodeInto(w,k.subarray(z)).written}:!1,c=this,u=e.structures||e.saveStructures,_=e.maxSharedStructures;if(_==null&&(_=u?128:0),_>8190)throw new Error("Maximum maxSharedStructure is 8190");let d=e.sequential;d&&(_=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let l,f,m=e.sharedValues,y;if(m){y=Object.create(null);for(let w=0,z=m.length;w<z;w++)y[m[w]]=w}let j=[],C=0,O=0;this.mapEncode=function(w,z){if(this._keyMap&&!this._mapped)switch(w.constructor.name){case"Array":w=w.map(M=>this.encodeKeys(M));break}return this.encode(w,z)},this.encode=function(w,z){if(k||(k=new aa(8192),ye=new DataView(k.buffer,0,8192),b=0),zt=k.length-10,zt-b<2048?(k=new aa(k.length),ye=new DataView(k.buffer,0,k.length),zt=k.length-10,b=0):z===P_&&(b=b+7&2147483640),n=b,c.useSelfDescribedHeader&&(ye.setUint32(b,3654940416),b+=3),a=c.structuredClone?new Map:null,c.bundleStrings&&typeof w!="string"?(Ie=[],Ie.size=1/0):Ie=null,r=c.structures,r){if(r.uninitialized){let F=c.getShared()||{};c.structures=r=F.structures||[],c.sharedVersion=F.version;let T=c.sharedValues=F.packedValues;if(T){y={};for(let G=0,ee=T.length;G<ee;G++)y[T[G]]=G}}let M=r.length;if(M>_&&!d&&(M=_),!r.transitions){r.transitions=Object.create(null);for(let F=0;F<M;F++){let T=r[F];if(!T)continue;let G,ee=r.transitions;for(let oe=0,te=T.length;oe<te;oe++){ee[Ye]===void 0&&(ee[Ye]=F);let ae=T[oe];G=ee[ae],G||(G=ee[ae]=Object.create(null)),ee=G}ee[Ye]=F|1048576}}d||(r.nextId=M)}if(o&&(o=!1),i=r||[],f=y,e.pack){let M=new Map;if(M.values=[],M.encoder=c,M.maxValues=e.maxPrivatePackedValues||(y?16:1/0),M.objectMap=y||!1,M.samplingPackedValues=l,Uo(w,M),M.values.length>0){k[b++]=216,k[b++]=51,St(4);let F=M.values;E(F),St(0),St(0),f=Object.create(y||null);for(let T=0,G=F.length;T<G;T++)f[F[T]]=T}}sa=z&da;try{if(sa)return;if(E(w),Ie&&T_(n,E),c.offset=b,a&&a.idsToInsert){b+=a.idsToInsert.length*2,b>zt&&W(b),c.offset=b;let M=Mm(k.subarray(n,b),a.idsToInsert);return a=null,M}return z&P_?(k.start=n,k.end=b,k):k.subarray(n,b)}finally{if(r){if(O<10&&O++,r.length>_&&(r.length=_),C>1e4)r.transitions=null,O=0,C=0,j.length>0&&(j=[]);else if(j.length>0&&!d){for(let M=0,F=j.length;M<F;M++)j[M][Ye]=void 0;j=[]}}if(o&&c.saveShared){c.structures.length>_&&(c.structures=c.structures.slice(0,_));let M=k.subarray(n,b);return c.updateSharedData()===!1?c.encode(w):M}z&Um&&(b=n)}},this.findCommonStringsToPack=()=>(l=new Map,y||(y=Object.create(null)),w=>{let z=w&&w.threshold||4,M=this.pack?w.maxPrivatePackedValues||16:0;m||(m=this.sharedValues=[]);for(let[F,T]of l)T.count>z&&(y[F]=M++,m.push(F),o=!0);for(;this.saveShared&&this.updateSharedData()===!1;);l=null});const E=w=>{b>zt&&(k=W(b));var z=typeof w,M;if(z==="string"){if(f){let ee=f[w];if(ee>=0){ee<16?k[b++]=ee+224:(k[b++]=198,ee&1?E(15-ee>>1):E(ee-16>>1));return}else if(l&&!e.pack){let oe=l.get(w);oe?oe.count++:l.set(w,{count:1})}}let F=w.length;if(Ie&&F>=4&&F<1024){if((Ie.size+=F)>jm){let oe,te=(Ie[0]?Ie[0].length*3+Ie[1].length:0)+10;b+te>zt&&(k=W(b+te)),k[b++]=217,k[b++]=223,k[b++]=249,k[b++]=Ie.position?132:130,k[b++]=26,oe=b-n,b+=4,Ie.position&&T_(n,E),Ie=["",""],Ie.size=0,Ie.position=oe}let ee=Rm.test(w);Ie[ee?0:1]+=w,k[b++]=ee?206:207,E(F);return}let T;F<32?T=1:F<256?T=2:F<65536?T=3:T=5;let G=F*3;if(b+G>zt&&(k=W(b+G)),F<64||!s){let ee,oe,te,ae=b+T;for(ee=0;ee<F;ee++)oe=w.charCodeAt(ee),oe<128?k[ae++]=oe:oe<2048?(k[ae++]=oe>>6|192,k[ae++]=oe&63|128):(oe&64512)===55296&&((te=w.charCodeAt(ee+1))&64512)===56320?(oe=65536+((oe&1023)<<10)+(te&1023),ee++,k[ae++]=oe>>18|240,k[ae++]=oe>>12&63|128,k[ae++]=oe>>6&63|128,k[ae++]=oe&63|128):(k[ae++]=oe>>12|224,k[ae++]=oe>>6&63|128,k[ae++]=oe&63|128);M=ae-b-T}else M=s(w,b+T,G);M<24?k[b++]=96|M:M<256?(T<2&&k.copyWithin(b+2,b+1,b+1+M),k[b++]=120,k[b++]=M):M<65536?(T<3&&k.copyWithin(b+3,b+2,b+2+M),k[b++]=121,k[b++]=M>>8,k[b++]=M&255):(T<5&&k.copyWithin(b+5,b+3,b+3+M),k[b++]=122,ye.setUint32(b,M),b+=4),b+=M}else if(z==="number")if(!this.alwaysUseFloat&&w>>>0===w)w<24?k[b++]=w:w<256?(k[b++]=24,k[b++]=w):w<65536?(k[b++]=25,k[b++]=w>>8,k[b++]=w&255):(k[b++]=26,ye.setUint32(b,w),b+=4);else if(!this.alwaysUseFloat&&w>>0===w)w>=-24?k[b++]=31-w:w>=-256?(k[b++]=56,k[b++]=~w):w>=-65536?(k[b++]=57,ye.setUint16(b,~w),b+=2):(k[b++]=58,ye.setUint32(b,~w),b+=4);else{let F;if((F=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){k[b++]=250,ye.setFloat32(b,w);let T;if(F<4||(T=w*ra[(k[b]&127)<<1|k[b+1]>>7])>>0===T){b+=4;return}else b--}k[b++]=251,ye.setFloat64(b,w),b+=8}else if(z==="object")if(!w)k[b++]=246;else{if(a){let T=a.get(w);if(T){if(k[b++]=216,k[b++]=29,k[b++]=25,!T.references){let G=a.idsToInsert||(a.idsToInsert=[]);T.references=[],G.push(T)}T.references.push(b-n),b+=2;return}else a.set(w,{offset:b-n})}let F=w.constructor;if(F===Object)$(w,!0);else if(F===Array){M=w.length,M<24?k[b++]=128|M:St(M);for(let T=0;T<M;T++)E(w[T])}else if(F===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(k[b++]=217,k[b++]=1,k[b++]=3),M=w.size,M<24?k[b++]=160|M:M<256?(k[b++]=184,k[b++]=M):M<65536?(k[b++]=185,k[b++]=M>>8,k[b++]=M&255):(k[b++]=186,ye.setUint32(b,M),b+=4),c.keyMap)for(let[T,G]of w)E(c.encodeKey(T)),E(G);else for(let[T,G]of w)E(T),E(G);else{for(let T=0,G=ia.length;T<G;T++){let ee=x_[T];if(w instanceof ee){let oe=ia[T],te=oe.tag;te==null&&(te=oe.getTag&&oe.getTag.call(this,w)),te<24?k[b++]=192|te:te<256?(k[b++]=216,k[b++]=te):te<65536?(k[b++]=217,k[b++]=te>>8,k[b++]=te&255):te>-1&&(k[b++]=218,ye.setUint32(b,te),b+=4),oe.encode.call(this,w,E,W);return}}if(w[Symbol.iterator]){if(sa){let T=new Error("Iterable should be serialized as iterator");throw T.iteratorNotHandled=!0,T}k[b++]=159;for(let T of w)E(T);k[b++]=255;return}if(w[Symbol.asyncIterator]||ca(w)){let T=new Error("Iterable/blob should be serialized as iterator");throw T.iteratorNotHandled=!0,T}if(this.useToJSON&&w.toJSON){const T=w.toJSON();if(T!==w)return E(T)}$(w,!w.hasOwnProperty)}}else if(z==="boolean")k[b++]=w?245:244;else if(z==="bigint"){if(w<BigInt(1)<<BigInt(64)&&w>=0)k[b++]=27,ye.setBigUint64(b,w);else if(w>-(BigInt(1)<<BigInt(64))&&w<0)k[b++]=59,ye.setBigUint64(b,-w-BigInt(1));else if(this.largeBigIntToFloat)k[b++]=251,ye.setFloat64(b,Number(w));else throw new RangeError(w+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");b+=8}else if(z==="undefined")k[b++]=247;else throw new Error("Unknown type: "+z)},$=this.useRecords===!1?this.variableMapSize?w=>{let z=Object.keys(w),M=Object.values(w),F=z.length;if(F<24?k[b++]=160|F:F<256?(k[b++]=184,k[b++]=F):F<65536?(k[b++]=185,k[b++]=F>>8,k[b++]=F&255):(k[b++]=186,ye.setUint32(b,F),b+=4),c.keyMap)for(let T=0;T<F;T++)E(c.encodeKey(z[T])),E(M[T]);else for(let T=0;T<F;T++)E(z[T]),E(M[T])}:(w,z)=>{k[b++]=185;let M=b-n;b+=2;let F=0;if(c.keyMap)for(let T in w)(z||w.hasOwnProperty(T))&&(E(c.encodeKey(T)),E(w[T]),F++);else for(let T in w)(z||w.hasOwnProperty(T))&&(E(T),E(w[T]),F++);k[M+++n]=F>>8,k[M+n]=F&255}:(w,z)=>{let M,F=i.transitions||(i.transitions=Object.create(null)),T=0,G=0,ee,oe;if(this.keyMap){oe=Object.keys(w).map(ae=>this.encodeKey(ae)),G=oe.length;for(let ae=0;ae<G;ae++){let Xo=oe[ae];M=F[Xo],M||(M=F[Xo]=Object.create(null),T++),F=M}}else for(let ae in w)(z||w.hasOwnProperty(ae))&&(M=F[ae],M||(F[Ye]&1048576&&(ee=F[Ye]&65535),M=F[ae]=Object.create(null),T++),F=M,G++);let te=F[Ye];if(te!==void 0)te&=65535,k[b++]=217,k[b++]=te>>8|224,k[b++]=te&255;else if(oe||(oe=F.__keys__||(F.__keys__=Object.keys(w))),ee===void 0?(te=i.nextId++,te||(te=0,i.nextId=1),te>=E_&&(i.nextId=(te=_)+1)):te=ee,i[te]=oe,te<_){k[b++]=217,k[b++]=te>>8|224,k[b++]=te&255,F=i.transitions;for(let ae=0;ae<G;ae++)(F[Ye]===void 0||F[Ye]&1048576)&&(F[Ye]=te),F=F[oe[ae]];F[Ye]=te|1048576,o=!0}else{if(F[Ye]=te,ye.setUint32(b,3655335680),b+=3,T&&(C+=O*T),j.length>=E_-_&&(j.shift()[Ye]=void 0),j.push(F),St(G+2),E(57344+te),E(oe),z===null)return;for(let ae in w)(z||w.hasOwnProperty(ae))&&E(w[ae]);return}if(G<24?k[b++]=128|G:St(G),z!==null)for(let ae in w)(z||w.hasOwnProperty(ae))&&E(w[ae])},W=w=>{let z;if(w>16777216){if(w-n>I_)throw new Error("Encoded buffer would be larger than maximum buffer size");z=Math.min(I_,Math.round(Math.max((w-n)*(w>67108864?1.25:2),4194304)/4096)*4096)}else z=(Math.max(w-n<<2,k.length-1)>>12)+1<<12;let M=new aa(z);return ye=new DataView(M.buffer,0,z),k.copy?k.copy(M,0,n,w):M.set(k.slice(n,w)),b-=n,n=0,zt=M.length-10,k=M};let K=100,Z=1e3;this.encodeAsIterable=function(w,z){return J(w,z,I)},this.encodeAsAsyncIterable=function(w,z){return J(w,z,X)};function*I(w,z,M){let F=w.constructor;if(F===Object){let T=c.useRecords!==!1;T?$(w,null):C_(Object.keys(w).length,160);for(let G in w){let ee=w[G];T||E(G),ee&&typeof ee=="object"?z[G]?yield*I(ee,z[G]):yield*D(ee,z,G):E(ee)}}else if(F===Array){let T=w.length;St(T);for(let G=0;G<T;G++){let ee=w[G];ee&&(typeof ee=="object"||b-n>K)?z.element?yield*I(ee,z.element):yield*D(ee,z,"element"):E(ee)}}else if(w[Symbol.iterator]){k[b++]=159;for(let T of w)T&&(typeof T=="object"||b-n>K)?z.element?yield*I(T,z.element):yield*D(T,z,"element"):E(T);k[b++]=255}else ca(w)?(C_(w.size,64),yield k.subarray(n,b),yield w,Q()):w[Symbol.asyncIterator]?(k[b++]=159,yield k.subarray(n,b),yield w,Q(),k[b++]=255):E(w);M&&b>n?yield k.subarray(n,b):b-n>K&&(yield k.subarray(n,b),Q())}function*D(w,z,M){let F=b-n;try{E(w),b-n>K&&(yield k.subarray(n,b),Q())}catch(T){if(T.iteratorNotHandled)z[M]={},b=n+F,yield*I.call(this,w,z[M]);else throw T}}function Q(){K=Z,c.encode(null,da)}function J(w,z,M){return z&&z.chunkThreshold?K=Z=z.chunkThreshold:K=100,w&&typeof w=="object"?(c.encode(null,da),M(w,c.iterateProperties||(c.iterateProperties={}),!0)):[c.encode(w)]}async function*X(w,z){for(let M of I(w,z,!0)){let F=M.constructor;if(F===A_||F===Uint8Array)yield M;else if(ca(M)){let T=M.stream().getReader(),G;for(;!(G=await T.read()).done;)yield G.value}else if(M[Symbol.asyncIterator])for await(let T of M)Q(),T?yield*X(T,z.async||(z.async={})):yield c.encode(T);else yield M}}}useBuffer(e){k=e,ye=new DataView(k.buffer,k.byteOffset,k.byteLength),b=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new j_(n,this.sharedValues,this.sharedVersion),o=this.saveShared(r,i=>(i&&i.version||0)==e);return o===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((i,a)=>this.structures[a]=i),o}}function C_(t,e){t<24?k[b++]=e|t:t<256?(k[b++]=e|24,k[b++]=t):t<65536?(k[b++]=e|25,k[b++]=t>>8,k[b++]=t&255):(k[b++]=e|26,ye.setUint32(b,t),b+=4)}class j_{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}}function St(t){t<24?k[b++]=128|t:t<256?(k[b++]=152,k[b++]=t):t<65536?(k[b++]=153,k[b++]=t>>8,k[b++]=t&255):(k[b++]=154,ye.setUint32(b,t),b+=4)}const Tm=typeof Blob>"u"?function(){}:Blob;function ca(t){if(t instanceof Tm)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function Uo(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let o=e.samplingPackedValues.get(t);o?o.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,o=t.length;r<o;r++)Uo(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&Uo(n,e),Uo(t[n],e))}break;case"function":console.log(t)}}const Pm=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;x_=[Date,Set,Error,RegExp,Zt,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,j_],ia=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(k[b++]=26,ye.setUint32(b,n),b+=4):(k[b++]=251,ye.setFloat64(b,n),b+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){R_(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||br&&this.tagUint8Array!==!1))return 64},encode(t,e,n){R_(t,n)}},kt(68,1),kt(69,2),kt(70,4),kt(71,8),kt(72,1),kt(77,2),kt(78,4),kt(79,8),kt(85,4),kt(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){k[b++]=216,k[b++]=51,St(4);let o=n.values;e(o),St(0),St(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let i=0,a=o.length;i<a;i++)packedObjectMap[o[i]]=i}if(r){ye.setUint32(b,3655335424),b+=3;let o=r.slice(0);o.unshift(57344),o.push(new Zt(t.version,1399353956)),e(o)}else e(new Zt(t.version,1399353956))}}];function kt(t,e){return!Pm&&e>1&&(t-=4),{tag:t,encode:function(n,r){let o=n.byteLength,i=n.byteOffset||0,a=n.buffer||n;r(br?Mo.from(a,i,o):new Uint8Array(a,i,o))}}}function R_(t,e){let n=t.byteLength;n<24?k[b++]=64+n:n<256?(k[b++]=88,k[b++]=n):n<65536?(k[b++]=89,k[b++]=n>>8,k[b++]=n&255):(k[b++]=90,ye.setUint32(b,n),b+=4),b+n>=k.length&&e(b+n),k.set(t.buffer?t:new Uint8Array(t),b),b+=n}function Mm(t,e){let n,r=e.length*2,o=t.length-r;e.sort((i,a)=>i.offset>a.offset?1:-1);for(let i=0;i<e.length;i++){let a=e[i];a.id=i;for(let s of a.references)t[s++]=i>>8,t[s]=i&255}for(;n=e.pop();){let i=n.offset;t.copyWithin(i+r,i,o),r-=2;let a=i+r;t[a++]=216,t[a++]=28,o=i}return t}function T_(t,e){ye.setUint32(Ie.position+t,b-Ie.position-t+1);let n=Ie;Ie=null,e(n[0]),e(n[1])}let ua=new O_({useRecords:!1});ua.encode,ua.encodeAsIterable,ua.encodeAsAsyncIterable;const P_=512,Um=1024,da=2048;function M_(t){return new O_({tagUint8Array:!1,useRecords:!1}).encode(t)}function Dm(t){return k_(t)}const Lm=(t,e)=>t.length===e.length&&t.every((n,r)=>n===e[r]),_a=(t,e)=>Lm(t,e),Nm=async(t,e)=>{let n;const r=new Promise((o,i)=>{n=setTimeout(()=>i(new Fm(`withTimeout: timed out after ${e}ms`)),e)});try{return await Promise.race([t,r])}finally{clearTimeout(n)}};class Fm extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Bm extends yn{constructor(n,r={}){super();q(this,vr);q(this,Mn);q(this,Sr);_e(this,"documentId");q(this,mr,void 0);q(this,Oe,void 0);q(this,Ht,6e4);q(this,wr,{});_e(this,"isReady",()=>this.inState([Do.READY]));_e(this,"isDeleted",()=>this.inState([Do.DELETED]));_e(this,"isUnavailable",()=>this.inState([Do.UNAVAILABLE]));_e(this,"inState",n=>{var r;return n.some((r=h(this,Oe))==null?void 0:r.getSnapshot().matches)});this.documentId=n,this.documentId=n,"timeoutDelay"in r&&r.timeoutDelay&&we(this,Ht,r.timeoutDelay);let o;const i="isNew"in r&&r.isNew;i?(o=Jb(r.initialValue),o=Lb(o)):o=mi(),we(this,mr,Mt(`automerge-repo:dochandle:${this.documentId.slice(0,5)}`)),we(this,Oe,Gd(Qy({predictableActionArguments:!0,id:"docHandle",initial:$m,context:{documentId:this.documentId,doc:o},states:{idle:{on:{CREATE:{target:xt},FIND:{target:la},DELETE:{actions:"onDelete",target:yr}}},loading:{on:{UPDATE:{actions:"onUpdate",target:xt},REQUEST:{target:Rn},AWAIT_NETWORK:{target:U_},DELETE:{actions:"onDelete",target:yr}},after:[{delay:h(this,Ht),target:Tn}]},awaitingNetwork:{on:{NETWORK_READY:{target:Rn}}},requesting:{on:{MARK_UNAVAILABLE:{target:Tn,actions:"onUnavailable"},UPDATE:{actions:"onUpdate"},REQUEST_COMPLETE:{target:xt},DELETE:{actions:"onDelete",target:yr}},after:[{delay:h(this,Ht),target:Tn}]},ready:{on:{UPDATE:{actions:"onUpdate",target:xt},DELETE:{actions:"onDelete",target:yr}}},deleted:{type:"final"},unavailable:{on:{UPDATE:{actions:"onUpdate"},REQUEST_COMPLETE:{target:xt},DELETE:{actions:"onDelete",target:yr}}}}},{actions:{onUpdate:Bi((a,{payload:s})=>{const{doc:c}=a,{callback:u}=s;return{doc:u(c)}}),onDelete:Bi(()=>(this.emit("delete",{handle:this}),{doc:void 0})),onUnavailable:Bi(a=>{const{doc:s}=a;return this.emit("unavailable",{handle:this}),{doc:s}})}})).onTransition(({value:a,history:s,context:c},u)=>{var l;const _=(l=s==null?void 0:s.context)==null?void 0:l.doc,d=c.doc;if(h(this,mr).call(this,`${s==null?void 0:s.value}: ${u.type} \u2192 ${a}`,d),d&&_&&!_a(wt(d),wt(_))){this.emit("heads-changed",{handle:this,doc:d});const f=Bb(d,wt(_),wt(d));f.length>0&&this.emit("change",{handle:this,doc:d,patches:f,patchInfo:{before:_,after:d,source:"change"}}),this.isReady()||h(this,Oe).send(Jm)}}).start()),h(this,Oe).send(i?zm:Hm)}get url(){return Ji({documentId:this.documentId})}get state(){var n;return(n=h(this,Oe))==null?void 0:n.getSnapshot().value}async whenReady(n=[xt]){await Nm(ne(this,Sr,va).call(this,n),h(this,Ht))}async doc(n=[xt,Tn]){try{await ne(this,Sr,va).call(this,n)}catch{return}return this.isUnavailable()?void 0:h(this,vr,wa)}docSync(){if(this.isReady())return h(this,vr,wa)}update(n){h(this,Oe).send(fa,{payload:{callback:n}})}setRemoteHeads(n,r){h(this,wr)[n]=r,this.emit("remote-heads",{storageId:n,heads:r})}getRemoteHeads(n){return h(this,wr)[n]}change(n,r={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);h(this,Oe).send(fa,{payload:{callback:o=>Ub(o,r,n)}})}changeAt(n,r,o={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);let i;return h(this,Oe).send(fa,{payload:{callback:a=>{const s=Db(a,n,o,r);return i=s.newHeads,s.newDoc}}}),i}merge(n){if(!this.isReady()||!n.isReady())throw new Error("Both handles must be ready to merge");const r=n.docSync();if(!r)throw new Error("The document to be merged in is null, aborting.");this.update(o=>Fb(o,r))}unavailable(){h(this,Oe).send(Wm)}request(){h(this,Mn,ei)===la&&h(this,Oe).send(Km)}awaitNetwork(){h(this,Mn,ei)===la&&h(this,Oe).send(Qm)}networkReady(){h(this,Mn,ei)===U_&&h(this,Oe).send(Ym)}delete(){h(this,Oe).send(qm)}broadcast(n){this.emit("ephemeral-message-outbound",{handle:this,data:M_(n)})}}mr=new WeakMap,Oe=new WeakMap,Ht=new WeakMap,wr=new WeakMap,vr=new WeakSet,wa=function(){var n;return(n=h(this,Oe))==null?void 0:n.getSnapshot().context.doc},Mn=new WeakSet,ei=function(){var n;return(n=h(this,Oe))==null?void 0:n.getSnapshot().value},Sr=new WeakSet,va=function(n){const r=Array.isArray(n)?n:[n];return Xy(h(this,Oe),o=>r.some(i=>o.matches(i)),{timeout:h(this,Ht)*2})};const Do={IDLE:"idle",LOADING:"loading",AWAITING_NETWORK:"awaitingNetwork",REQUESTING:"requesting",READY:"ready",DELETED:"deleted",UNAVAILABLE:"unavailable"},Vm={CREATE:"CREATE",FIND:"FIND",REQUEST:"REQUEST",REQUEST_COMPLETE:"REQUEST_COMPLETE",AWAIT_NETWORK:"AWAIT_NETWORK",NETWORK_READY:"NETWORK_READY",UPDATE:"UPDATE",TIMEOUT:"TIMEOUT",DELETE:"DELETE",MARK_UNAVAILABLE:"MARK_UNAVAILABLE"},{IDLE:$m,LOADING:la,AWAITING_NETWORK:U_,REQUESTING:Rn,READY:xt,DELETED:yr,UNAVAILABLE:Tn}=Do,{CREATE:zm,FIND:Hm,REQUEST:Km,UPDATE:fa,TIMEOUT:Tw,DELETE:qm,REQUEST_COMPLETE:Jm,MARK_UNAVAILABLE:Wm,AWAIT_NETWORK:Qm,NETWORK_READY:Ym}=Vm;class Zm extends yn{constructor(){super(...arguments);q(this,kr);q(this,Lo);q(this,Et,new Map);q(this,qe,new Set);q(this,Ze,new Map);q(this,It,new Set);q(this,Kt,new Map);q(this,Ot,Mt("automerge-repo:remote-heads-subscriptions"))}subscribeToRemotes(n){h(this,Ot).call(this,"subscribeToRemotes",n);const r=[];for(const o of n)h(this,qe).has(o)||(h(this,qe).add(o),r.push(o));r.length>0&&this.emit("change-remote-subs",{add:r,peers:Array.from(h(this,It))})}unsubscribeFromRemotes(n){h(this,Ot).call(this,"subscribeToRemotes",n);const r=[];for(const o of n)h(this,qe).has(o)&&(h(this,qe).delete(o),h(this,Ze).has(o)||r.push(o));r.length>0&&this.emit("change-remote-subs",{remove:r,peers:Array.from(h(this,It))})}handleControlMessage(n){const r=[],o=[],i=[];if(h(this,Ot).call(this,"handleControlMessage",n),n.add)for(const a of n.add){let s=h(this,Ze).get(a);(h(this,qe).has(a)||s)&&i.push(a),s||(s=new Set,h(this,Ze).set(a,s),h(this,qe).has(a)||r.push(a)),s.add(n.senderId)}if(n.remove)for(const a of n.remove){const s=h(this,Ze).get(a);s&&(s.delete(n.senderId),s.size==0&&!h(this,qe).has(a)&&o.push(a))}(r.length>0||o.length>0)&&this.emit("change-remote-subs",{peers:Array.from(h(this,It)),add:r,remove:o});for(const a of i){const s=h(this,Kt).get(n.senderId);if(s)for(const c of s){const u=h(this,Et).get(c);if(!u)continue;const _=u.get(a);_&&this.emit("notify-remote-heads",{targetId:n.senderId,documentId:c,heads:_.heads,timestamp:_.timestamp,storageId:a})}}}handleRemoteHeads(n){h(this,Ot).call(this,"handleRemoteHeads",n);const r=ne(this,Lo,H_).call(this,n);for(const o of r)h(this,qe).has(o.storageId)&&this.emit("remote-heads-changed",o);for(const o of r)for(const i of h(this,It))i!==n.senderId&&this.emit("notify-remote-heads",{targetId:i,documentId:o.documentId,heads:o.remoteHeads,timestamp:o.timestamp,storageId:o.storageId});for(const o of r){const i=h(this,Ze).get(o.storageId);if(i)for(const a of i)ne(this,kr,Sa).call(this,a,o.documentId)&&this.emit("notify-remote-heads",{targetId:a,documentId:o.documentId,heads:o.remoteHeads,timestamp:o.timestamp,storageId:o.storageId})}}handleImmediateRemoteHeadsChanged(n,r,o){h(this,Ot).call(this,"handleLocalHeadsChanged",n,r,o);const i=h(this,Et).get(n),a=Date.now();if(!i)h(this,Et).set(n,new Map([[r,{heads:o,timestamp:a}]]));else{const c=i.get(r);(!c||c.timestamp<Date.now())&&i.set(r,{heads:o,timestamp:Date.now()})}const s=h(this,Ze).get(r);if(s)for(const c of s)ne(this,kr,Sa).call(this,c,n)&&this.emit("notify-remote-heads",{targetId:c,documentId:n,heads:o,timestamp:a,storageId:r})}addGenerousPeer(n){h(this,Ot).call(this,"addGenerousPeer",n),h(this,It).add(n),h(this,qe).size>0&&this.emit("change-remote-subs",{add:Array.from(h(this,qe)),peers:[n]});for(const[r,o]of h(this,Et))for(const[i,{heads:a,timestamp:s}]of o)this.emit("notify-remote-heads",{targetId:n,documentId:r,heads:a,timestamp:s,storageId:i})}removePeer(n){h(this,Ot).call(this,"removePeer",n);const r=[];h(this,It).delete(n),h(this,Kt).delete(n);for(const[o,i]of h(this,Ze))i.has(n)&&(i.delete(n),i.size==0&&(r.push(o),h(this,Ze).delete(o)));r.length>0&&this.emit("change-remote-subs",{remove:r,peers:Array.from(h(this,It))})}subscribePeerToDoc(n,r){let o=h(this,Kt).get(n);o||(o=new Set,h(this,Kt).set(n,o)),o.add(r);const i=h(this,Et).get(r);if(i)for(const[a,s]of i){const c=h(this,Ze).get(a);c&&c.has(n)&&this.emit("notify-remote-heads",{targetId:n,documentId:r,heads:s.heads,timestamp:s.timestamp,storageId:a})}}}Et=new WeakMap,qe=new WeakMap,Ze=new WeakMap,It=new WeakMap,Kt=new WeakMap,Ot=new WeakMap,kr=new WeakSet,Sa=function(n,r){const o=h(this,Kt).get(n);return o&&o.has(r)},Lo=new WeakSet,H_=function(n){const r=[],{documentId:o,newHeads:i}=n;for(const[a,{heads:s,timestamp:c}]of Object.entries(i)){if(!h(this,qe).has(a)&&!h(this,Ze).has(a))continue;let u=h(this,Et).get(o);u||(u=new Map,h(this,Et).set(o,u));const _=u.get(a);_&&_.timestamp>=c||(u.set(a,{timestamp:c,heads:s}),r.push({documentId:o,storageId:a,remoteHeads:s,timestamp:c}))}return r};const ha=(t,e)=>{let n=Date.now(),r,o;return function(...i){r=n+e-Date.now(),clearTimeout(o),o=setTimeout(()=>{t(...i),n=Date.now()},r)}},Xm=t=>ew(t)||L_(t)||D_(t)||Gm(t)||tw(t)||nw(t),Gm=t=>t.type==="doc-unavailable",D_=t=>t.type==="request",ew=t=>t.type==="sync",L_=t=>t.type==="ephemeral",tw=t=>t.type==="remote-subscription-change",nw=t=>t.type==="remote-heads-changed",rw=t=>`${t.senderId}:${t.sessionId}`;class ow extends yn{constructor(n,r=iw(),o){super();_e(this,"peerId");_e(this,"peerMetadata");q(this,Xe,void 0);q(this,Ut,{});q(this,No,0);q(this,Fo,Math.random().toString(36).slice(2));q(this,Un,{});q(this,Gt,0);q(this,en,[]);_e(this,"isReady",()=>h(this,Gt)===h(this,en).length);_e(this,"whenReady",async()=>{if(!this.isReady())return new Promise(n=>{this.once("ready",()=>{n()})})});this.peerId=r,this.peerMetadata=o,we(this,Xe,Mt(`automerge-repo:network:${this.peerId}`)),n.forEach(i=>this.addNetworkAdapter(i))}addNetworkAdapter(n){h(this,en).push(n),n.once("ready",()=>{ya(this,Gt)._++,h(this,Xe).call(this,"Adapters ready: ",h(this,Gt),"/",h(this,en).length),h(this,Gt)===h(this,en).length&&this.emit("ready")}),n.on("peer-candidate",({peerId:r,peerMetadata:o})=>{h(this,Xe).call(this,`peer candidate: ${r} `),h(this,Ut)[r]||(h(this,Ut)[r]=n),this.emit("peer",{peerId:r,peerMetadata:o})}),n.on("peer-disconnected",({peerId:r})=>{h(this,Xe).call(this,`peer disconnected: ${r} `),delete h(this,Ut)[r],this.emit("peer-disconnected",{peerId:r})}),n.on("message",r=>{if(!Xm(r)){h(this,Xe).call(this,`invalid message: ${JSON.stringify(r)}`);return}if(h(this,Xe).call(this,`message from ${r.senderId}`),L_(r)){const o=rw(r);(h(this,Un)[o]===void 0||r.count>h(this,Un)[o])&&(h(this,Un)[o]=r.count,this.emit("message",r));return}this.emit("message",r)}),n.on("close",()=>{h(this,Xe).call(this,"adapter closed"),Object.entries(h(this,Ut)).forEach(([r,o])=>{o===n&&delete h(this,Ut)[r]})}),this.peerMetadata.then(r=>{n.connect(this.peerId,r)}).catch(r=>{h(this,Xe).call(this,"error connecting to network",r)})}send(n){const r=h(this,Ut)[n.targetId];if(!r){h(this,Xe).call(this,`Tried to send message but peer not found: ${n.targetId}`);return}const o=(i=>i.type==="ephemeral"?"count"in i?i:{...i,count:++ya(this,No)._,sessionId:h(this,Fo),senderId:this.peerId}:{...i,senderId:this.peerId})(n);h(this,Xe).call(this,"sending message %o",o),r.send(o)}}Xe=new WeakMap,Ut=new WeakMap,No=new WeakMap,Fo=new WeakMap,Un=new WeakMap,Gt=new WeakMap,en=new WeakMap;function iw(){return`user-${Math.round(Math.random()*1e5)}`}function N_(t){let e=0;t.forEach(o=>{e+=o.length});const n=new Uint8Array(e);let r=0;return t.forEach(o=>{n.set(o,r),r+=o.length}),n}var F_={exports:{}};(function(t){(function(e,n){var r={};n(r);var o=r.default;for(var i in r)o[i]=r[i];t.exports=o})(Qb,function(e){e.__esModule=!0,e.digestLength=32,e.blockSize=64;var n=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(l,f,m,y,j){for(var C,O,E,$,W,K,Z,I,D,Q,J,X,w;j>=64;){for(C=f[0],O=f[1],E=f[2],$=f[3],W=f[4],K=f[5],Z=f[6],I=f[7],Q=0;Q<16;Q++)J=y+Q*4,l[Q]=(m[J]&255)<<24|(m[J+1]&255)<<16|(m[J+2]&255)<<8|m[J+3]&255;for(Q=16;Q<64;Q++)D=l[Q-2],X=(D>>>17|D<<15)^(D>>>19|D<<13)^D>>>10,D=l[Q-15],w=(D>>>7|D<<25)^(D>>>18|D<<14)^D>>>3,l[Q]=(X+l[Q-7]|0)+(w+l[Q-16]|0);for(Q=0;Q<64;Q++)X=(((W>>>6|W<<26)^(W>>>11|W<<21)^(W>>>25|W<<7))+(W&K^~W&Z)|0)+(I+(n[Q]+l[Q]|0)|0)|0,w=((C>>>2|C<<30)^(C>>>13|C<<19)^(C>>>22|C<<10))+(C&O^C&E^O&E)|0,I=Z,Z=K,K=W,W=$+X|0,$=E,E=O,O=C,C=X+w|0;f[0]+=C,f[1]+=O,f[2]+=E,f[3]+=$,f[4]+=W,f[5]+=K,f[6]+=Z,f[7]+=I,y+=64,j-=64}return y}var o=function(){function l(){this.digestLength=e.digestLength,this.blockSize=e.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return l.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},l.prototype.clean=function(){for(var f=0;f<this.buffer.length;f++)this.buffer[f]=0;for(var f=0;f<this.temp.length;f++)this.temp[f]=0;this.reset()},l.prototype.update=function(f,m){if(m===void 0&&(m=f.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var y=0;if(this.bytesHashed+=m,this.bufferLength>0){for(;this.bufferLength<64&&m>0;)this.buffer[this.bufferLength++]=f[y++],m--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(m>=64&&(y=r(this.temp,this.state,f,y,m),m%=64);m>0;)this.buffer[this.bufferLength++]=f[y++],m--;return this},l.prototype.finish=function(f){if(!this.finished){var m=this.bytesHashed,y=this.bufferLength,j=m/536870912|0,C=m<<3,O=m%64<56?64:128;this.buffer[y]=128;for(var E=y+1;E<O-8;E++)this.buffer[E]=0;this.buffer[O-8]=j>>>24&255,this.buffer[O-7]=j>>>16&255,this.buffer[O-6]=j>>>8&255,this.buffer[O-5]=j>>>0&255,this.buffer[O-4]=C>>>24&255,this.buffer[O-3]=C>>>16&255,this.buffer[O-2]=C>>>8&255,this.buffer[O-1]=C>>>0&255,r(this.temp,this.state,this.buffer,0,O),this.finished=!0}for(var E=0;E<8;E++)f[E*4+0]=this.state[E]>>>24&255,f[E*4+1]=this.state[E]>>>16&255,f[E*4+2]=this.state[E]>>>8&255,f[E*4+3]=this.state[E]>>>0&255;return this},l.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},l.prototype._saveState=function(f){for(var m=0;m<this.state.length;m++)f[m]=this.state[m]},l.prototype._restoreState=function(f,m){for(var y=0;y<this.state.length;y++)this.state[y]=f[y];this.bytesHashed=m,this.finished=!1,this.bufferLength=0},l}();e.Hash=o;var i=function(){function l(f){this.inner=new o,this.outer=new o,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var m=new Uint8Array(this.blockSize);if(f.length>this.blockSize)new o().update(f).finish(m).clean();else for(var y=0;y<f.length;y++)m[y]=f[y];for(var y=0;y<m.length;y++)m[y]^=54;this.inner.update(m);for(var y=0;y<m.length;y++)m[y]^=106;this.outer.update(m),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(var y=0;y<m.length;y++)m[y]=0}return l.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},l.prototype.clean=function(){for(var f=0;f<this.istate.length;f++)this.ostate[f]=this.istate[f]=0;this.inner.clean(),this.outer.clean()},l.prototype.update=function(f){return this.inner.update(f),this},l.prototype.finish=function(f){return this.outer.finished?this.outer.finish(f):(this.inner.finish(f),this.outer.update(f,this.digestLength).finish(f)),this},l.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},l}();e.HMAC=i;function a(l){var f=new o().update(l),m=f.digest();return f.clean(),m}e.hash=a,e.default=a;function s(l,f){var m=new i(l).update(f),y=m.digest();return m.clean(),y}e.hmac=s;function c(l,f,m,y){var j=y[0];if(j===0)throw new Error("hkdf: cannot expand more");f.reset(),j>1&&f.update(l),m&&f.update(m),f.update(y),f.finish(l),y[0]++}var u=new Uint8Array(e.digestLength);function _(l,f,m,y){f===void 0&&(f=u),y===void 0&&(y=32);for(var j=new Uint8Array([1]),C=s(f,l),O=new i(C),E=new Uint8Array(O.digestLength),$=E.length,W=new Uint8Array(y),K=0;K<y;K++)$===E.length&&(c(E,O,m,j),$=0),W[K]=E[$++];return O.clean(),E.fill(0),j.fill(0),W}e.hkdf=_;function d(l,f,m,y){for(var j=new i(l),C=j.digestLength,O=new Uint8Array(4),E=new Uint8Array(C),$=new Uint8Array(C),W=new Uint8Array(y),K=0;K*C<y;K++){var Z=K+1;O[0]=Z>>>24&255,O[1]=Z>>>16&255,O[2]=Z>>>8&255,O[3]=Z>>>0&255,j.reset(),j.update(f),j.update(O),j.finish($);for(var I=0;I<C;I++)E[I]=$[I];for(var I=2;I<=m;I++){j.reset(),j.update($).finish($);for(var D=0;D<C;D++)E[D]^=$[D]}for(var I=0;I<C&&K*C+I<y;I++)W[K*C+I]=E[I]}for(var K=0;K<C;K++)E[K]=$[K]=0;for(var K=0;K<4;K++)O[K]=0;return j.clean(),W}e.pbkdf2=d})})(F_);var aw=F_.exports;function B_(t){const e=aw.hash(t);return cw(e)}function sw(t){const e=new TextEncoder,n=N_(t.map(r=>e.encode(r)));return B_(n)}function cw(t){return Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}function uw(t){if(t.length<2)return null;const e=t[t.length-2];return e==="snapshot"||e==="incremental"?e:null}class dw{constructor(e){q(this,Bo);q(this,Vo);q(this,$o);q(this,zo);q(this,Re,void 0);q(this,qt,new Map);q(this,Ct,new Map);q(this,Dn,!1);q(this,Ln,Mt("automerge-repo:storage-subsystem"));we(this,Re,e)}async id(){const e=await h(this,Re).load(["storage-adapter-id"]);let n;return e?n=new TextDecoder().decode(e):(n=Ra(),await h(this,Re).save(["storage-adapter-id"],new TextEncoder().encode(n))),n}async load(e,n){const r=[e,n];return await h(this,Re).load(r)}async save(e,n,r){const o=[e,n];await h(this,Re).save(o,r)}async remove(e,n){const r=[e,n];await h(this,Re).remove(r)}async loadDoc(e){const n=await h(this,Re).loadRange([e]),r=[],o=[];for(const s of n){if(s.data===void 0)continue;const c=uw(s.key);c!=null&&(o.push({key:s.key,type:c,size:s.data.length}),r.push(s.data))}h(this,Ct).set(e,o);const i=N_(r);if(i.length===0)return null;const a=wd(mi(),i);return h(this,qt).set(e,wt(a)),a}async saveDoc(e,n){if(!ne(this,$o,J_).call(this,e,n))return;const r=h(this,Ct).get(e)??[];ne(this,zo,W_).call(this,r)?await ne(this,Vo,q_).call(this,e,n,r):await ne(this,Bo,K_).call(this,e,n),h(this,qt).set(e,wt(n))}async removeDoc(e){await h(this,Re).removeRange([e,"snapshot"]),await h(this,Re).removeRange([e,"incremental"]),await h(this,Re).removeRange([e,"sync-state"])}async loadSyncState(e,n){const r=[e,"sync-state",n],o=await h(this,Re).load(r);return o?xd(o):void 0}async saveSyncState(e,n,r){const o=[e,"sync-state",n];await h(this,Re).save(o,kd(r))}}Re=new WeakMap,qt=new WeakMap,Ct=new WeakMap,Dn=new WeakMap,Ln=new WeakMap,Bo=new WeakSet,K_=async function(e,n){const r=qb(n,h(this,qt).get(e)??[]);if(r&&r.length>0){const o=[e,"incremental",B_(r)];h(this,Ln).call(this,`Saving incremental ${o} for document ${e}`),await h(this,Re).save(o,r),h(this,Ct).has(e)||h(this,Ct).set(e,[]),h(this,Ct).get(e).push({key:o,type:"incremental",size:r.length}),h(this,qt).set(e,wt(n))}else return Promise.resolve()},Vo=new WeakSet,q_=async function(e,n,r){var u;we(this,Dn,!0);const o=vd(n),i=sw(wt(n)),a=[e,"snapshot",i],s=new Set(r.map(_=>_.key).filter(_=>_[2]!==i));h(this,Ln).call(this,`Saving snapshot ${a} for document ${e}`),h(this,Ln).call(this,`deleting old chunks ${Array.from(s)}`),await h(this,Re).save(a,o);for(const _ of s)await h(this,Re).remove(_);const c=((u=h(this,Ct).get(e))==null?void 0:u.filter(_=>!s.has(_.key)))??[];c.push({key:a,type:"snapshot",size:o.length}),h(this,Ct).set(e,c),we(this,Dn,!1)},$o=new WeakSet,J_=function(e,n){const r=h(this,qt).get(e);if(!r)return!0;const o=wt(n);return!_a(o,r)},zo=new WeakSet,W_=function(e){if(h(this,Dn))return!1;let n=0,r=0;for(const o of e)o.type==="snapshot"?n+=o.size:r+=o.size;return n<1024||r>=n};class V_ extends yn{}class _w extends V_{constructor({handle:n,onLoadSyncState:r}){super();q(this,Ho);q(this,Ko);q(this,qo);q(this,Bn);q(this,Jo);q(this,Wo);q(this,Vn);q(this,$n);q(this,Er);q(this,nn);q(this,Ir);q(this,at,void 0);_e(this,"syncDebounceRate",100);q(this,Je,[]);q(this,tn,{});q(this,Le,{});q(this,Nn,{});q(this,Fn,[]);q(this,xr,!1);q(this,xe,void 0);q(this,Ar,void 0);we(this,xe,n),we(this,Ar,r??(()=>Promise.resolve(void 0)));const o=n.documentId.slice(0,5);we(this,at,Mt(`automerge-repo:docsync:${o}`)),n.on("change",ha(()=>ne(this,Ho,Q_).call(this),this.syncDebounceRate)),n.on("ephemeral-message-outbound",i=>ne(this,Ko,Y_).call(this,i)),(async()=>(await n.doc([xt,Rn]),ne(this,Ir,xa).call(this)))()}get peerStates(){return h(this,Le)}get documentId(){return h(this,xe).documentId}hasPeer(n){return h(this,Je).includes(n)}beginSync(n){const r=n.every(i=>h(this,Le)[i]in["unavailable","wants"]),o=h(this,xe).doc([xt,Rn,Tn]).then(i=>{if(we(this,xr,!0),ne(this,nn,Dr).call(this),!(i===void 0&&r))return i??mi()});h(this,at).call(this,`beginSync: ${n.join(", ")}`),n.forEach(i=>{ne(this,Bn,ti).call(this,i,a=>{const s=xd(kd(a));ne(this,Vn,ni).call(this,i,s),o.then(c=>{c&&ne(this,$n,ri).call(this,i,c)}).catch(c=>{h(this,at).call(this,`Error loading doc for ${i}: ${c}`)})})})}endSync(n){h(this,at).call(this,`removing peer ${n}`),we(this,Je,h(this,Je).filter(r=>r!==n))}receiveMessage(n){switch(n.type){case"sync":case"request":this.receiveSyncMessage(n);break;case"ephemeral":this.receiveEphemeralMessage(n);break;case"doc-unavailable":h(this,Le)[n.senderId]="unavailable",ne(this,nn,Dr).call(this);break;default:throw new Error(`unknown message type: ${n}`)}}receiveEphemeralMessage(n){if(n.documentId!==h(this,xe).documentId)throw new Error("channelId doesn't match documentId");const{senderId:r,data:o}=n,i=k_(new Uint8Array(o));h(this,xe).emit("ephemeral-message",{handle:h(this,xe),senderId:r,message:i}),h(this,Je).forEach(a=>{a!==r&&this.emit("message",{...n,targetId:a})})}receiveSyncMessage(n){if(n.documentId!==h(this,xe).documentId)throw new Error("channelId doesn't match documentId");if(!h(this,xe).inState([xt,Rn,Tn])){h(this,Fn).push({message:n,received:new Date});return}ne(this,Ir,xa).call(this),ne(this,Er,ka).call(this,n)}}at=new WeakMap,Je=new WeakMap,tn=new WeakMap,Le=new WeakMap,Nn=new WeakMap,Fn=new WeakMap,xr=new WeakMap,xe=new WeakMap,Ar=new WeakMap,Ho=new WeakSet,Q_=async function(){h(this,at).call(this,"syncWithPeers");const n=await h(this,xe).doc();n!==void 0&&h(this,Je).forEach(r=>ne(this,$n,ri).call(this,r,n))},Ko=new WeakSet,Y_=async function({data:n}){h(this,at).call(this,"broadcastToPeers",h(this,Je)),h(this,Je).forEach(r=>ne(this,qo,Z_).call(this,r,n))},qo=new WeakSet,Z_=function(n,r){h(this,at).call(this,`sendEphemeralMessage ->${n}`);const o={type:"ephemeral",targetId:n,documentId:h(this,xe).documentId,data:r};this.emit("message",o)},Bn=new WeakSet,ti=function(n,r){ne(this,Jo,X_).call(this,n),n in h(this,Le)||(h(this,Le)[n]="unknown");const o=h(this,Nn)[n];if(o){r(o);return}let i=h(this,tn)[n];i||(h(this,Ar).call(this,n).then(a=>{ne(this,Wo,G_).call(this,n,a??Hb())}).catch(a=>{h(this,at).call(this,`Error loading sync state for ${n}: ${a}`)}),i=h(this,tn)[n]=[]),i.push(r)},Jo=new WeakSet,X_=function(n){h(this,Je).includes(n)||(h(this,Je).push(n),this.emit("open-doc",{documentId:this.documentId,peerId:n}))},Wo=new WeakSet,G_=function(n,r){const o=h(this,tn)[n];if(o)for(const i of o)i(r);delete h(this,tn)[n],h(this,Nn)[n]=r},Vn=new WeakSet,ni=function(n,r){h(this,Nn)[n]=r,this.emit("sync-state",{peerId:n,syncState:r,documentId:h(this,xe).documentId})},$n=new WeakSet,ri=function(n,r){h(this,at).call(this,`sendSyncMessage ->${n}`),ne(this,Bn,ti).call(this,n,o=>{const[i,a]=$b(r,o);if(a){ne(this,Vn,ni).call(this,n,i);const s=wt(r).length===0;!h(this,xe).isReady()&&s&&i.sharedHeads.length===0&&!Object.values(h(this,Le)).includes("has")&&h(this,Le)[n]==="unknown"?this.emit("message",{type:"request",targetId:n,documentId:h(this,xe).documentId,data:a}):this.emit("message",{type:"sync",targetId:n,data:a,documentId:h(this,xe).documentId}),s||(h(this,Le)[n]="has")}})},Er=new WeakSet,ka=function(n){D_(n)&&(h(this,Le)[n.senderId]="wants"),ne(this,nn,Dr).call(this),Kb(n.data).heads.length>0&&(h(this,Le)[n.senderId]="has"),ne(this,Bn,ti).call(this,n.senderId,r=>{h(this,xe).update(o=>{const[i,a]=zb(o,r,n.data);return ne(this,Vn,ni).call(this,n.senderId,a),ne(this,$n,ri).call(this,n.senderId,o),i}),ne(this,nn,Dr).call(this)})},nn=new WeakSet,Dr=function(){h(this,xr)&&h(this,xe).inState([Rn])&&h(this,Je).every(n=>h(this,Le)[n]==="unavailable"||h(this,Le)[n]==="wants")&&(h(this,Je).filter(n=>h(this,Le)[n]==="wants").forEach(n=>{const r={type:"doc-unavailable",documentId:h(this,xe).documentId,targetId:n};this.emit("message",r)}),h(this,xe).unavailable())},Ir=new WeakSet,xa=function(){for(const n of h(this,Fn))ne(this,Er,ka).call(this,n.message);we(this,Fn,[])};const ga=Mt("automerge-repo:collectionsync");class lw extends V_{constructor(n){super();q(this,Cr);q(this,Qo);q(this,jr);_e(this,"repo");q(this,Jt,new Set);q(this,Wt,{});q(this,Or,{});this.repo=n}async receiveMessage(n){ga(`onSyncMessage: ${n.senderId}, ${n.documentId}, ${"data"in n?n.data.byteLength+"bytes":""}`);const r=n.documentId;if(!r)throw new Error("received a message with an invalid documentId");h(this,Or)[r]=!0;const o=ne(this,Cr,Aa).call(this,r);o.receiveMessage(n);const i=await ne(this,jr,Ea).call(this,r);o.beginSync(i.filter(a=>!o.hasPeer(a)))}addDocument(n){if(h(this,Or)[n])return;const r=ne(this,Cr,Aa).call(this,n);ne(this,jr,Ea).call(this,n).then(o=>{r.beginSync(o)})}removeDocument(n){throw new Error("not implemented")}addPeer(n){if(ga(`adding ${n} & synchronizing with them`),!h(this,Jt).has(n)){h(this,Jt).add(n);for(const r of Object.values(h(this,Wt))){const{documentId:o}=r;this.repo.sharePolicy(n,o).then(i=>{i&&r.beginSync([n])})}}}removePeer(n){ga(`removing peer ${n}`),h(this,Jt).delete(n);for(const r of Object.values(h(this,Wt)))r.endSync(n)}get peers(){return Array.from(h(this,Jt))}}Jt=new WeakMap,Wt=new WeakMap,Or=new WeakMap,Cr=new WeakSet,Aa=function(n){if(!h(this,Wt)[n]){const r=this.repo.find(Ji({documentId:n}));h(this,Wt)[n]=ne(this,Qo,el).call(this,r)}return h(this,Wt)[n]},Qo=new WeakSet,el=function(n){const r=new _w({handle:n,onLoadSyncState:async o=>{if(!this.repo.storageSubsystem)return;const{storageId:i,isEphemeral:a}=this.repo.peerMetadataByPeerId[o]||{};if(!(!i||a))return this.repo.storageSubsystem.loadSyncState(n.documentId,i)}});return r.on("message",o=>this.emit("message",o)),r.on("open-doc",o=>this.emit("open-doc",o)),r.on("sync-state",o=>this.emit("sync-state",o)),r},jr=new WeakSet,Ea=async function(n){const r=Array.from(h(this,Jt)),o=[];for(const i of r)await this.repo.sharePolicy(i,n)&&o.push(i);return o};class fw extends yn{constructor({storage:n,network:r,peerId:o,sharePolicy:i,isEphemeral:a=n===void 0,enableRemoteHeadsGossiping:s=!1}){super();q(this,Yo);q(this,Zo);q(this,rn);q(this,st,void 0);_e(this,"networkSubsystem");_e(this,"storageSubsystem");_e(this,"saveDebounceRate",100);q(this,$e,{});q(this,ct,void 0);_e(this,"sharePolicy",async()=>!0);_e(this,"peerMetadataByPeerId",{});q(this,Ge,new Zm);q(this,ft,!1);q(this,Rr,{});_e(this,"subscribeToRemotes",n=>{h(this,ft)?(h(this,st).call(this,"subscribeToRemotes",{remotes:n}),h(this,Ge).subscribeToRemotes(n)):h(this,st).call(this,"WARN: subscribeToRemotes called but remote heads gossiping is not enabled")});_e(this,"storageId",async()=>{if(this.storageSubsystem)return this.storageSubsystem.id()});we(this,ft,s),we(this,st,Mt("automerge-repo:repo")),this.sharePolicy=i??this.sharePolicy,this.on("document",async({handle:d,isNew:l})=>{if(c){const f=({handle:m,doc:y})=>{c.saveDoc(m.documentId,y)};if(d.on("heads-changed",ha(f,this.saveDebounceRate)),l)await c.saveDoc(d.documentId,d.docSync());else{const m=await c.loadDoc(d.documentId);m&&d.update(()=>m)}}d.on("unavailable",()=>{h(this,st).call(this,"document unavailable",{documentId:d.documentId}),this.emit("unavailable-document",{documentId:d.documentId})}),this.networkSubsystem.isReady()?d.request():(d.awaitNetwork(),this.networkSubsystem.whenReady().then(()=>{d.networkReady()}).catch(f=>{h(this,st).call(this,"error waiting for network",{err:f})})),h(this,ct).addDocument(d.documentId)}),this.on("delete-document",({documentId:d})=>{c&&c.removeDoc(d).catch(l=>{h(this,st).call(this,"error deleting document",{documentId:d,err:l})})}),we(this,ct,new lw(this)),h(this,ct).on("message",d=>{h(this,st).call(this,`sending ${d.type} message to ${d.targetId}`),_.send(d)}),h(this,ft)&&h(this,ct).on("open-doc",({peerId:d,documentId:l})=>{h(this,Ge).subscribePeerToDoc(d,l)});const c=n?new dw(n):void 0;this.storageSubsystem=c;const u=(async()=>({storageId:await(c==null?void 0:c.id()),isEphemeral:a}))(),_=new ow(r,o,u);this.networkSubsystem=_,_.on("peer",async({peerId:d,peerMetadata:l})=>{h(this,st).call(this,"peer connected",{peerId:d}),l&&(this.peerMetadataByPeerId[d]={...l}),this.sharePolicy(d).then(f=>{f&&h(this,ft)&&h(this,Ge).addGenerousPeer(d)}).catch(f=>{console.log("error in share policy",{err:f})}),h(this,ct).addPeer(d)}),_.on("peer-disconnected",({peerId:d})=>{h(this,ct).removePeer(d),h(this,Ge).removePeer(d)}),_.on("message",async d=>{ne(this,Yo,tl).call(this,d)}),h(this,ct).on("sync-state",d=>{ne(this,Zo,nl).call(this,d);const l=h(this,$e)[d.documentId],{storageId:f}=this.peerMetadataByPeerId[d.peerId]||{};if(!f)return;const m=l.getRemoteHeads(f);d.syncState.theirHeads&&(!m||!_a(m,d.syncState.theirHeads))&&(l.setRemoteHeads(f,d.syncState.theirHeads),f&&h(this,ft)&&h(this,Ge).handleImmediateRemoteHeadsChanged(d.documentId,f,d.syncState.theirHeads))}),h(this,ft)&&(h(this,Ge).on("notify-remote-heads",d=>{this.networkSubsystem.send({type:"remote-heads-changed",targetId:d.targetId,documentId:d.documentId,newHeads:{[d.storageId]:{heads:d.heads,timestamp:d.timestamp}}})}),h(this,Ge).on("change-remote-subs",d=>{h(this,st).call(this,"change-remote-subs",d);for(const l of d.peers)this.networkSubsystem.send({type:"remote-subscription-change",targetId:l,add:d.add,remove:d.remove})}),h(this,Ge).on("remote-heads-changed",d=>{h(this,$e)[d.documentId].setRemoteHeads(d.storageId,d.remoteHeads)}))}get handles(){return h(this,$e)}get peers(){return h(this,ct).peers}getStorageIdOfPeer(n){var r;return(r=this.peerMetadataByPeerId[n])==null?void 0:r.storageId}create(n){const{documentId:r}=qi(pm()),o=ne(this,rn,Lr).call(this,{documentId:r,isNew:!0,initialValue:n});return this.emit("document",{handle:o,isNew:!0}),o}clone(n){if(!n.isReady())throw new Error(`Cloned handle is not yet in ready state.
        (Try await handle.waitForReady() first.)`);const r=n.docSync();if(!r)throw new Error("Cloned handle doesn't have a document.");const o=this.create();return o.update(()=>Ed(r)),o}find(n){const r=Qi(n);if(h(this,$e)[r])return h(this,$e)[r].isUnavailable()&&setTimeout(()=>{h(this,$e)[r].emit("unavailable",{handle:h(this,$e)[r]})}),h(this,$e)[r];const o=ne(this,rn,Lr).call(this,{documentId:r,isNew:!1});return this.emit("document",{handle:o,isNew:!1}),o}delete(n){const r=Qi(n);ne(this,rn,Lr).call(this,{documentId:r,isNew:!1}).delete(),delete h(this,$e)[r],this.emit("delete-document",{documentId:r})}async export(n){const r=Qi(n),o=await ne(this,rn,Lr).call(this,{documentId:r,isNew:!1}).doc();if(o)return vd(o)}import(n){const r=Wb(n),o=this.create();return o.update(()=>Ed(r)),o}}st=new WeakMap,$e=new WeakMap,ct=new WeakMap,Ge=new WeakMap,ft=new WeakMap,Yo=new WeakSet,tl=function(n){switch(n.type){case"remote-subscription-change":h(this,ft)&&h(this,Ge).handleControlMessage(n);break;case"remote-heads-changed":h(this,ft)&&h(this,Ge).handleRemoteHeads(n);break;case"sync":case"request":case"ephemeral":case"doc-unavailable":h(this,ct).receiveMessage(n).catch(r=>{console.log("error receiving message",{err:r})})}},Rr=new WeakMap,Zo=new WeakSet,nl=function(n){if(!this.storageSubsystem)return;const{storageId:r,isEphemeral:o}=this.peerMetadataByPeerId[n.peerId]||{};if(!r||o)return;let i=h(this,Rr)[r];i||(i=h(this,Rr)[r]=ha(({documentId:a,syncState:s})=>{this.storageSubsystem.saveSyncState(a,r,s)},this.saveDebounceRate)),i(n)},rn=new WeakSet,Lr=function({documentId:n,isNew:r,initialValue:o}){if(h(this,$e)[n])return h(this,$e)[n];if(!n)throw new Error(`Invalid documentId ${n}`);const i=new Bm(n,{isNew:r,initialValue:o});return h(this,$e)[n]=i,i};class $_ extends yn{constructor(){super(...arguments);_e(this,"peerId");_e(this,"peerMetadata")}}class hw{}class gw extends hw{constructor(n="automerge",r="documents"){super();_e(this,"database");_e(this,"store");_e(this,"dbPromise");this.database=n,this.store=r,this.dbPromise=this.createDatabasePromise()}createDatabasePromise(){return new Promise((n,r)=>{const o=indexedDB.open(this.database,1);o.onerror=()=>{r(o.error)},o.onupgradeneeded=i=>{i.target.result.createObjectStore(this.store)},o.onsuccess=i=>{const a=i.target.result;n(a)}})}async load(n){const r=(await this.dbPromise).transaction(this.store),o=r.objectStore(this.store).get(n);return new Promise((i,a)=>{r.onerror=()=>{a(o.error)},o.onsuccess=s=>{const c=s.target.result;c&&typeof c=="object"&&"binary"in c?i(c.binary):i(void 0)}})}async save(n,r){const o=(await this.dbPromise).transaction(this.store,"readwrite");return o.objectStore(this.store).put({key:n,binary:r},n),new Promise((i,a)=>{o.onerror=()=>{a(o.error)},o.oncomplete=()=>{i()}})}async remove(n){const r=(await this.dbPromise).transaction(this.store,"readwrite");return r.objectStore(this.store).delete(n),new Promise((o,i)=>{r.onerror=()=>{i(r.error)},r.oncomplete=()=>{o()}})}async loadRange(n){const r=await this.dbPromise,o=n,i=[...n,"\uFFFF"],a=IDBKeyRange.bound(o,i),s=r.transaction(this.store),c=s.objectStore(this.store).openCursor(a),u=[];return new Promise((_,d)=>{s.onerror=()=>{d(c.error)},c.onsuccess=l=>{const f=l.target.result;f?(u.push({data:f.value.binary,key:f.key}),f.continue()):_(u)}})}async removeRange(n){const r=await this.dbPromise,o=n,i=[...n,"\uFFFF"],a=IDBKeyRange.bound(o,i),s=r.transaction(this.store,"readwrite");return s.objectStore(this.store).delete(a),new Promise((c,u)=>{s.onerror=()=>{u(s.error)},s.oncomplete=()=>{c()}})}}var Pn=null;typeof WebSocket<"u"?Pn=WebSocket:typeof MozWebSocket<"u"?Pn=MozWebSocket:typeof global<"u"?Pn=global.WebSocket||global.MozWebSocket:typeof window<"u"?Pn=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Pn=self.WebSocket||self.MozWebSocket);const pa=Pn,pw=t=>t.type==="peer",bw=t=>t.type==="error",yw="1";function At(t,e="Assertion failed"){if(t===!1||t===null||t===void 0){const n=new Error(mw(e));throw n.stack=ww(n.stack,"assert.ts"),n}}const mw=t=>t.split(`
`).map(e=>e.trim()).join(`
`),ww=(t="",e)=>t.split(`
`).filter(n=>!n.includes(e)).join(`
`),vw=t=>{const{buffer:e,byteOffset:n,byteLength:r}=t;return e.slice(n,n+r)};class Sw extends $_{constructor(){super(...arguments);_e(this,"socket")}}class kw extends Sw{constructor(n,r=5e3){super();q(this,Pr);_e(this,"url");_e(this,"retryInterval");q(this,Tr,!1);q(this,Qt,void 0);q(this,ut,Mt("automerge-repo:websocket:browser"));_e(this,"remotePeerId");_e(this,"onOpen",()=>{h(this,ut).call(this,"open"),clearInterval(h(this,Qt)),we(this,Qt,void 0),this.join()});_e(this,"onClose",()=>{h(this,ut).call(this,"close"),this.remotePeerId&&this.emit("peer-disconnected",{peerId:this.remotePeerId}),this.retryInterval>0&&!h(this,Qt)&&setTimeout(()=>(At(this.peerId),this.connect(this.peerId,this.peerMetadata)),this.retryInterval)});_e(this,"onMessage",n=>{this.receiveMessage(n.data)});_e(this,"onError",n=>{const{code:r}=n.error;if(r==="ECONNREFUSED")h(this,ut).call(this,"Connection refused, retrying...");else throw n.error});this.url=n,this.retryInterval=r,we(this,ut,h(this,ut).extend(n))}connect(n,r){!this.socket||!this.peerId?(h(this,ut).call(this,"connecting"),this.peerId=n,this.peerMetadata=r??{}):(h(this,ut).call(this,"reconnecting"),At(n===this.peerId),this.socket.removeEventListener("open",this.onOpen),this.socket.removeEventListener("close",this.onClose),this.socket.removeEventListener("message",this.onMessage),this.socket.removeEventListener("error",this.onError)),h(this,Qt)||we(this,Qt,setInterval(()=>{this.connect(n,r)},this.retryInterval)),this.socket=new pa(this.url),this.socket.binaryType="arraybuffer",this.socket.addEventListener("open",this.onOpen),this.socket.addEventListener("close",this.onClose),this.socket.addEventListener("message",this.onMessage),this.socket.addEventListener("error",this.onError),setTimeout(()=>ne(this,Pr,Ia).call(this),1e3),this.join()}join(){At(this.peerId),At(this.socket),this.socket.readyState===pa.OPEN&&this.send(xw(this.peerId,this.peerMetadata))}disconnect(){At(this.peerId),At(this.socket),this.send({type:"leave",senderId:this.peerId})}send(n){var o;if("data"in n&&((o=n.data)==null?void 0:o.byteLength)===0)throw new Error("Tried to send a zero-length message");if(At(this.peerId),At(this.socket),this.socket.readyState!==pa.OPEN)throw new Error(`Websocket not ready (${this.socket.readyState})`);const r=M_(n);this.socket.send(vw(r))}peerCandidate(n,r){At(this.socket),ne(this,Pr,Ia).call(this),this.remotePeerId=n,this.emit("peer-candidate",{peerId:n,peerMetadata:r})}receiveMessage(n){const r=Dm(new Uint8Array(n));if(At(this.socket),n.byteLength===0)throw new Error("received a zero-length message");if(pw(r)){const{peerMetadata:o}=r;h(this,ut).call(this,`peer: ${r.senderId}`),this.peerCandidate(r.senderId,o)}else bw(r)?h(this,ut).call(this,`error: ${r.message}`):this.emit("message",r)}}Tr=new WeakMap,Qt=new WeakMap,ut=new WeakMap,Pr=new WeakSet,Ia=function(){h(this,Tr)||(we(this,Tr,!0),this.emit("ready",{network:this}))};function xw(t,e){return{type:"join",senderId:t,peerMetadata:e,supportedProtocolVersions:[yw]}}Mt("WebsocketServer");class Aw extends $_{constructor(n){super();q(this,Ur);q(this,Dt,void 0);q(this,Mr,void 0);we(this,Mr,{channelName:"broadcast",...n??{}}),we(this,Dt,new BroadcastChannel(h(this,Mr).channelName))}connect(n,r){this.peerId=n,this.peerMetadata=r,h(this,Dt).addEventListener("message",o=>{const i=o.data;if("targetId"in i&&i.targetId!==this.peerId)return;const{senderId:a,type:s}=i;switch(s){case"arrive":{const{peerMetadata:c}=i;h(this,Dt).postMessage({senderId:this.peerId,targetId:a,type:"welcome",peerMetadata:this.peerMetadata}),ne(this,Ur,Oa).call(this,a,c)}break;case"welcome":{const{peerMetadata:c}=i;ne(this,Ur,Oa).call(this,a,c)}break;default:if(!("data"in i))this.emit("message",i);else{const c=i.data;this.emit("message",{...i,data:new Uint8Array(c)})}break}}),h(this,Dt).postMessage({senderId:this.peerId,type:"arrive",peerMetadata:r}),this.emit("ready",{network:this})}send(n){"data"in n?h(this,Dt).postMessage({...n,data:n.data?n.data.buffer.slice(n.data.byteOffset,n.data.byteOffset+n.data.byteLength):void 0}):h(this,Dt).postMessage(n)}disconnect(){throw new Error("Unimplemented: leave on BroadcastChannelNetworkAdapter")}}Dt=new WeakMap,Mr=new WeakMap,Ur=new WeakSet,Oa=function(n,r){this.emit("peer-candidate",{peerId:n,peerMetadata:r})};const z_={next:kg,isValidAutomergeUrl:d_,Repo:fw,IndexedDBStorageAdapter:gw,BrowserWebSocketClientAdapter:kw,BroadcastChannelNetworkAdapter:Aw};window.automerge=z_,document.dispatchEvent(new CustomEvent("automerge",{detail:z_}))})()});export default Cw();
